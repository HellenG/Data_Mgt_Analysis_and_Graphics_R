<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R Essentials</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="R Essentials is a foundation book for an upcoming book titled ‘Introduction to Data Analysis and Graphics using R’.">
  <meta name="generator" content="bookdown 0.3 and GitBook 2.6.7">

  <meta property="og:title" content="R Essentials" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="R Essentials is a foundation book for an upcoming book titled ‘Introduction to Data Analysis and Graphics using R’." />
  <meta name="github-repo" content="HellenG/Data_Mgt_Analysis_and_Graphics_R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R Essentials" />
  
  <meta name="twitter:description" content="R Essentials is a foundation book for an upcoming book titled ‘Introduction to Data Analysis and Graphics using R’." />
  

<meta name="author" content="Hellen Gakuruh">


<meta name="date" content="2017-01-30">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="chap7.html">
<link rel="next" href="chap9.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Essentials</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#learning-outcomes"><i class="fa fa-check"></i>Learning Outcomes</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="chap1.html"><a href="chap1.html"><i class="fa fa-check"></i><b>1</b> Getting to know R and RStudio</a><ul>
<li class="chapter" data-level="" data-path="chap1.html"><a href="chap1.html#goal"><i class="fa fa-check"></i>Goal</a></li>
<li class="chapter" data-level="" data-path="chap1.html"><a href="chap1.html#what-we-shall-cover"><i class="fa fa-check"></i>What we shall cover</a></li>
<li class="chapter" data-level="1.1" data-path="chap1.html"><a href="chap1.html#what-is-r"><i class="fa fa-check"></i><b>1.1</b> What is R?</a><ul>
<li class="chapter" data-level="1.1.1" data-path="chap1.html"><a href="chap1.html#defining-r-and-tracing-its-history"><i class="fa fa-check"></i><b>1.1.1</b> Defining R and tracing it’s history</a></li>
<li class="chapter" data-level="1.1.2" data-path="chap1.html"><a href="chap1.html#downloading-and-installation-of-base-r"><i class="fa fa-check"></i><b>1.1.2</b> Downloading and Installation of Base R</a></li>
<li class="chapter" data-level="1.1.3" data-path="chap1.html"><a href="chap1.html#tour-of-base-r"><i class="fa fa-check"></i><b>1.1.3</b> Tour of base R</a></li>
<li class="chapter" data-level="1.1.4" data-path="chap1.html"><a href="chap1.html#RConsole"><i class="fa fa-check"></i><b>1.1.4</b> Base R’s console</a></li>
<li class="chapter" data-level="1.1.5" data-path="chap1.html"><a href="chap1.html#errors-warnings-and-messages"><i class="fa fa-check"></i><b>1.1.5</b> Errors, Warnings and messages</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="chap1.html"><a href="chap1.html#RStudio"><i class="fa fa-check"></i><b>1.2</b> RStudio</a><ul>
<li class="chapter" data-level="1.2.1" data-path="chap1.html"><a href="chap1.html#downloading-and-installing-rstudio"><i class="fa fa-check"></i><b>1.2.1</b> Downloading and Installing RStudio</a></li>
<li class="chapter" data-level="1.2.2" data-path="chap1.html"><a href="chap1.html#getting-to-know-rstudio-layout"><i class="fa fa-check"></i><b>1.2.2</b> Getting to know RStudio layout</a></li>
<li class="chapter" data-level="1.2.3" data-path="chap1.html"><a href="chap1.html#RStudioConsole"><i class="fa fa-check"></i><b>1.2.3</b> Working with RStudio’s console</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="chap1.html"><a href="chap1.html#packages"><i class="fa fa-check"></i><b>1.3</b> Installing and Loading Packages</a></li>
<li class="chapter" data-level="1.4" data-path="chap1.html"><a href="chap1.html#workingDirectory"><i class="fa fa-check"></i><b>1.4</b> Working directory</a><ul>
<li class="chapter" data-level="1.4.1" data-path="chap1.html"><a href="chap1.html#RScripting"><i class="fa fa-check"></i><b>1.4.1</b> Introduction to scripting (reproducible analysis)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chap2.html"><a href="chap2.html"><i class="fa fa-check"></i><b>2</b> Making Function Calls</a><ul>
<li class="chapter" data-level="" data-path="chap2.html"><a href="chap2.html#goal-1"><i class="fa fa-check"></i>Goal</a></li>
<li class="chapter" data-level="" data-path="chap2.html"><a href="chap2.html#what-we-shall-cover-1"><i class="fa fa-check"></i>What we shall cover</a></li>
<li class="chapter" data-level="" data-path="chap2.html"><a href="chap2.html#prerequisite"><i class="fa fa-check"></i>Prerequisite</a></li>
<li class="chapter" data-level="2.1" data-path="chap2.html"><a href="chap2.html#r-functions"><i class="fa fa-check"></i><b>2.1</b> R Functions</a></li>
<li class="chapter" data-level="2.2" data-path="chap2.html"><a href="chap2.html#making-function-calls"><i class="fa fa-check"></i><b>2.2</b> Making Function Calls</a><ul>
<li class="chapter" data-level="2.2.1" data-path="chap2.html"><a href="chap2.html#a-functions-name"><i class="fa fa-check"></i><b>2.2.1</b> A functions name</a></li>
<li class="chapter" data-level="2.2.2" data-path="chap2.html"><a href="chap2.html#arguments"><i class="fa fa-check"></i><b>2.2.2</b> Arguments</a></li>
<li class="chapter" data-level="2.2.3" data-path="chap2.html"><a href="chap2.html#functionLevels"><i class="fa fa-check"></i><b>2.2.3</b> Different Function levels</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chap3.html"><a href="chap3.html"><i class="fa fa-check"></i><b>3</b> Introduction to Version Control Systems</a><ul>
<li class="chapter" data-level="" data-path="chap3.html"><a href="chap3.html#preliquisite"><i class="fa fa-check"></i>Preliquisite</a></li>
<li class="chapter" data-level="" data-path="chap3.html"><a href="chap3.html#chapter-expectation"><i class="fa fa-check"></i>Chapter Expectation</a></li>
<li class="chapter" data-level="3.1" data-path="chap3.html"><a href="chap3.html#whatvcsis"><i class="fa fa-check"></i><b>3.1</b> Introduction: What and Why Version Control System</a></li>
<li class="chapter" data-level="3.2" data-path="chap3.html"><a href="chap3.html#introgit"><i class="fa fa-check"></i><b>3.2</b> Introduction to Git</a><ul>
<li class="chapter" data-level="3.2.1" data-path="chap3.html"><a href="chap3.html#what-is-git"><i class="fa fa-check"></i><b>3.2.1</b> What is Git?</a></li>
<li class="chapter" data-level="3.2.2" data-path="chap3.html"><a href="chap3.html#how-does-git-work"><i class="fa fa-check"></i><b>3.2.2</b> How does Git work?</a></li>
<li class="chapter" data-level="3.2.3" data-path="chap3.html"><a href="chap3.html#working-with-git"><i class="fa fa-check"></i><b>3.2.3</b> Working with Git</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="chap3.html"><a href="chap3.html#collaborating-with-other-r-programmersdevelopers"><i class="fa fa-check"></i><b>3.3</b> Collaborating with other R programmers/developers</a><ul>
<li class="chapter" data-level="3.3.1" data-path="chap3.html"><a href="chap3.html#working-with-remote-repositories-gitgub"><i class="fa fa-check"></i><b>3.3.1</b> Working with remote repositories: GitGub</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="chap3.html"><a href="chap3.html#using-git-and-github-in-rstudio"><i class="fa fa-check"></i><b>3.4</b> Using Git and GitHub in RStudio</a></li>
<li class="chapter" data-level="" data-path="chap3.html"><a href="chap3.html#references"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chap4.html"><a href="chap4.html"><i class="fa fa-check"></i><b>4</b> Data Types and Data Objects</a><ul>
<li class="chapter" data-level="" data-path="chap4.html"><a href="chap4.html#session-goal"><i class="fa fa-check"></i>Session Goal</a></li>
<li class="chapter" data-level="" data-path="chap4.html"><a href="chap4.html#what-we-shall-cover-2"><i class="fa fa-check"></i>What we shall cover</a></li>
<li class="chapter" data-level="" data-path="chap4.html"><a href="chap4.html#prerequisite-1"><i class="fa fa-check"></i>Prerequisite</a></li>
<li class="chapter" data-level="4.1" data-path="chap4.html"><a href="chap4.html#dataTypes"><i class="fa fa-check"></i><b>4.1</b> Data Types</a></li>
<li class="chapter" data-level="4.2" data-path="chap4.html"><a href="chap4.html#vectors"><i class="fa fa-check"></i><b>4.2</b> Vectors</a><ul>
<li class="chapter" data-level="4.2.1" data-path="chap4.html"><a href="chap4.html#creating-vectors"><i class="fa fa-check"></i><b>4.2.1</b> Creating vectors</a></li>
<li class="chapter" data-level="4.2.2" data-path="chap4.html"><a href="chap4.html#namingObjects"><i class="fa fa-check"></i><b>4.2.2</b> Naming objects</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="chap4.html"><a href="chap4.html#properties-of-data-objects-vector"><i class="fa fa-check"></i><b>4.3</b> Properties of data objects (vector)</a><ul>
<li class="chapter" data-level="4.3.1" data-path="chap4.html"><a href="chap4.html#typeof"><i class="fa fa-check"></i><b>4.3.1</b> Type of a vector</a></li>
<li class="chapter" data-level="4.3.2" data-path="chap4.html"><a href="chap4.html#attributes"><i class="fa fa-check"></i><b>4.3.2</b> Attributes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chap5.html"><a href="chap5.html"><i class="fa fa-check"></i><b>5</b> Importing and Exporting Data</a><ul>
<li class="chapter" data-level="" data-path="chap5.html"><a href="chap5.html#chapter-goal"><i class="fa fa-check"></i>Chapter Goal</a></li>
<li class="chapter" data-level="" data-path="chap5.html"><a href="chap5.html#what-we-shall-cover-3"><i class="fa fa-check"></i>What we shall cover</a></li>
<li class="chapter" data-level="5.1" data-path="chap5.html"><a href="chap5.html#importing-data-into-r"><i class="fa fa-check"></i><b>5.1</b> Importing Data into R</a><ul>
<li class="chapter" data-level="5.1.1" data-path="chap5.html"><a href="chap5.html#using-gui-for-delimited-files"><i class="fa fa-check"></i><b>5.1.1</b> Using GUI for delimited files</a></li>
<li class="chapter" data-level="5.1.2" data-path="chap5.html"><a href="chap5.html#using-command-line"><i class="fa fa-check"></i><b>5.1.2</b> Using command line</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="chap5.html"><a href="chap5.html#importing-challenges"><i class="fa fa-check"></i><b>5.2</b> Importing Challenges</a></li>
<li class="chapter" data-level="5.3" data-path="chap5.html"><a href="chap5.html#exporting-data"><i class="fa fa-check"></i><b>5.3</b> Exporting Data</a><ul>
<li class="chapter" data-level="5.3.1" data-path="chap5.html"><a href="chap5.html#base-r-and-utils-exporting-functions"><i class="fa fa-check"></i><b>5.3.1</b> Base R and Utils exporting functions</a></li>
<li class="chapter" data-level="5.3.2" data-path="chap5.html"><a href="chap5.html#exporting-with-other-packages"><i class="fa fa-check"></i><b>5.3.2</b> Exporting with other packages</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="chap5.html"><a href="chap5.html#taking-a-glimpse"><i class="fa fa-check"></i><b>5.4</b> Taking a Glimpse</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chap6.html"><a href="chap6.html"><i class="fa fa-check"></i><b>6</b> Transforming Manipulating Data Objects</a><ul>
<li class="chapter" data-level="" data-path="chap6.html"><a href="chap6.html#chapter-goal-1"><i class="fa fa-check"></i>Chapter Goal</a></li>
<li class="chapter" data-level="" data-path="chap6.html"><a href="chap6.html#what-we-shall-cover-4"><i class="fa fa-check"></i>What we shall cover</a></li>
<li class="chapter" data-level="6.1" data-path="chap6.html"><a href="chap6.html#prerequisite-2"><i class="fa fa-check"></i><b>6.1</b> Prerequisite</a></li>
<li class="chapter" data-level="6.2" data-path="chap6.html"><a href="chap6.html#indexing"><i class="fa fa-check"></i><b>6.2</b> Indexing different data objects in R</a><ul>
<li class="chapter" data-level="6.2.1" data-path="chap6.html"><a href="chap6.html#indexing-one-dimensional-objects"><i class="fa fa-check"></i><b>6.2.1</b> Indexing one dimensional objects</a></li>
<li class="chapter" data-level="6.2.2" data-path="chap6.html"><a href="chap6.html#indexing-two-dimensional-vectors"><i class="fa fa-check"></i><b>6.2.2</b> Indexing two dimensional vectors</a></li>
<li class="chapter" data-level="6.2.3" data-path="chap6.html"><a href="chap6.html#atomichomogenous-vectors-with-more-than-2-dimensions-2d"><i class="fa fa-check"></i><b>6.2.3</b> Atomic/Homogenous vectors with more than 2 dimensions (&gt;2d)</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="chap6.html"><a href="chap6.html#binary-and-vectorisation-operators"><i class="fa fa-check"></i><b>6.3</b> Binary and vectorisation Operators</a><ul>
<li class="chapter" data-level="6.3.1" data-path="chap6.html"><a href="chap6.html#compOps"><i class="fa fa-check"></i><b>6.3.1</b> Comparison Operators</a></li>
<li class="chapter" data-level="6.3.2" data-path="chap6.html"><a href="chap6.html#logical-operators"><i class="fa fa-check"></i><b>6.3.2</b> Logical Operators</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="chap6.html"><a href="chap6.html#checking-conditions"><i class="fa fa-check"></i><b>6.4</b> Checking conditions</a><ul>
<li class="chapter" data-level="6.4.1" data-path="chap6.html"><a href="chap6.html#all-function"><i class="fa fa-check"></i><b>6.4.1</b> “All” function</a></li>
<li class="chapter" data-level="6.4.2" data-path="chap6.html"><a href="chap6.html#any-function"><i class="fa fa-check"></i><b>6.4.2</b> “Any” function</a></li>
<li class="chapter" data-level="6.4.3" data-path="chap6.html"><a href="chap6.html#which-function"><i class="fa fa-check"></i><b>6.4.3</b> “Which” function</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="chap6.html"><a href="chap6.html#subsetting"><i class="fa fa-check"></i><b>6.5</b> Subsetting Data Objects</a><ul>
<li class="chapter" data-level="6.5.1" data-path="chap6.html"><a href="chap6.html#subsetting-one-dimensional-atomic-vectors"><i class="fa fa-check"></i><b>6.5.1</b> Subsetting one dimensional atomic vectors</a></li>
<li class="chapter" data-level="6.5.2" data-path="chap6.html"><a href="chap6.html#subsetting-a-matrix"><i class="fa fa-check"></i><b>6.5.2</b> Subsetting a Matrix</a></li>
<li class="chapter" data-level="6.5.3" data-path="chap6.html"><a href="chap6.html#subsetting-a-dataframe"><i class="fa fa-check"></i><b>6.5.3</b> Subsetting a dataframe</a></li>
<li class="chapter" data-level="6.5.4" data-path="chap6.html"><a href="chap6.html#subsetting-a-list"><i class="fa fa-check"></i><b>6.5.4</b> Subsetting a List</a></li>
<li class="chapter" data-level="6.5.5" data-path="chap6.html"><a href="chap6.html#subsetting-character-vectors"><i class="fa fa-check"></i><b>6.5.5</b> Subsetting character vectors</a></li>
<li class="chapter" data-level="6.5.6" data-path="chap6.html"><a href="chap6.html#subsetting-factor-vectors"><i class="fa fa-check"></i><b>6.5.6</b> Subsetting factor vectors</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="chap6.html"><a href="chap6.html#transformationmanipulation-of-datasets"><i class="fa fa-check"></i><b>6.6</b> Transformation/Manipulation of datasets</a></li>
<li class="chapter" data-level="" data-path="chap6.html"><a href="chap6.html#references-1"><i class="fa fa-check"></i>References</a><ul>
<li class="chapter" data-level="" data-path="chap6.html"><a href="chap6.html#quick-reference-on-functions"><i class="fa fa-check"></i>Quick reference on functions</a></li>
<li class="chapter" data-level="" data-path="chap6.html"><a href="chap6.html#packages-to-read-further-on"><i class="fa fa-check"></i>Packages to read further on</a></li>
<li class="chapter" data-level="" data-path="chap6.html"><a href="chap6.html#r-manuals"><i class="fa fa-check"></i>R Manuals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chap7.html"><a href="chap7.html"><i class="fa fa-check"></i><b>7</b> Working with Dates and Time</a><ul>
<li class="chapter" data-level="" data-path="chap7.html"><a href="chap7.html#goal-2"><i class="fa fa-check"></i>Goal</a></li>
<li class="chapter" data-level="" data-path="chap7.html"><a href="chap7.html#what-we-shall-cover-5"><i class="fa fa-check"></i>What we shall cover</a></li>
<li class="chapter" data-level="" data-path="chap7.html"><a href="chap7.html#prerequisite-3"><i class="fa fa-check"></i>Prerequisite</a></li>
<li class="chapter" data-level="7.1" data-path="chap7.html"><a href="chap7.html#recognising-date-time-objects-in-r"><i class="fa fa-check"></i><b>7.1</b> Recognising date-time objects in R</a><ul>
<li class="chapter" data-level="7.1.1" data-path="chap7.html"><a href="chap7.html#current-date"><i class="fa fa-check"></i><b>7.1.1</b> Current date</a></li>
<li class="chapter" data-level="7.1.2" data-path="chap7.html"><a href="chap7.html#current-time"><i class="fa fa-check"></i><b>7.1.2</b> Current Time</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="chap7.html"><a href="chap7.html#creating-date-time-objects-in-base-r"><i class="fa fa-check"></i><b>7.2</b> Creating date-time objects in base R</a><ul>
<li class="chapter" data-level="7.2.1" data-path="chap7.html"><a href="chap7.html#posix"><i class="fa fa-check"></i><b>7.2.1</b> POSIX</a></li>
<li class="chapter" data-level="7.2.2" data-path="chap7.html"><a href="chap7.html#creating-posixct-objects"><i class="fa fa-check"></i><b>7.2.2</b> Creating POSIXct objects</a></li>
<li class="chapter" data-level="7.2.3" data-path="chap7.html"><a href="chap7.html#creating-posixlt-objects"><i class="fa fa-check"></i><b>7.2.3</b> Creating POSIXlt Objects</a></li>
<li class="chapter" data-level="7.2.4" data-path="chap7.html"><a href="chap7.html#creating-date-time-object-using-strptime"><i class="fa fa-check"></i><b>7.2.4</b> Creating date-time Object using “strptime()”</a></li>
<li class="chapter" data-level="7.2.5" data-path="chap7.html"><a href="chap7.html#converting-numeric-data-to-date-and-time-object"><i class="fa fa-check"></i><b>7.2.5</b> Converting numeric data to date and time object</a></li>
<li class="chapter" data-level="7.2.6" data-path="chap7.html"><a href="chap7.html#creating-date-and-time-factor-vectors"><i class="fa fa-check"></i><b>7.2.6</b> Creating date and time factor vectors</a></li>
<li class="chapter" data-level="7.2.7" data-path="chap7.html"><a href="chap7.html#creating-date-objects"><i class="fa fa-check"></i><b>7.2.7</b> Creating Date objects</a></li>
<li class="chapter" data-level="7.2.8" data-path="chap7.html"><a href="chap7.html#computationDateTime"><i class="fa fa-check"></i><b>7.2.8</b> Computation with date and time objects</a></li>
<li class="chapter" data-level="7.2.9" data-path="chap7.html"><a href="chap7.html#extracting-parts-of-a-date-time-object"><i class="fa fa-check"></i><b>7.2.9</b> Extracting parts of a date-time object</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chap7.html"><a href="chap7.html#references-2"><i class="fa fa-check"></i>References</a><ul>
<li class="chapter" data-level="" data-path="chap7.html"><a href="chap7.html#quick-reference-on-functions-1"><i class="fa fa-check"></i>Quick reference on functions</a></li>
<li class="chapter" data-level="" data-path="chap7.html"><a href="chap7.html#other-packages-on-date-and-time"><i class="fa fa-check"></i>Other Packages on date and time</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chap8.html"><a href="chap8.html"><i class="fa fa-check"></i><b>8</b> Plotting in Base R</a><ul>
<li class="chapter" data-level="" data-path="chap8.html"><a href="chap8.html#goal-3"><i class="fa fa-check"></i>Goal</a></li>
<li class="chapter" data-level="" data-path="chap8.html"><a href="chap8.html#what-we-shall-cover-6"><i class="fa fa-check"></i>What we shall cover</a></li>
<li class="chapter" data-level="" data-path="chap8.html"><a href="chap8.html#prerequisite-4"><i class="fa fa-check"></i>Prerequisite</a></li>
<li class="chapter" data-level="8.1" data-path="chap8.html"><a href="chap8.html#introduction"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="chap8.html"><a href="chap8.html#understanding-base-r-plotting-function"><i class="fa fa-check"></i><b>8.2</b> Understanding base R plotting function</a><ul>
<li class="chapter" data-level="8.2.1" data-path="chap8.html"><a href="chap8.html#some-outputs-of-plot"><i class="fa fa-check"></i><b>8.2.1</b> Some outputs of plot()</a></li>
<li class="chapter" data-level="8.2.2" data-path="chap8.html"><a href="chap8.html#functionDefinition"><i class="fa fa-check"></i><b>8.2.2</b> plot() Internals</a></li>
<li class="chapter" data-level="8.2.3" data-path="chap8.html"><a href="chap8.html#step-one-opening-new-window"><i class="fa fa-check"></i><b>8.2.3</b> Step one: Opening new window</a></li>
<li class="chapter" data-level="8.2.4" data-path="chap8.html"><a href="chap8.html#step-two-setting-plotting-coordinates"><i class="fa fa-check"></i><b>8.2.4</b> Step two: Setting plotting coordinates</a></li>
<li class="chapter" data-level="8.2.5" data-path="chap8.html"><a href="chap8.html#step-three-evaluate-and-execute-pre-post-functions"><i class="fa fa-check"></i><b>8.2.5</b> Step three: Evaluate and execute pre-post functions</a></li>
<li class="chapter" data-level="8.2.6" data-path="chap8.html"><a href="chap8.html#step-four-plotting"><i class="fa fa-check"></i><b>8.2.6</b> Step four: Plotting</a></li>
<li class="chapter" data-level="8.2.7" data-path="chap8.html"><a href="chap8.html#step-five-evaluation-of-post-plot-and-pre-axis-expressions"><i class="fa fa-check"></i><b>8.2.7</b> Step five: Evaluation of post-plot and pre-axis expressions</a></li>
<li class="chapter" data-level="8.2.8" data-path="chap8.html"><a href="chap8.html#step-six-construct-axis"><i class="fa fa-check"></i><b>8.2.8</b> Step six: Construct Axis</a></li>
<li class="chapter" data-level="8.2.9" data-path="chap8.html"><a href="chap8.html#step-seven-ploting-frame"><i class="fa fa-check"></i><b>8.2.9</b> Step Seven: Ploting frame</a></li>
<li class="chapter" data-level="8.2.10" data-path="chap8.html"><a href="chap8.html#step-eight-annotation"><i class="fa fa-check"></i><b>8.2.10</b> Step Eight: Annotation</a></li>
<li class="chapter" data-level="8.2.11" data-path="chap8.html"><a href="chap8.html#summary-final-output"><i class="fa fa-check"></i><b>8.2.11</b> Summary: Final output</a></li>
<li class="chapter" data-level="8.2.12" data-path="chap8.html"><a href="chap8.html#commentedDefinition"><i class="fa fa-check"></i><b>8.2.12</b> A commented basic plot definition</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="chap8.html"><a href="chap8.html#par"><i class="fa fa-check"></i><b>8.3</b> Graphical Parameters and Annotating Base R Plots</a><ul>
<li class="chapter" data-level="8.3.1" data-path="chap8.html"><a href="chap8.html#querying-saving-and-resetting-graphical-parameters"><i class="fa fa-check"></i><b>8.3.1</b> Querying, saving and resetting graphical parameters</a></li>
<li class="chapter" data-level="8.3.2" data-path="chap8.html"><a href="chap8.html#settingchanging-graphical-parameters"><i class="fa fa-check"></i><b>8.3.2</b> Setting/Changing graphical parameters</a></li>
<li class="chapter" data-level="8.3.3" data-path="chap8.html"><a href="chap8.html#implementing-some-graphical-parameters-and-annotation"><i class="fa fa-check"></i><b>8.3.3</b> Implementing some graphical parameters and annotation</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="chap8.html"><a href="chap8.html#plotting-characters-pch"><i class="fa fa-check"></i><b>8.4</b> Plotting characters (pch)</a></li>
<li class="chapter" data-level="8.5" data-path="chap8.html"><a href="chap8.html#plotTypes"><i class="fa fa-check"></i><b>8.5</b> Plot types</a><ul>
<li class="chapter" data-level="8.5.1" data-path="chap8.html"><a href="chap8.html#annotating-plots-with-lines"><i class="fa fa-check"></i><b>8.5.1</b> Annotating plots with lines</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="chap8.html"><a href="chap8.html#generating-and-annotating-mathematical-plots"><i class="fa fa-check"></i><b>8.6</b> Generating and Annotating Mathematical Plots</a></li>
<li class="chapter" data-level="8.7" data-path="chap8.html"><a href="chap8.html#other-base-r-plots"><i class="fa fa-check"></i><b>8.7</b> Other Base R Plots</a><ul>
<li class="chapter" data-level="8.7.1" data-path="chap8.html"><a href="chap8.html#histDensityPlots"><i class="fa fa-check"></i><b>8.7.1</b> Histogram and Density plots</a></li>
<li class="chapter" data-level="8.7.2" data-path="chap8.html"><a href="chap8.html#box-box-and-whisker-plots"><i class="fa fa-check"></i><b>8.7.2</b> Box (box-and-whisker) plots</a></li>
<li class="chapter" data-level="8.7.3" data-path="chap8.html"><a href="chap8.html#strip-chartsdot-plots"><i class="fa fa-check"></i><b>8.7.3</b> Strip Charts/Dot Plots</a></li>
<li class="chapter" data-level="8.7.4" data-path="chap8.html"><a href="chap8.html#conditional-plots-coplot"><i class="fa fa-check"></i><b>8.7.4</b> Conditional Plots (Coplot)</a></li>
<li class="chapter" data-level="8.7.5" data-path="chap8.html"><a href="chap8.html#stem-and-leaf-plot"><i class="fa fa-check"></i><b>8.7.5</b> Stem and Leaf plot</a></li>
<li class="chapter" data-level="8.7.6" data-path="chap8.html"><a href="chap8.html#bar-graphs-and-pie-chart"><i class="fa fa-check"></i><b>8.7.6</b> Bar graphs and pie chart</a></li>
<li class="chapter" data-level="8.7.7" data-path="chap8.html"><a href="chap8.html#mosaic"><i class="fa fa-check"></i><b>8.7.7</b> Mosaic</a></li>
<li class="chapter" data-level="8.7.8" data-path="chap8.html"><a href="chap8.html#fourfold-plots"><i class="fa fa-check"></i><b>8.7.8</b> Fourfold Plots</a></li>
<li class="chapter" data-level="8.7.9" data-path="chap8.html"><a href="chap8.html#sunflower-plots"><i class="fa fa-check"></i><b>8.7.9</b> Sunflower plots</a></li>
<li class="chapter" data-level="8.7.10" data-path="chap8.html"><a href="chap8.html#time-series-plots-line"><i class="fa fa-check"></i><b>8.7.10</b> Time series plots (line)</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="chap8.html"><a href="chap8.html#colours"><i class="fa fa-check"></i><b>8.8</b> Colors</a><ul>
<li class="chapter" data-level="8.8.1" data-path="chap8.html"><a href="chap8.html#expected-values-for-color-based-arguments"><i class="fa fa-check"></i><b>8.8.1</b> Expected values for color-based arguments</a></li>
<li class="chapter" data-level="8.8.2" data-path="chap8.html"><a href="chap8.html#defining-a-new-palette"><i class="fa fa-check"></i><b>8.8.2</b> Defining a new palette</a></li>
<li class="chapter" data-level="8.8.3" data-path="chap8.html"><a href="chap8.html#palettes-makers"><i class="fa fa-check"></i><b>8.8.3</b> Palettes makers</a></li>
<li class="chapter" data-level="8.8.4" data-path="chap8.html"><a href="chap8.html#creating-palettes-by-interpolation-colors"><i class="fa fa-check"></i><b>8.8.4</b> Creating palettes by interpolation colors</a></li>
<li class="chapter" data-level="8.8.5" data-path="chap8.html"><a href="chap8.html#color-models-and-spaces"><i class="fa fa-check"></i><b>8.8.5</b> Color Models and Spaces</a></li>
<li class="chapter" data-level="8.8.6" data-path="chap8.html"><a href="chap8.html#creating-new-colours"><i class="fa fa-check"></i><b>8.8.6</b> Creating New Colours</a></li>
<li class="chapter" data-level="8.8.7" data-path="chap8.html"><a href="chap8.html#color-adjustment"><i class="fa fa-check"></i><b>8.8.7</b> Color adjustment</a></li>
<li class="chapter" data-level="8.8.8" data-path="chap8.html"><a href="chap8.html#colorConversion"><i class="fa fa-check"></i><b>8.8.8</b> Color conversion and Transformation</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="chap8.html"><a href="chap8.html#other-plotting-and-color-palette-packages"><i class="fa fa-check"></i><b>8.9</b> Other Plotting and Color Palette Packages</a></li>
<li class="chapter" data-level="8.10" data-path="chap8.html"><a href="chap8.html#graphicalDevices"><i class="fa fa-check"></i><b>8.10</b> Graphical Devices</a></li>
<li class="chapter" data-level="" data-path="chap8.html"><a href="chap8.html#references-3"><i class="fa fa-check"></i>References</a><ul>
<li class="chapter" data-level="" data-path="chap8.html"><a href="chap8.html#quick-reference-on-functions-2"><i class="fa fa-check"></i>Quick reference on functions</a></li>
<li class="chapter" data-level="" data-path="chap8.html"><a href="chap8.html#packages-to-read-further-on-1"><i class="fa fa-check"></i>Packages to read further on</a></li>
<li class="chapter" data-level="" data-path="chap8.html"><a href="chap8.html#r-manuals-1"><i class="fa fa-check"></i>R Manuals</a></li>
<li class="chapter" data-level="" data-path="chap8.html"><a href="chap8.html#basics-of-plotting-in-r"><i class="fa fa-check"></i>Basics of plotting in R</a></li>
<li class="chapter" data-level="" data-path="chap8.html"><a href="chap8.html#calling-and-changing-graphical-parameters"><i class="fa fa-check"></i>Calling and changing graphical parameters</a></li>
<li class="chapter" data-level="" data-path="chap8.html"><a href="chap8.html#annotating-plots"><i class="fa fa-check"></i>Annotating plots</a></li>
<li class="chapter" data-level="" data-path="chap8.html"><a href="chap8.html#producing-different-base-r-plots"><i class="fa fa-check"></i>Producing different base R plots</a></li>
<li class="chapter" data-level="" data-path="chap8.html"><a href="chap8.html#using-and-creating-colors-in-base-r"><i class="fa fa-check"></i>Using and creating colors in base R</a></li>
<li class="chapter" data-level="" data-path="chap8.html"><a href="chap8.html#rs-graphical-devices"><i class="fa fa-check"></i>R’s graphical devices</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap9.html"><a href="chap9.html"><i class="fa fa-check"></i><b>9</b> Where and How to Get Help</a><ul>
<li class="chapter" data-level="" data-path="chap9.html"><a href="chap9.html#goal-4"><i class="fa fa-check"></i>Goal</a></li>
<li class="chapter" data-level="" data-path="chap9.html"><a href="chap9.html#what-we-shall-cover-7"><i class="fa fa-check"></i>What we shall cover</a></li>
<li class="chapter" data-level="" data-path="chap9.html"><a href="chap9.html#prerequisite-5"><i class="fa fa-check"></i>Prerequisite</a></li>
<li class="chapter" data-level="9.1" data-path="chap9.html"><a href="chap9.html#introduction-1"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="chap9.html"><a href="chap9.html#problem-identification"><i class="fa fa-check"></i><b>9.2</b> Problem Identification</a><ul>
<li class="chapter" data-level="9.2.1" data-path="chap1.html"><a href="chap1.html#errors"><i class="fa fa-check"></i><b>9.2.1</b> Errors</a></li>
<li class="chapter" data-level="9.2.2" data-path="chap9.html"><a href="chap9.html#warning-messages"><i class="fa fa-check"></i><b>9.2.2</b> Warning Messages</a></li>
<li class="chapter" data-level="9.2.3" data-path="chap9.html"><a href="chap9.html#unexpected-output"><i class="fa fa-check"></i><b>9.2.3</b> Unexpected Output</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="chap9.html"><a href="chap9.html#problemSolving"><i class="fa fa-check"></i><b>9.3</b> Solving (defined) coding problems</a><ul>
<li class="chapter" data-level="9.3.1" data-path="chap9.html"><a href="chap9.html#problems-where-functions-are-unknown"><i class="fa fa-check"></i><b>9.3.1</b> Problems where functions are unknown</a></li>
<li class="chapter" data-level="9.3.2" data-path="chap9.html"><a href="chap9.html#problems-where-functions-are-known"><i class="fa fa-check"></i><b>9.3.2</b> Problems where functions are known</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="chap9.html"><a href="chap9.html#where-to-get-help"><i class="fa fa-check"></i><b>9.4</b> Where to get help</a><ul>
<li class="chapter" data-level="9.4.1" data-path="chap9.html"><a href="chap9.html#knowledge-and-skills"><i class="fa fa-check"></i><b>9.4.1</b> Knowledge and Skills</a></li>
<li class="chapter" data-level="9.4.2" data-path="chap9.html"><a href="chap9.html#rs-documentations-internal-sources"><i class="fa fa-check"></i><b>9.4.2</b> R’s Documentations (Internal sources)</a></li>
<li class="chapter" data-level="9.4.3" data-path="chap9.html"><a href="chap9.html#externalSources"><i class="fa fa-check"></i><b>9.4.3</b> External sources of help</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="chap9.html"><a href="chap9.html#example-problem-statistical-mode"><i class="fa fa-check"></i><b>9.5</b> Example problem: Statistical mode</a></li>
<li class="chapter" data-level="" data-path="chap9.html"><a href="chap9.html#references-4"><i class="fa fa-check"></i>References</a><ul>
<li class="chapter" data-level="" data-path="chap9.html"><a href="chap9.html#quick-reference-on-functions-3"><i class="fa fa-check"></i>Quick reference on functions</a></li>
<li class="chapter" data-level="" data-path="chap9.html"><a href="chap9.html#r-manuals-3"><i class="fa fa-check"></i>R Manuals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chap10.html"><a href="chap10.html"><i class="fa fa-check"></i><b>10</b> Case Studies</a><ul>
<li class="chapter" data-level="" data-path="chap10.html"><a href="chap10.html#goal-5"><i class="fa fa-check"></i>Goal</a></li>
<li class="chapter" data-level="" data-path="chap10.html"><a href="chap10.html#prerequisite-6"><i class="fa fa-check"></i>Prerequisite</a></li>
<li class="chapter" data-level="10.1" data-path="chap10.html"><a href="chap10.html#case-study-one--importing-online-data"><i class="fa fa-check"></i><b>10.1</b> Case Study One:- Importing online data</a><ul>
<li class="chapter" data-level="10.1.1" data-path="chap10.html"><a href="chap10.html#task"><i class="fa fa-check"></i><b>10.1.1</b> Task</a></li>
<li class="chapter" data-level="10.1.2" data-path="chap10.html"><a href="chap10.html#what-we-shall-cover-8"><i class="fa fa-check"></i><b>10.1.2</b> What we shall cover</a></li>
<li class="chapter" data-level="10.1.3" data-path="chap10.html"><a href="chap10.html#background-and-data"><i class="fa fa-check"></i><b>10.1.3</b> Background and Data</a></li>
<li class="chapter" data-level="10.1.4" data-path="chap10.html"><a href="chap10.html#web-scraping"><i class="fa fa-check"></i><b>10.1.4</b> Web scraping</a></li>
<li class="chapter" data-level="10.1.5" data-path="chap10.html"><a href="chap10.html#html-documents"><i class="fa fa-check"></i><b>10.1.5</b> HTML Document’s</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chap10.html"><a href="chap10.html#references-5"><i class="fa fa-check"></i>References</a><ul>
<li class="chapter" data-level="" data-path="chap10.html"><a href="chap10.html#online-web-sites"><i class="fa fa-check"></i>Online web sites</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="r.html"><a href="r.html"><i class="fa fa-check"></i><b>A</b> Downloading and Installing R</a><ul>
<li class="chapter" data-level="A.1" data-path="r.html"><a href="r.html#downloading-r"><i class="fa fa-check"></i><b>A.1</b> Downloading R</a></li>
<li class="chapter" data-level="A.2" data-path="r.html"><a href="r.html#installing-r"><i class="fa fa-check"></i><b>A.2</b> Installing R</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="rstudio.html"><a href="rstudio.html"><i class="fa fa-check"></i><b>B</b> Downloading and Installing RStudio</a><ul>
<li class="chapter" data-level="B.1" data-path="rstudio.html"><a href="rstudio.html#downloading-rstudio"><i class="fa fa-check"></i><b>B.1</b> Downloading RStudio</a></li>
<li class="chapter" data-level="B.2" data-path="rstudio.html"><a href="rstudio.html#installing-rstudio"><i class="fa fa-check"></i><b>B.2</b> Installing Rstudio</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="files.html"><a href="files.html"><i class="fa fa-check"></i><b>C</b> Files</a><ul>
<li class="chapter" data-level="C.1" data-path="files.html"><a href="files.html#definition-and-file-names"><i class="fa fa-check"></i><b>C.1</b> Definition and file names</a></li>
<li class="chapter" data-level="C.2" data-path="files.html"><a href="files.html#formats"><i class="fa fa-check"></i><b>C.2</b> File formats</a></li>
<li class="chapter" data-level="C.3" data-path="files.html"><a href="files.html#paths"><i class="fa fa-check"></i><b>C.3</b> File Paths</a></li>
<li class="chapter" data-level="C.4" data-path="files.html"><a href="files.html#encoding"><i class="fa fa-check"></i><b>C.4</b> Encoding</a><ul>
<li class="chapter" data-level="C.4.1" data-path="files.html"><a href="files.html#ascii"><i class="fa fa-check"></i><b>C.4.1</b> ASCII</a></li>
<li class="chapter" data-level="C.4.2" data-path="files.html"><a href="files.html#utf-8"><i class="fa fa-check"></i><b>C.4.2</b> UTF-8</a></li>
</ul></li>
<li class="chapter" data-level="C.5" data-path="files.html"><a href="files.html#types-of-files"><i class="fa fa-check"></i><b>C.5</b> Types of files</a><ul>
<li class="chapter" data-level="C.5.1" data-path="files.html"><a href="files.html#text-files-and-binary-files"><i class="fa fa-check"></i><b>C.5.1</b> Text files and binary files</a></li>
<li class="chapter" data-level="C.5.2" data-path="files.html"><a href="files.html#free-format"><i class="fa fa-check"></i><b>C.5.2</b> Free format</a></li>
<li class="chapter" data-level="C.5.3" data-path="files.html"><a href="files.html#other-file-types-supported-by-base-r"><i class="fa fa-check"></i><b>C.5.3</b> Other file types supported by base R</a></li>
</ul></li>
<li class="chapter" data-level="C.6" data-path="files.html"><a href="files.html#summary"><i class="fa fa-check"></i><b>C.6</b> Summary</a></li>
<li class="chapter" data-level="C.7" data-path="files.html"><a href="files.html#references-6"><i class="fa fa-check"></i><b>C.7</b> References</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://helleng.github.io/Data_Mgt_Analysis_and_Graphics_R/tutorials" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Essentials</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chap8" class="section level1">
<h1><span class="header-section-number">Chapter 8</span> Plotting in Base R</h1>
<div id="goal-3" class="section level2 unnumbered">
<h2>Goal</h2>
<p>The main goal of this chapter is to introduce you to R’s plotting capabilities.</p>
</div>
<div id="what-we-shall-cover-6" class="section level2 unnumbered">
<h2>What we shall cover</h2>
<p>By the end of this chapter you should:</p>
<ul>
<li>Understand the basics of plotting in R</li>
<li>Be capable of calling and changing graphical parameters</li>
<li>Be skilled in annotating plots</li>
<li>Have capacity to produce different base R plots</li>
<li>Know how to use and create colors in base R</li>
<li>Be acquainted with R’s graphical devices</li>
</ul>
</div>
<div id="prerequisite-4" class="section level2 unnumbered">
<h2>Prerequisite</h2>
<p>To appreciate this chapter, you must be conversant with:</p>
<ul>
<li>Making function calls</li>
<li>Subsetting data objects</li>
</ul>
<p>Some understanding of these would be good though definitions are given within text and additional discussions will be given in later chapters.</p>
<ul>
<li><a href="#oop">Object Oriented Programming in R</a>, particularly concept of classes and generic functions</li>
<li>Looping in R (especially “sapply”, “lapply” and “by()”), we will discuss this in part tw.</li>
</ul>
</div>
<div id="introduction" class="section level2">
<h2><span class="header-section-number">8.1</span> Introduction</h2>
<p>Communicating outputs is the epitome of data analysis and one way to do it is through plots. Base R provides numerous plotting functions which produce some of the well known data display. To understand these functions and in deed many other plotting functions that come with contributed packages, you only need to learn one function, that is “plot()”.</p>
<p>In this regard, we shall begin this chapter by appreciating base R’s “plot” function as a guide to other plotting functions. It is anticipated that this understanding will enable you to not only make good plots but also comprehend and rectify errors as need be.</p>
<p><strong>Preliminaries</strong></p>
<p>Installing and loading required packages</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Require package reshape2 for a data set called tips</span>
if (!<span class="st">&quot;reshape2&quot;</span> %in%<span class="st"> </span><span class="kw">installed.packages</span>()[,<span class="dv">1</span>]) {
  <span class="kw">install.packages</span>(<span class="st">&quot;reshape2&quot;</span>, <span class="dt">lib =</span> <span class="kw">.libPaths</span>()[<span class="dv">1</span>])
}
<span class="kw">library</span>(reshape2)

<span class="co"># Require package ggplot2 for data set called economics</span>
if (!<span class="st">&quot;ggplot2&quot;</span> %in%<span class="st"> </span><span class="kw">installed.packages</span>()) {
  <span class="kw">installed.packages</span>(<span class="st">&quot;ggplot2&quot;</span>, <span class="dt">lib.loc =</span> <span class="kw">.libPaths</span>()[<span class="dv">1</span>])
}
<span class="kw">library</span>(ggplot2)</code></pre></div>
</div>
<div id="understanding-base-r-plotting-function" class="section level2">
<h2><span class="header-section-number">8.2</span> Understanding base R plotting function</h2>
<p>The main plotting function in base R is “plot()”, a S3 generic function. Generic functions are used to dispatch other functions called (methods). To understand generic functions, see them as tool boxes containing related tools. The work of these tool boxes (generic functions) is to give you an appropriate tool given a request. In this analogy, tools are methods defined to work on certain classed objects. Request can be viewed as first argument to a generic function. For tool box (a generic function) to give you a tool (method) your request (object) must first be classed or have a class attribute (we learnt this in chapter four), second, it’s class should be among those listed by methods. Listed by methods in the sense that there is a method for the given classed object. Let’s look as methods in plot() to grasp this.</p>
<p>All available methods in any given S3 generic can be shown with function “.S3method”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plotMethods &lt;-<span class="st"> </span><span class="kw">.S3methods</span>(<span class="st">&quot;plot&quot;</span>)
plotMethods
##  [1] plot.acf*           plot.data.frame*    plot.decomposed.ts*
##  [4] plot.default        plot.dendrogram*    plot.density*      
##  [7] plot.ecdf           plot.factor*        plot.formula*      
## [10] plot.function       plot.ggplot*        plot.gtable*       
## [13] plot.hclust*        plot.histogram*     plot.HoltWinters*  
## [16] plot.isoreg*        plot.lm*            plot.medpolish*    
## [19] plot.mlm*           plot.ppr*           plot.prcomp*       
## [22] plot.princomp*      plot.profile.nls*   plot.raster*       
## [25] plot.spec*          plot.stepfun        plot.stl*          
## [28] plot.table*         plot.ts             plot.tskernel*     
## [31] plot.TukeyHSD*     
## see &#39;?methods&#39; for accessing help and source code</code></pre></div>
<p>From output above, it is clear to see that plot has 31 methods, meaning plot can be called with 31 different objects.</p>
<p>S3 methods are in the form “genericname.class”, for example, for “plot.factor”, “plot” is the generic name while “factor” is class of objects expected when called. Usually we do not call methods directly as this is done by generic functions once they have identified an appropriate method. So in this case we would call plot() rather than plot.factor() or any other method it contains. It however does not mean a method can not be called directly, it can and it should work if correct class is selected, however, if future changes are made to methods in a generic, they will not be reflected in your code as you did not call generic.</p>
<p>With this soft landing on <a href="#oop">object oriented programming in R</a>, let’s look at some of plot()’s output to understand its dispatching mechanism.</p>
<div id="some-outputs-of-plot" class="section level3">
<h3><span class="header-section-number">8.2.1</span> Some outputs of plot()</h3>
<p>When x is a data frame (and y = NULL), a bivariate plot for all combination of variables is produced. These paired plots will differ depending on class of the variable taken as “x”. For example, for a data frame with three variables 9 scatter plots will be generated.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># All possible combinations of a data frame with three variables</span>
variables &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;X&quot;</span>, <span class="st">&quot;Y&quot;</span>, <span class="st">&quot;Z&quot;</span>)
<span class="kw">nrow</span>(<span class="kw">expand.grid</span>(variables, variables))
## [1] 9</code></pre></div>
<p>We will used base R’s data sets to see plots produced y different inputs to “plot()”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Data</span>
<span class="co">#----------</span>
<span class="kw">set.seed</span>(<span class="dv">5839</span>)
a &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">sample</span>(letters, <span class="dv">10</span>))
<span class="kw">set.seed</span>(<span class="dv">84758</span>)
b &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>, <span class="dv">60</span>, <span class="dv">10</span>)
<span class="kw">class</span>(a)
## [1] &quot;factor&quot;
<span class="kw">class</span>(b)
## [1] &quot;numeric&quot;

<span class="co"># Passing individual vector (they must be of the same length)</span>
<span class="co">#------------------------------------------------------------</span>
<span class="co"># When x is a factor vector</span>
<span class="kw">plot</span>(<span class="dt">x =</span> a, <span class="dt">y =</span> b, <span class="dt">main =</span> <span class="st">&#39;When &quot;x&quot; is a factor object&#39;</span>)</code></pre></div>
<p><img src="figures/plotDataFrame-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">     
<span class="co"># When x is a numeric vector</span>
<span class="kw">plot</span>(<span class="dt">x =</span> b, <span class="dt">y =</span> a, <span class="dt">main =</span> <span class="st">&#39;When x is a &quot;numeric&quot; object&#39;</span>)</code></pre></div>
<p><img src="figures/plotDataFrame-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Passing a data frame object</span>
<span class="co">#----------------------------</span>
<span class="co"># Data frame with two numerical variables</span>
<span class="kw">sapply</span>(BOD, class)
##      Time    demand 
## &quot;numeric&quot; &quot;numeric&quot;
<span class="kw">plot</span>(BOD, <span class="dt">main =</span> <span class="st">&quot;Data frame with two numeric vectors&quot;</span>)</code></pre></div>
<p><img src="figures/plotDataFrame-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Data frame with 12 numerical variables</span>
<span class="kw">sapply</span>(USJudgeRatings, class)
##      CONT      INTG      DMNR      DILG      CFMG      DECI      PREP 
## &quot;numeric&quot; &quot;numeric&quot; &quot;numeric&quot; &quot;numeric&quot; &quot;numeric&quot; &quot;numeric&quot; &quot;numeric&quot; 
##      FAMI      ORAL      WRIT      PHYS      RTEN 
## &quot;numeric&quot; &quot;numeric&quot; &quot;numeric&quot; &quot;numeric&quot; &quot;numeric&quot;
<span class="kw">plot</span>(USJudgeRatings, <span class="dt">main =</span> <span class="st">&quot;Data frame with 12 numeric vectors&quot;</span>)</code></pre></div>
<p><img src="figures/plotDataFrame-4.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Data frame with 5 mixed factor and numerical variables </span>
<span class="kw">sapply</span>(CO2, class)
## $Plant
## [1] &quot;ordered&quot; &quot;factor&quot; 
## 
## $Type
## [1] &quot;factor&quot;
## 
## $Treatment
## [1] &quot;factor&quot;
## 
## $conc
## [1] &quot;numeric&quot;
## 
## $uptake
## [1] &quot;numeric&quot;
<span class="kw">plot</span>(CO2, <span class="dt">main =</span> <span class="st">&quot;Data frame with 3 factor and 2 numeric vectors&quot;</span>)</code></pre></div>
<p><img src="figures/plotDataFrame-5.png" width="672" /></p>
<p>Clearly, it might be wise to avoid calling plot with a data frames multiple variables as they might not be fitted in the plotting window.</p>
<p>For time series objects, plot() will call “plot.ts()” which is basically a line plot, that is plot(type = “l”). For decomposed time series (we shall discuss this in book three: Introduction to Data Analysis usinf R), plot will call plot.decomposed.ts() which will output a plot of each decomposed component.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(AirPassengers)
## [1] &quot;ts&quot;
<span class="kw">plot</span>(AirPassengers)</code></pre></div>
<p><img src="figures/plotTs-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Decomposing a time series</span>
decomposed &lt;-<span class="st"> </span><span class="kw">decompose</span>(AirPassengers)
<span class="kw">plot</span>(decomposed)</code></pre></div>
<p><img src="figures/plotTs-2.png" width="672" /></p>
<p>Factor vectors passed to plot() will produce bar plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(state.division)
## [1] &quot;factor&quot;
<span class="kw">plot</span>(state.division, <span class="dt">main =</span> <span class="st">&quot;x as a single factor vector&quot;</span>) </code></pre></div>
<p><img src="figures/plotFactor-1.png" width="672" /></p>
<p>Objects with class table produce mosaic plots</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(HairEyeColor)
## [1] &quot;table&quot;
<span class="kw">plot</span>(HairEyeColor, <span class="dt">main =</span> <span class="st">&quot;x as an object of class table&quot;</span>)</code></pre></div>
<p><img src="figures/plotTable-1.png" width="672" /></p>
<p>Calling plot() with an object whose class is not among the listed 33 methods will result in plot() dispatching “plot.default”. plot.default() will attempt to produce a scatter (bivariate/two variable) plot of x and y. If only x is provided, R will plot it against a sequence of integers the same length as x.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Creating a numerical object with random numbers</span>
<span class="kw">set.seed</span>(<span class="dv">5739</span>)
x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dv">100</span>, <span class="dv">5</span>)
x
##  [1]  99.0593799  97.1132127 100.4853745  98.0842471  96.7187704
##  [6] 102.1275806 101.3459762 100.2236563  96.7410344 101.4361206
## [11]  98.9758597  91.8440020  92.8211197 103.5275907 104.4196583
## [16]  99.6948756 103.6735197 103.4417283 101.9138219  97.9801409

<span class="co"># Checking for a method for objects classed numeric</span>
<span class="kw">class</span>(x); <span class="kw">grep</span>(<span class="dt">pattern =</span> <span class="kw">class</span>(x), <span class="dt">x =</span> <span class="kw">methods</span>(<span class="st">&quot;plot&quot;</span>))
## [1] &quot;numeric&quot;
## integer(0)

<span class="co"># Calling plot()</span>
<span class="kw">plot</span>(x)</code></pre></div>
<p><img src="figures/plottingNumerical-1.png" width="672" /></p>
<p>For non-numerical objects for which plot() has no method, plot.default() will attempt to convert them to finite objects when computing axis limits, if coercion is not feasible, then an error will be issued with additional warning messages.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(letters)
<span class="co"># Error in plot.window(..) : need finite &#39;xlim&#39; values</span>
<span class="co"># In addition: Warning messages:</span>
<span class="co"># 1: In xy.coord(x, y, xlabel, ylabel, log) : NAs introduced by coercion</span>
<span class="co"># 2: In min(x): no non-missing arguments to min; returning Inf</span>
<span class="co"># 3: In max(x): no non-missing arguments to max; returning -Inf</span></code></pre></div>
<p>From preceding discussion, it should now be clear that class of plot()’s first argument (x), will determine the plotting method to be selected. This (dispatched) method will then output a plot based on all arguments passed to plot. Hence, a method can output different plots based on the same data (objects passed to x and y) given different values for other arguments. To understand these differences as well as potential error points, it is important to understand how plot() works.</p>
<p>This will require us to go to plots internals.</p>
</div>
<div id="functionDefinition" class="section level3">
<h3><span class="header-section-number">8.2.2</span> plot() Internals</h3>
<p>To know how a function works means inspecting its definition. A function’s definition is its body <a href="#fn6" class="footnoteRef" id="fnref6"><sup>6</sup></a> which can be seen by calling the function without parenthesis.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># &quot;plots&quot; function definition</span>
plot</code></pre></div>
<p>Plot’s function definition is not written in R, but the code is similar to R so here’s an R version.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plotDefault &lt;-<span class="st"> </span>function(x, <span class="dt">y =</span> <span class="ot">NULL</span>, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>, <span class="dt">xlim =</span> <span class="ot">NULL</span>, <span class="dt">ylim =</span> <span class="ot">NULL</span>, <span class="dt">log =</span> <span class="st">&quot;&quot;</span>, <span class="dt">main =</span> <span class="ot">NULL</span>, <span class="dt">sub =</span> <span class="ot">NULL</span>, <span class="dt">xlab =</span> <span class="ot">NULL</span>, <span class="dt">ylab =</span> <span class="ot">NULL</span>, <span class="dt">ann =</span> <span class="kw">par</span>(<span class="st">&quot;ann&quot;</span>), <span class="dt">axes =</span> <span class="ot">TRUE</span>, <span class="dt">frame.plot =</span> axes, <span class="dt">panel.first =</span> <span class="ot">NULL</span>, <span class="dt">panel.last =</span> <span class="ot">NULL</span>, <span class="dt">asp =</span> <span class="ot">NA</span>, ...){
  localAxis &lt;-<span class="st"> </span>function(..., col, bg, pch, cex, lty, lwd) <span class="kw">Axis</span>(...)
  localBox  &lt;-<span class="st"> </span>function(..., col, bg, pch, cex, lty, lwd) <span class="kw">box</span>(...)
  localWindow &lt;-<span class="st"> </span>function(..., col, bg, pch, cex, lty, lwd) <span class="kw">plot.window</span>(...)
  localTitle &lt;-<span class="st"> </span>function(..., col, bg, pch, cex, lty, lwd) <span class="kw">title</span>(...)
  xlabel &lt;-<span class="st"> </span>if (!<span class="kw">missing</span>(x)) <span class="kw">deparse</span>(<span class="kw">substitute</span>(x))
  ylabel &lt;-<span class="st"> </span>if (!<span class="kw">missing</span>(y)) <span class="kw">deparse</span>(<span class="kw">substitute</span>(y))
  xy &lt;-<span class="st"> </span><span class="kw">xy.coords</span>(x, y, xlabel, ylabel, log)
  xlab &lt;-<span class="st"> </span>if (<span class="kw">is.null</span>(xlab)) {
    xy$xlab
    } else xlab
  ylab &lt;-<span class="st"> </span>if (<span class="kw">is.null</span>(ylab)) {
    xy$ylab
  } else ylab
  xlim &lt;-<span class="st"> </span>if (<span class="kw">is.null</span>(xlim)) {
    <span class="kw">range</span>(xy$x[<span class="kw">is.finite</span>(xy$x)])
    } else xlim
  ylim &lt;-<span class="st"> </span>if (<span class="kw">is.null</span>(ylim)) {
    <span class="kw">range</span>(xy$y[<span class="kw">is.finite</span>(xy$y)])
  } else ylim
  <span class="kw">dev.hold</span>()
  <span class="kw">on.exit</span>(<span class="kw">dev.flush</span>())
  <span class="kw">plot.new</span>()
  <span class="kw">localWindow</span>(xlim, ylim, log, asp, ...)
  panel.first
  <span class="kw">plot.xy</span>(xy, type, ...)
  panel.last
  if (axes) {
    <span class="kw">localAxis</span>(if (<span class="kw">is.null</span>(y)) xy$x  else x, <span class="dt">side =</span> <span class="dv">1</span>, ...)
    <span class="kw">localAxis</span>(if (<span class="kw">is.null</span>(y))    x  else y, <span class="dt">side =</span> <span class="dv">2</span>, ...)
  }
  if (frame.plot) 
    <span class="kw">localBox</span>(...)
  if (ann)
    <span class="kw">localTitle</span>(<span class="dt">main =</span> main, <span class="dt">sub =</span> sub, <span class="dt">xlab =</span> xlab, <span class="dt">ylab =</span> ylab, ...)
  <span class="kw">invisible</span>()
}</code></pre></div>
<p>From this definition, there are roughly eight steps taken to output a basic plot. These are:</p>
<ol style="list-style-type: decimal">
<li>Open new plotting window</li>
<li>Set x and y coordinates</li>
<li>Evaluate and execute any pre-plot expressions</li>
<li>Make the actual plot</li>
<li>Evaluate and execute post-plot and pre-axis expressions</li>
<li>Add axis if required</li>
<li>Frame plot if needed</li>
<li>Annotate, and finally display plot</li>
</ol>
<p>Let’s go through these step by step and link them to plot’s arguments with a purpose of understanding expected values and their implication on output generated.</p>
</div>
<div id="step-one-opening-new-window" class="section level3">
<h3><span class="header-section-number">8.2.3</span> Step one: Opening new window</h3>
<p>When plot is called, the first thing it does is call a low level function “plot.new()”. This function is responsible for opening a plotting window on the <a href="chap8.html#graphicalDevices">active device</a>. There are no arguments to this function though its background color can be changed from default to another color using <a href="chap8.html#par">graphical paramenters</a> which we will learn in the next section.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Opening graphing window</span>
<span class="kw">plot.new</span>()</code></pre></div>
<p>We can take this to be like a frame for our canvas.</p>
</div>
<div id="step-two-setting-plotting-coordinates" class="section level3">
<h3><span class="header-section-number">8.2.4</span> Step two: Setting plotting coordinates</h3>
<p>With plotting window opened, plot() will specify actual plotting area on a Cartesian plane by calling “plot.window()”. By default, range (minimum and maximum values) of x and y are used otherwise these can be values passed to “xlim” and “ylim”. We can consider this our canvas.</p>
<p>Note, if only one value is passed to plot(), it will be taken as “x” and “y” will be created as a sequence of values from 1 up to length of “x” (index of x). Plot will then map “x” values on the y axis and “y” values (indices) on the x axis. In this case, “x limit” (xlim) will be minimum and maximum values of y and not x, while “y limit” (ylim) will be minimum and maximum values of “x”. Otherwise, if both x and y values are given they will be mapped as usual.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Open a new graphical window</span>
<span class="kw">plot.new</span>()</code></pre></div>
<p><img src="figures/unnamed-chunk-137-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Default</span>
<span class="kw">range</span>(x); <span class="kw">round</span>(<span class="kw">range</span>(x))
## [1]  91.844002 104.419658
## [1]  92 104
xlim &lt;-<span class="st"> </span><span class="kw">range</span>(<span class="dv">1</span>:<span class="kw">length</span>(x))
ylim &lt;-<span class="st"> </span><span class="kw">range</span>(x)
<span class="kw">plot.window</span>(<span class="dt">xlim =</span> xlim, <span class="dt">ylim =</span> ylim)</code></pre></div>
<p>Don’t expect any output or visible action from “plot.window” as it invisibly creates the coordinate system.</p>
<p>But just to see what it does, we will display an empty plot and extend its limits.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plotting Area</span>
<span class="kw">plot</span>(x, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Default Cartesian Plane&quot;</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-139-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Plotting area with user defined limits (a bit of padding)</span>
xlm &lt;-<span class="st"> </span><span class="kw">extendrange</span>(x, <span class="dt">f =</span> <span class="fl">0.2</span>); <span class="kw">round</span>(xlm)
## [1]  89 107
ylm &lt;-<span class="st"> </span><span class="kw">extendrange</span>(<span class="dv">1</span>:<span class="kw">length</span>(x), <span class="dt">f =</span> <span class="fl">0.2</span>); <span class="kw">round</span>(ylm)
## [1] -3 24
<span class="kw">plot</span>(x, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, ylm[<span class="dv">2</span>]), <span class="dt">ylim =</span> xlm, <span class="dt">main =</span> <span class="st">&quot;Extended Plotting Limits&quot;</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-139-2.png" width="672" /></p>
<p>When incorrect limits are given to either “xlim” or “ylim”, an error will be issued indicating “plot.window()” is not able to construct the plane. For example, it is expected that x and y limits will be vectors of length two having minimum and maximum (range) values of x and y, if this is not so, execution stops with an error message.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(x, <span class="dt">xlim =</span> <span class="dv">13</span>, <span class="dt">ylim =</span> <span class="dv">4</span>)
## Error in plot.window(...) : invalid &#39;xlim&#39; value</code></pre></div>
<p>Hope you notice a new plotting window was opened with “plot.new()” before issuing the error.</p>
</div>
<div id="step-three-evaluate-and-execute-pre-post-functions" class="section level3">
<h3><span class="header-section-number">8.2.5</span> Step three: Evaluate and execute pre-post functions</h3>
<p>If there are certain actions to be done before a plot is generated they will be evaluated and executed. This is especially useful when actions to be done have an effect on data points or lines. For example, when adding grid lines or line of best fit, you would want to include this before data points to avoid plotting on top of the point.</p>
<p>Pre-plotting functions are passed to argument “panel.first” in plot.default. But to demonstrate how it is implemented, we are building our plot from our canvas.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.new</span>()
<span class="kw">plot.window</span>(<span class="dt">xlim =</span> xlim, <span class="dt">ylim =</span> ylim)
<span class="kw">grid</span>(<span class="dv">10</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-142-1.png" width="672" /></p>
<p>Since “plot.window” merely created our plotting area, what we have is a canvas with grid lines.</p>
</div>
<div id="step-four-plotting" class="section level3">
<h3><span class="header-section-number">8.2.6</span> Step four: Plotting</h3>
<p>Before plotting, plot() calls “xy.coords” to generate x and y coordinates. xy.coord() is a low level standardizing function called by most of R’s high level plotting functions. Its core role is to ensure consistency in how x and y coordinates are generated. Output of this function is a list consisting of four elements; x and y coordinates plus x and y label (if given).</p>
<p>This is the function that generates sequence of numbers (1:length(x)) in the event y is not given.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">coords &lt;-<span class="st"> </span><span class="kw">xy.coords</span>(x)
coords
## $x
##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
## 
## $y
##  [1]  99.0593799  97.1132127 100.4853745  98.0842471  96.7187704
##  [6] 102.1275806 101.3459762 100.2236563  96.7410344 101.4361206
## [11]  98.9758597  91.8440020  92.8211197 103.5275907 104.4196583
## [16]  99.6948756 103.6735197 103.4417283 101.9138219  97.9801409
## 
## $xlab
## [1] &quot;Index&quot;
## 
## $ylab
## NULL</code></pre></div>
<p>With coordinates determined, plot() calls a another low level internal plotting function to do the actual plot, that is “plot.xy()” written internally in C language.</p>
<p>plot() calls plot.xy() function with output of xy.coords() and expected plot type, by default this is “p” for points. It also passes along the other values given during the call.</p>
<p>With grid lines set we can add points on top.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.new</span>()
<span class="kw">plot.window</span>(<span class="dt">xlim =</span> xlim, <span class="dt">ylim =</span> ylim)
<span class="kw">grid</span>(<span class="dv">10</span>)
<span class="kw">plot.xy</span>(coords, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-144-1.png" width="672" /></p>
<p>We have made significant progress, but as you can see, this plot does not have any axis, just grid lines and points. Axes are drawn after implementing any pre-axis expressions.</p>
</div>
<div id="step-five-evaluation-of-post-plot-and-pre-axis-expressions" class="section level3">
<h3><span class="header-section-number">8.2.7</span> Step five: Evaluation of post-plot and pre-axis expressions</h3>
<p>Just like pre-plotting functions, “plot()” will look for functions passed to “panel.last” argument and evaluate them before constructing an axis.</p>
<p>Here let’s add a spline which is an interpolation line (we discuss this a bit later in this chapter, but an in-depth discussion will be during our chapter on data analysis).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.new</span>()
<span class="kw">plot.window</span>(<span class="dt">xlim =</span> xlim, <span class="dt">ylim =</span> ylim)
<span class="kw">grid</span>(<span class="dv">10</span>)
<span class="kw">plot.xy</span>(coords, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>)
<span class="kw">lines</span>(<span class="kw">spline</span>(x), <span class="dt">col =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="figures/preAxisFunctions-1.png" width="672" /></p>
<p>Notice grid lines are below data points while spline is on top of the data points. Also notice some tips (minimum and maximum) of the spline are clipped as they extend outside the canvas (plotting area); later we shall see some of the ways to rectify it.</p>
</div>
<div id="step-six-construct-axis" class="section level3">
<h3><span class="header-section-number">8.2.8</span> Step six: Construct Axis</h3>
<p>After implementing post-plotting or pre-axis functions, plot will add axis at the bottom and left side of the plot. Tick marks are computed with a lower level function “axisTicks”, this function is called by “axis” function responsible for adding axis to plots. To generate labels for numerical axis, function “Axis” is called to generate appropriate labels before calling axis to draw them.</p>
<p>It might be useful to note the two similar function, “Axis” and “axis”. “Axis” is a generic function used mostly to develop axis labels for numerical data while “axis” is the main function used to draw axis on a plot. Hence in this case, plot() calls “Axis” as it will generate appropriate labels.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.new</span>()
<span class="kw">plot.window</span>(<span class="dt">xlim =</span> xlim, <span class="dt">ylim =</span> ylim)
<span class="kw">grid</span>(<span class="dv">10</span>)
<span class="kw">plot.xy</span>(coords, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>)
<span class="kw">lines</span>(<span class="kw">spline</span>(x), <span class="dt">col =</span> <span class="dv">4</span>)

<span class="co"># Adding horizontal (x) axis</span>
<span class="kw">Axis</span>(x, <span class="dt">side =</span> <span class="dv">1</span>)

<span class="co"># Adding vertical (y) axis</span>
<span class="kw">Axis</span>(x, <span class="dt">side =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-145-1.png" width="672" /></p>
</div>
<div id="step-seven-ploting-frame" class="section level3">
<h3><span class="header-section-number">8.2.9</span> Step Seven: Ploting frame</h3>
<p>Once axis are drawn, a frame is added to the plot by default although this can be suppressed by setting “frame.plot” argument to FALSE.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.new</span>()
<span class="kw">plot.window</span>(<span class="dt">xlim =</span> xlim, <span class="dt">ylim =</span> ylim)
<span class="kw">grid</span>(<span class="dv">10</span>)
<span class="kw">plot.xy</span>(coords, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>)
<span class="kw">lines</span>(<span class="kw">spline</span>(x), <span class="dt">col =</span> <span class="dv">2</span>)
<span class="kw">axis</span>(<span class="dv">1</span>)
<span class="kw">axis</span>(<span class="dv">2</span>)

<span class="co"># Adding a frame</span>
<span class="kw">box</span>()</code></pre></div>
</div>
<div id="step-eight-annotation" class="section level3">
<h3><span class="header-section-number">8.2.10</span> Step Eight: Annotation</h3>
<p>Finally the plot is annotated with axis labels. Default labels are extracted from the call to plot() (what is passed to “x” and “y”).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.new</span>()
<span class="kw">plot.window</span>(<span class="dt">xlim =</span> <span class="kw">range</span>(<span class="dv">1</span>:<span class="kw">length</span>(x)), <span class="dt">ylim =</span> <span class="kw">range</span>(x))
<span class="kw">grid</span>(<span class="dv">10</span>)
<span class="kw">plot.xy</span>(coords, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>)
<span class="kw">lines</span>(<span class="kw">spline</span>(x), <span class="dt">col =</span> <span class="dv">4</span>)
<span class="kw">axis</span>(<span class="dv">1</span>)
<span class="kw">axis</span>(<span class="dv">2</span>)
<span class="kw">box</span>()

<span class="co"># Annotating with axis labels</span>
<span class="kw">title</span>(<span class="dt">xlab =</span> <span class="st">&quot;Index&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;x&quot;</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-147-1.png" width="672" /></p>
</div>
<div id="summary-final-output" class="section level3">
<h3><span class="header-section-number">8.2.11</span> Summary: Final output</h3>
<p>With that, you receive a basic plot. In summary these are the steps taken to produce this plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Step 1: Open new plotting window</span>
<span class="kw">plot.new</span>()

<span class="co"># Step 2: Set up coordinate window (canvas)</span>
<span class="kw">plot.window</span>(<span class="dt">xlim =</span> <span class="kw">range</span>(<span class="dv">1</span>:<span class="kw">length</span>(x)), <span class="dt">ylim =</span> <span class="kw">range</span>(x))

<span class="co"># Step 3: Evaluate and execute pre-plotting function</span>
<span class="kw">grid</span>(<span class="dv">10</span>)

<span class="co"># Step 4: Call actual plotting function</span>
<span class="kw">plot.xy</span>(<span class="kw">xy.coords</span>(x), <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>)

<span class="co"># Step 5: Evaluate and implement post-plot and pre-axis functions</span>
<span class="kw">lines</span>(<span class="kw">spline</span>(x), <span class="dt">col =</span> <span class="dv">4</span>)

<span class="co"># Step 6: Add axis</span>
<span class="kw">axis</span>(<span class="dv">1</span>)
<span class="kw">axis</span>(<span class="dv">2</span>)

<span class="co"># Step 7: Add a frame to plot</span>
<span class="kw">box</span>()

<span class="co"># Step 8: Annotate with axis labels</span>
<span class="kw">title</span>(<span class="dt">xlab =</span> <span class="st">&quot;Index&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;x&quot;</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-148-1.png" width="672" /></p>
<p>You can generate an exact copy of this plot with <code>plot(x, panel.first = grid(10), panel.last = lines(spline(x), col = 4))</code></p>
</div>
<div id="commentedDefinition" class="section level3">
<h3><span class="header-section-number">8.2.12</span> A commented basic plot definition</h3>
<p>Having gone through the eight steps, reading through plot()’s definition with added comments will now be much more informative.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">source</span>(<span class="st">&quot;~/R/Scripts/commentedPlotDefault.R&quot;</span>)</code></pre></div>
<p>Next we discuss how to improve output of a plot by changing graphical parameters.</p>
</div>
</div>
<div id="par" class="section level2">
<h2><span class="header-section-number">8.3</span> Graphical Parameters and Annotating Base R Plots</h2>
<p>Output of base R’s default plot is as basic as it gets, however, R provides several graphical parameters and annotating functions for improving it. In this section we will go through some of base R’s graphical and annotation function as we try to make communicative plot.</p>
<div id="querying-saving-and-resetting-graphical-parameters" class="section level3">
<h3><span class="header-section-number">8.3.1</span> Querying, saving and resetting graphical parameters</h3>
<p>In total, there are 72 graphical parameters which control a plot’s output.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Number of graphical parameters</span>
<span class="kw">length</span>(<span class="kw">par</span>())
## [1] 72

<span class="co"># All graphical parameters</span>
<span class="kw">names</span>(<span class="kw">par</span>())
##  [1] &quot;xlog&quot;      &quot;ylog&quot;      &quot;adj&quot;       &quot;ann&quot;       &quot;ask&quot;      
##  [6] &quot;bg&quot;        &quot;bty&quot;       &quot;cex&quot;       &quot;cex.axis&quot;  &quot;cex.lab&quot;  
## [11] &quot;cex.main&quot;  &quot;cex.sub&quot;   &quot;cin&quot;       &quot;col&quot;       &quot;col.axis&quot; 
## [16] &quot;col.lab&quot;   &quot;col.main&quot;  &quot;col.sub&quot;   &quot;cra&quot;       &quot;crt&quot;      
## [21] &quot;csi&quot;       &quot;cxy&quot;       &quot;din&quot;       &quot;err&quot;       &quot;family&quot;   
## [26] &quot;fg&quot;        &quot;fig&quot;       &quot;fin&quot;       &quot;font&quot;      &quot;font.axis&quot;
## [31] &quot;font.lab&quot;  &quot;font.main&quot; &quot;font.sub&quot;  &quot;lab&quot;       &quot;las&quot;      
## [36] &quot;lend&quot;      &quot;lheight&quot;   &quot;ljoin&quot;     &quot;lmitre&quot;    &quot;lty&quot;      
## [41] &quot;lwd&quot;       &quot;mai&quot;       &quot;mar&quot;       &quot;mex&quot;       &quot;mfcol&quot;    
## [46] &quot;mfg&quot;       &quot;mfrow&quot;     &quot;mgp&quot;       &quot;mkh&quot;       &quot;new&quot;      
## [51] &quot;oma&quot;       &quot;omd&quot;       &quot;omi&quot;       &quot;page&quot;      &quot;pch&quot;      
## [56] &quot;pin&quot;       &quot;plt&quot;       &quot;ps&quot;        &quot;pty&quot;       &quot;smo&quot;      
## [61] &quot;srt&quot;       &quot;tck&quot;       &quot;tcl&quot;       &quot;usr&quot;       &quot;xaxp&quot;     
## [66] &quot;xaxs&quot;      &quot;xaxt&quot;      &quot;xpd&quot;       &quot;yaxp&quot;      &quot;yaxs&quot;     
## [71] &quot;yaxt&quot;      &quot;ylbias&quot;</code></pre></div>
<p>All of these parameters have defaults values which can be queried with “par” function. Object returned will depend on number of graphical parameters queried.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Quering default value(s)</span>
<span class="co">#-----------------------</span>
<span class="co"># Quering one graphical parameter returns a vector</span>
<span class="kw">par</span>(<span class="st">&quot;mar&quot;</span>)
## [1] 5.1 4.1 4.1 2.1
<span class="kw">class</span>(<span class="kw">par</span>(<span class="st">&quot;mar&quot;</span>))
## [1] &quot;numeric&quot;

<span class="co"># Quering multiple graphical parameters returns a list</span>
<span class="kw">par</span>(<span class="st">&quot;mfrow&quot;</span>, <span class="st">&quot;mar&quot;</span>, <span class="st">&quot;oma&quot;</span>, <span class="st">&quot;cex&quot;</span>, <span class="st">&quot;font&quot;</span>)
## $mfrow
## [1] 1 1
## 
## $mar
## [1] 5.1 4.1 4.1 2.1
## 
## $oma
## [1] 0 0 0 0
## 
## $cex
## [1] 1
## 
## $font
## [1] 1
<span class="kw">class</span>(<span class="kw">par</span>(<span class="st">&quot;mfrow&quot;</span>, <span class="st">&quot;mar&quot;</span>, <span class="st">&quot;oma&quot;</span>, <span class="st">&quot;cex&quot;</span>, <span class="st">&quot;font&quot;</span>))
## [1] &quot;list&quot;</code></pre></div>
<p>Default values can be saved and reset. Resetting to original parameters will be based on type of object save as having original values. If one value was save, then entire object can be used, otherwise if multiple parameters were were saved, then they would be in list form and usual list subsetting will be implemented.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Saving default values and resetting original parameter(s)</span>
<span class="co">#----------------------------------------------------------</span>
<span class="co"># Saving one parameter</span>
op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;mar&quot;</span>)
<span class="co"># Resetting using saved vector</span>
<span class="kw">par</span>(<span class="dt">mar =</span> op)

<span class="co"># Saving multiple parameters</span>
op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;mfrow&quot;</span>, <span class="st">&quot;mar&quot;</span>, <span class="st">&quot;oma&quot;</span>, <span class="st">&quot;cex&quot;</span>, <span class="st">&quot;font&quot;</span>)
<span class="co"># Resetting using saved list</span>
<span class="kw">par</span>(<span class="dt">mfrow =</span> op$mfrow, <span class="dt">mar =</span> op$mar, <span class="dt">oma =</span> op$oma, <span class="dt">cex =</span> op$cex, <span class="dt">font =</span> op$font)</code></pre></div>
</div>
<div id="settingchanging-graphical-parameters" class="section level3">
<h3><span class="header-section-number">8.3.2</span> Setting/Changing graphical parameters</h3>
<p>Out of the 72 parameters, 66 can be changed while 6 are read only (RO). Read only graphical parameters are, “cin”, “cra”, “csi”, “cxy”, “din”, and “page”.</p>
<p>For the 66 parameters, there exists two ways for setting different graphical parameters, one has a global effect as it affects all subsequent plots during an R session and the other has a temporal effect. Global changes are made with “par” function while temporal changes are made by passing graphical parameters as arguments to plotting functions. Many of the ‘r length(par(no.readonly = TRUE))’ non-read-only parameters can be passed as plotting argument with exception of 22 parameters detailed on “par” help page (?par).</p>
<p>When setting parameters using “par” function, it’s important to save original parameters and reset once plotting is complete.</p>
<p>As an example, let’s see how to make global and temporal changes for one and multiple graphical parameters.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 1. Changing global parameters</span>
<span class="co">#-------------------------------</span>
<span class="co"># Save original parameter value</span>
op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;cex.main&quot;</span>)
<span class="co"># Set new parameter value </span>
<span class="kw">par</span>(<span class="dt">cex.main =</span> <span class="fl">0.7</span>)
<span class="co"># Generate a plot</span>
<span class="kw">plot</span>(x, <span class="dt">main =</span> <span class="st">&quot;Making Header smaller: a single global change&quot;</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-151-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Reset original parameter</span>
<span class="kw">par</span>(<span class="dt">cex.main =</span> op)

<span class="co"># Save multiple values of original parameter</span>
op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;bg&quot;</span>, <span class="st">&quot;font.lab&quot;</span>, <span class="st">&quot;fg&quot;</span>, <span class="st">&quot;las&quot;</span>, <span class="st">&quot;cex.main&quot;</span>)
<span class="co"># Set several parameters</span>
<span class="kw">par</span>(<span class="dt">bg =</span> <span class="st">&quot;snow&quot;</span>, <span class="dt">font.lab =</span> <span class="dv">4</span>, <span class="dt">fg =</span> <span class="st">&quot;deeppink&quot;</span>, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">cex.main =</span> <span class="fl">0.7</span>)
<span class="co"># Generate plot</span>
<span class="kw">plot</span>(x, <span class="dt">main =</span> <span class="st">&#39;Multiple changes made by calling par()&#39;</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-151-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Reset original parameters</span>
<span class="kw">par</span>(<span class="dt">bg =</span> op$bg, <span class="dt">font.lab =</span> op$font.lab, <span class="dt">fg =</span> op$fg, <span class="dt">las =</span> op$las, <span class="dt">cex.main =</span> op$cex.main)

<span class="co"># 2. Adding graphical parameters as arguments to plot, has a temporal effect</span>
<span class="co">#---------------------------------------------------------------------------</span>
<span class="kw">plot</span>(x, <span class="dt">main =</span> <span class="st">&quot;Multiple changes made by adding par arguments&quot;</span>, <span class="dt">font.lab =</span> <span class="dv">2</span>, <span class="dt">fg =</span> <span class="st">&quot;deeppink&quot;</span>, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">cex.main =</span> <span class="fl">0.7</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-151-3.png" width="672" /></p>
</div>
<div id="implementing-some-graphical-parameters-and-annotation" class="section level3">
<h3><span class="header-section-number">8.3.3</span> Implementing some graphical parameters and annotation</h3>
<p>With knowledge on how to query, save, set and reset graphical parameters, let’s now explore a few more parameters to see how to drastically change a plot’s output.</p>
<p>In this small venture, we will see how to make multi-panel plots, use color, annotate with titles, reconstruct axis, use different plotting characters and add lines as informative displays (statistical lines) or for aesthetic.</p>
<div id="multi-paneling" class="section level4">
<h4><span class="header-section-number">8.3.3.1</span> Multi-paneling</h4>
<p>Multiple plots can be displayed on the same window. R provides two graphical parameters to create multi-panel layout, these are “mfrow” and “mfcol”. “mfrow” creates multiple plots by row order while mfcol created layout by column order. Both of these parameters can only be set by calling “par” function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># As good practice, querying and saving default values</span>
op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;mfrow&quot;</span>); op
## [1] 1 1

<span class="co"># Implementing a row order layout </span>
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))

<span class="co"># Making two plotting</span>
<span class="kw">plot</span>(x, <span class="dt">main =</span> <span class="st">&quot;Plot one&quot;</span>)
<span class="kw">plot</span>(BOD, <span class="dt">main =</span> <span class="st">&quot;Plot two&quot;</span>)</code></pre></div>
<p><img src="figures/multiPaneling-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Resetting original parameter</span>
<span class="kw">par</span>(<span class="dt">mfrow =</span> op)

<span class="co"># Confirm restoration</span>
<span class="kw">par</span>(<span class="st">&quot;mfrow&quot;</span>)
## [1] 1 1</code></pre></div>
</div>
<div id="annotating-plots-with-titles-and-labels" class="section level4">
<h4><span class="header-section-number">8.3.3.2</span> Annotating plots with titles and labels</h4>
<p>There are three ways of annotating plots with titles and labels. The first involves calling a plotting function with titles and labels as arguments, the second is by calling “title” function and third is using “mtext” which adds these annotations as margin text.</p>
<div id="titles-and-labels-as-as-arguments-to-plotting-functions" class="section level5">
<h5><span class="header-section-number">8.3.3.2.1</span> Titles and labels as as arguments to plotting functions</h5>
<p>The easiest way to add titles and labels to a plot is adding them as arguments when calling plot. These annotations can also be formatted by adding specific graphical parameters like color, size, type, and alignment.</p>
<p>As an example we are going to add a bold and slant main title, a grey, slant and smaller sub title, and a slant y label.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Annotating with titles and labels and formatting them</span>
<span class="kw">plot</span>(BOD, <span class="dt">main =</span> <span class="st">&quot;Biochemical Oxygen Demand&quot;</span>, <span class="dt">sub =</span> <span class="st">&quot;Originally from Marske (1967)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Demand&quot;</span>, <span class="dt">font.main =</span> <span class="dv">4</span>, <span class="dt">cex.sub =</span> <span class="fl">0.7</span>, <span class="dt">col.sub =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">font.sub =</span> <span class="dv">3</span>, <span class="dt">font.lab =</span> <span class="dv">3</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-152-1.png" width="672" /></p>
<p>Notice here we do not need to reset par() values as par() was not called directly.</p>
</div>
<div id="annotating-with-title" class="section level5">
<h5><span class="header-section-number">8.3.3.2.2</span> Annotating with “title()”</h5>
<p>Adding titles during call to plot has some restrictions especially where they are placed. For example, by default main title is place 3 lines from plotting region, this is somewhat far from plot especially more spaces is needed as the margins. Adding a line argument to a plotting function is not advisable as it corresponds to multiple other low level functions thereby can be effected by more functions than need be.</p>
<p>For this reason and others it might be good to call “title” function. This function gives more control on presenting and positioning.</p>
<p>Here we demonstrate layout or positioning of labels using function title and line argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Making comparison (paneling)</span>
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)) 

<span class="co"># Default plot</span>
<span class="kw">plot</span>(BOD, <span class="dt">main =</span> <span class="st">&quot;Default placement&quot;</span>, <span class="dt">cex.main =</span> <span class="fl">0.9</span>)

<span class="co"># Plotting with no annotation</span>
<span class="kw">plot</span>(BOD, <span class="dt">ann =</span> <span class="ot">FALSE</span>)

<span class="co"># Moving x label further from x axis</span>
<span class="kw">title</span>(<span class="dt">xlab =</span> <span class="st">&quot;Time (days)&quot;</span>, <span class="dt">line =</span> <span class="dv">4</span>)

<span class="co"># Bring main title and y label closer to frame/axis</span>
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;Displaced annotation&quot;</span>, <span class="dt">line =</span> <span class="dv">1</span>, <span class="dt">cex.main =</span> <span class="fl">0.9</span>)
<span class="kw">title</span>(<span class="dt">ylab =</span> <span class="st">&quot;Demand (mg/l)&quot;</span>, <span class="dt">line =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="figures/annWithTitle-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Resetting original parameters</span>
<span class="kw">par</span>(<span class="dt">mfrow =</span> op)</code></pre></div>
</div>
<div id="axis-and-graphical-parameters" class="section level5">
<h5><span class="header-section-number">8.3.3.2.3</span> Axis and graphical parameters</h5>
<p>Graphical parameters can be used to construct different axis and axis labels. For example drawing an axis with slant labels. This is necessary when axis labels are long.</p>
<p>We will create new axis that handles long labels. To do this, we will first suppress x axis and its label using parameters “xaxt” and “xlab”, then add x axis without labels. Subsequently we will use function “title” to add labels and passing graphical parameters, “srt” (for string rotation), “xpd” (to allow plotting outside the figure region), and “usr” (used to get Cartesian origin of y).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Labels for x axis</span>
days &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;Day&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;One&quot;</span>, <span class="st">&quot;Two&quot;</span>, <span class="st">&quot;Three&quot;</span>, <span class="st">&quot;Four&quot;</span>, <span class="st">&quot;Five&quot;</span>, <span class="st">&quot;Six&quot;</span>, <span class="st">&quot;Seven&quot;</span>))

<span class="co"># Plotting but suppressing x axis and label</span>
<span class="kw">plot</span>(BOD, <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Slant label (x axis)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;y label&quot;</span>)

<span class="co"># Adding x axis without label</span>
<span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">labels =</span> <span class="ot">FALSE</span>)

<span class="co"># Adding labels as text to plot </span>
<span class="kw">text</span>(<span class="dv">1</span>:<span class="kw">length</span>(days), <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">3</span>] -<span class="st"> </span><span class="fl">0.9</span>, <span class="dt">srt =</span> <span class="dv">45</span>, <span class="dt">adj =</span> <span class="dv">1</span>, <span class="dt">labels =</span> days, <span class="dt">xpd =</span> <span class="ot">TRUE</span>)

<span class="co"># Adding a bold x label some lines after axis label</span>
<span class="kw">mtext</span>(<span class="st">&quot;Time&quot;</span>, <span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">line =</span> <span class="dv">4</span>, <span class="dt">font =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-153-1.png" width="672" /></p>
</div>
</div>
</div>
</div>
<div id="plotting-characters-pch" class="section level2">
<h2><span class="header-section-number">8.4</span> Plotting characters (pch)</h2>
<p>Plotting characters are symbols used to display data on a plot. These characters can be circles, squares, triangles, or stars. They can also be crossed, hollow, filled, big, or small. You can also use alphabetical letters, Greek and mathematical symbols.</p>
<p>Here are the first 25 symbols implemented by “S” and “R”.</p>
<pre><code>##        x  y
##  [1,]  5 25
##  [2,] 10 25
##  [3,] 15 25
##  [4,] 20 25
##  [5,] 25 25
##  [6,]  5 20
##  [7,] 10 20
##  [8,] 15 20
##  [9,] 20 20
## [10,] 25 20
## [11,]  5 15
## [12,] 10 15
## [13,] 15 15
## [14,] 20 15
## [15,] 25 15
## [16,]  5 10
## [17,] 10 10
## [18,] 15 10
## [19,] 20 10
## [20,] 25 10
## [21,]  5  5
## [22,] 10  5
## [23,] 15  5
## [24,] 20  5
## [25,] 25  5</code></pre>
<p><img src="figures/sAndRSymbols-1.png" width="672" /></p>
<p>There are many more plotting characters, just have a look at R’s documentation on “points”.</p>
</div>
<div id="plotTypes" class="section level2">
<h2><span class="header-section-number">8.5</span> Plot types</h2>
<p>There are two basic types of plots in base R’s plot(), “points” and “lines”, any other is a variations of these two. Actually, R can produce nine types of plots from lines and point, these are “l” for lines, “p” for points, “b” for both points and lines, “c” for empty points joined by lines, “o” for over plotted points and lines, “s” and “S” for stair steps and “h” for histogram-like vertical lines. There is also type “n” used to suppress plotting.</p>
<p>Let’s generate these plots, but this time being more efficient programmers. Instead of making nine calls to plot we will make two calls using a programming concept called “looping”. Essentially looping means “jump”, as in jump through some objects and perform a task. For example, in our case we have nine plots to generate, hence we want to “loop” over a counter from 1 through 9 and for each count, we want to make a plot, that is “plot 1”, “plot 2”, until “plot 9”. For each of these plots, we want to add an informative title i.e. type of plot.</p>
<p>When writing loops, you need to first determine aspects of the task that vary and those that are constant. In our case, tasks that vary (from one plot to the next) include, data sets as we will use two of them (BOD and tips[,1:2]), plot types and headings which will both have nine different sets. Tasks that will remain constant in all plots are x and y labels which we will suppress (to facilitate multi-plotting) and change y label’s orientation for legibility (par(“las”)). The idea behind looping is that varying tasks will be implemented with a subscript denoting index of task being carried out. Therefore these varying tasks will need to be indexed by creating vectors before calling a looping function.</p>
<p>As we will learn in book two: “R - Beyond Essentials”, R has a number of looping functions each suitable for certain objects and/or tasks, here we will use “sapply”. Sapply takes an object to be looped as it’s first argument, and a function to be performed on each element of first argument as its second argument.</p>
<p>Basically, the first argument would consist of an object with two or more elements, like a list, a vector or a data frame (there other more suitable looping functions for matrices and array). In our case our first argument will be a vector with values 1 through 9 which will our counter (counting plots 1 to plot 9). Our second argument will be an anonymous function with one argument which an iterator. An iterator here is an index of plots to be generated and will be used to subset the varying arguments. Output of sapply is either a simplified vector or a list, in our case it produces an empty lists along side the plots, to generate plots without empty lists, we will suppress the list with function “invisible”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Querying, saving and changing original parameters</span>
op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;mfrow&quot;</span>, <span class="st">&quot;mar&quot;</span>)
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="fl">0.5</span>))

<span class="co"># Extracting need vector from tips data</span>
tips &lt;-<span class="st"> </span>tips[, <span class="dv">1</span>:<span class="dv">2</span>]

<span class="co"># Creating vectors of varing variables (elements to be subset) </span>
dat &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;BOD&quot;</span>, <span class="dv">7</span>), <span class="kw">rep</span>(<span class="st">&quot;tips&quot;</span>, <span class="dv">2</span>))
type &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;p&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;s&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;n&quot;</span>, <span class="st">&quot;o&quot;</span>, <span class="st">&quot;h&quot;</span>)
main &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;Type:&quot;</span>, type)

<span class="co"># Looping through a plot counter to construct nine different plots while suppressing returned empty list</span>
<span class="kw">invisible</span>(<span class="kw">sapply</span>(<span class="kw">seq_along</span>(type), function(x) <span class="kw">plot</span>(<span class="kw">get</span>(dat[x]), <span class="dt">type =</span> type[x], <span class="dt">main =</span> main[x], <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">las =</span> <span class="dv">1</span>)))</code></pre></div>
<p><img src="figures/unnamed-chunk-154-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Resetting original parameters</span>
<span class="kw">par</span>(<span class="dt">mfrow =</span> op$mfrow, <span class="dt">mar =</span> op$mar)</code></pre></div>
<p><img src="figures/unnamed-chunk-154-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Try and produce these plots one at a time and see number of repetitive code used.</span></code></pre></div>
<p>Looping is an interesting topic for which we get to learn from it’s foundation in our second book: “R - Beyond Essentials”.</p>
<div id="annotating-plots-with-lines" class="section level3">
<h3><span class="header-section-number">8.5.1</span> Annotating plots with lines</h3>
<p>Lines can be added to an existing plot either for statistical value or just plotting aesthetics.</p>
<p>For example, lets annotate three different plots of the same data. For the first plot we will add a spline (interpolated line), for the second we will add grid lines and for the last plot we will show average with vertical and horizontal lines.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;mfrow&quot;</span>, <span class="st">&quot;mar&quot;</span>)
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="kw">rep.int</span>(<span class="dv">3</span>, <span class="dv">3</span>), <span class="fl">0.5</span>))

<span class="co"># Add a spline (Interpolated line) </span>
<span class="kw">plot</span>(BOD, <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">20</span>), <span class="dt">las =</span> <span class="dv">1</span>)
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;Fitting a spline&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Demand&quot;</span>, <span class="dt">line =</span> <span class="fl">1.9</span>)
<span class="kw">lines</span>(<span class="kw">spline</span>(BOD), <span class="dt">col =</span> <span class="dv">4</span>)

<span class="co"># Add grid lines (Aesthetics)</span>
<span class="kw">plot</span>(BOD, <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">las =</span> <span class="dv">1</span>)
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;Adding grid lines&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Demand&quot;</span>, <span class="dt">line =</span> <span class="fl">1.9</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(<span class="dv">8</span>, <span class="dv">20</span>, <span class="dt">by =</span> <span class="dv">2</span>), <span class="dt">v =</span> <span class="dv">1</span>:<span class="dv">7</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)

<span class="co"># Show average</span>
<span class="kw">plot</span>(tips[,<span class="dv">1</span>:<span class="dv">2</span>], <span class="dt">las =</span> <span class="dv">1</span>)
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;Showing average&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Total bill&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Tips&quot;</span>, <span class="dt">line =</span> <span class="fl">1.9</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">mean</span>(tips$tip), <span class="dt">v =</span> <span class="kw">mean</span>(tips$total_bill), <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="dv">8</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)

<span class="kw">par</span>(<span class="dt">mfrow =</span> op$mfrow, <span class="dt">mar =</span> op$mar)</code></pre></div>
<p><img src="figures/unnamed-chunk-155-1.png" width="672" /></p>
</div>
</div>
<div id="generating-and-annotating-mathematical-plots" class="section level2">
<h2><span class="header-section-number">8.6</span> Generating and Annotating Mathematical Plots</h2>
<p>Mathematical (and indeed other scientific) plots can be generated in R annotated with models and/or functions used to generate them. These functions or models are added to plots as “expressions” using a text annotating function.</p>
<p>Expressions are syntactically correct but unevaluated functions or commands. Syntactically correct means code is in R language and capable of being evaluated if run. Expressions are used to prevent evaluation like in this case we will use them to annotate plots but also they are not evaluated.</p>
<p>In R, expressions are created with “expression” function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># General code to be evaluated</span>
<span class="dv">1</span> +<span class="st"> </span><span class="dv">1</span>
## [1] 2
<span class="kw">class</span>(<span class="dv">1</span> +<span class="st"> </span><span class="dv">1</span>)
## [1] &quot;numeric&quot;

<span class="co"># Passing code to &quot;expression()&quot; stops evaluation</span>
<span class="kw">expression</span>(<span class="dv">1</span> +<span class="st"> </span><span class="dv">1</span>)
## expression(1 + 1)
<span class="kw">class</span>(<span class="kw">expression</span>(<span class="dv">1</span> +<span class="st"> </span><span class="dv">1</span>))
## [1] &quot;expression&quot;

<span class="co"># Evaluating an expression</span>
<span class="kw">eval</span>(<span class="kw">expression</span>(<span class="dv">1</span> +<span class="st"> </span><span class="dv">1</span>))
## [1] 2</code></pre></div>
<p>Now let’s look at some examples of how expressions can be used to explain a plot.</p>
<p>For our first example we will construct a plot with a regression model <code>Cx = 156 + 19.7x</code> modeling relationship between costs and sales of cameras; our a domain will be <code>1 &lt;= x &lt;= 15</code>.</p>
<p>But before plotting, one key consideration we need to make are coordinates of the texts/expression. Specifically alignment (par(“adj”)), orientation (par(“srt”)), and position (par(“pos”)).</p>
<p>To add the model as expressions with characters, we will need to decompose it to three components; “Cx”, “=” and “156 + 19.7x” with the expectation that they will be plotted above the regression line. We shall then plot the domain at the bottom right of the plot.</p>
<p>In order to estimate x and y coordinates, we will call “strWidth” function to compute distances between each component.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Constructing a plot</span>
<span class="co">#---------------------</span>
<span class="co"># Data for plotting</span>
x1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">12</span>)
Cx1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">175</span>, <span class="dv">260</span>, <span class="dv">305</span>, <span class="dv">395</span>)

<span class="co"># A simple scatter plot (points added after grids)</span>
<span class="kw">plot</span>(x1, Cx1, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Costs of Manufacturing and Selling Cameras&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Cameras Sold (millions)&quot;</span>, <span class="dt">ylab =</span> <span class="kw">c</span>(<span class="st">&quot;Cost (millions)&quot;</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">15</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">175</span>, <span class="dv">452</span>), <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>)
<span class="kw">title</span>(<span class="dt">sub =</span> <span class="st">&quot;From Applied Calculus (2000) pg 16 by Barnett, R.A. et.al&quot;</span>, <span class="dt">cex.sub =</span> <span class="fl">0.7</span>, <span class="dt">col.sub =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">font.sub =</span> <span class="dv">3</span>)

<span class="co"># Adding some aesthetics (background color for plot region)</span>
<span class="kw">rect</span>(<span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">1</span>], <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">3</span>], <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">2</span>], <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">4</span>], <span class="dt">col =</span> <span class="kw">grey.colors</span>(<span class="dv">1</span>, <span class="dt">start =</span> <span class="fl">0.85</span>))

<span class="co"># Adding a regression line (pre-analysed function)</span>
x2 &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">15</span>
Cx2 &lt;-<span class="st"> </span><span class="dv">156</span> +<span class="st"> </span><span class="fl">19.7</span> *<span class="st"> </span>x2
<span class="kw">lines</span>(x2, Cx2, <span class="dt">col =</span> <span class="dv">4</span>)

<span class="co"># More aesthetics (grid lines)</span>
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">axTicks</span>(<span class="dv">2</span>), <span class="dt">v =</span> <span class="dv">1</span>:<span class="dv">15</span>, <span class="dt">col =</span> <span class="st">&quot;white&quot;</span>)

<span class="co"># Adding points last to avoid being plotted over by grid lines</span>
<span class="kw">points</span>(x1, Cx1, <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">col =</span> <span class="dv">2</span>)

<span class="co"># Annotating with expressions</span>
<span class="co">#-----------------------------</span>
<span class="co"># Components of regression model</span>
expr &lt;-<span class="st"> </span><span class="kw">expression</span>(C[x])
str  &lt;-<span class="st"> &quot;=&quot;</span>
expr1  &lt;-<span class="st"> </span><span class="kw">expression</span>(<span class="dv">156</span> +<span class="st"> </span><span class="fl">19.7</span>*x)


<span class="co"># Computing coordinates for each component of the expression</span>
<span class="co"># Width of spaces in between text </span>
empStr &lt;-<span class="st"> </span><span class="kw">strwidth</span>(<span class="st">&quot; &quot;</span>)
<span class="co"># First component (Cx) will be centered around x = 10 (half of the text will be before and the other after 10)</span>
width1 &lt;-<span class="st"> </span><span class="dv">10</span> 
<span class="co"># Second component (&quot;=&quot;) will start about 0.9 after end of first component</span>
width2 &lt;-<span class="st"> </span>width1 +<span class="st"> </span><span class="kw">strwidth</span>(<span class="st">&quot;Cx&quot;</span>)/<span class="dv">2</span> +<span class="st"> </span><span class="kw">strwidth</span>(<span class="st">&quot;=&quot;</span>)/<span class="dv">2</span>
<span class="co"># Third component (156 + 19.7x) will be about 1 (cex) from end of the second component</span>
width3 &lt;-<span class="st"> </span>width2 +<span class="st"> </span><span class="kw">strwidth</span>(<span class="st">&quot;=&quot;</span>)/<span class="dv">2</span> +<span class="st"> </span><span class="kw">strwidth</span>(expr1)/<span class="dv">2</span>
<span class="co"># Vector with combined widths</span>
widths &lt;-<span class="st"> </span><span class="kw">c</span>(width1, width2, width3)

<span class="co"># Adding model as a text/expression</span>
slope &lt;-<span class="st"> </span><span class="fl">19.7</span> +<span class="st"> </span><span class="fl">10.3</span>
<span class="kw">text</span>(<span class="dt">x =</span> widths, <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">156</span> +<span class="st"> </span><span class="fl">19.7</span> *<span class="st"> </span>widths), <span class="dt">labels =</span> <span class="kw">c</span>(expr, str, expr1), <span class="dt">pos =</span> <span class="dv">3</span>, <span class="dt">srt =</span> slope)

<span class="co"># Computing coordinates for domain </span>
str1  &lt;-<span class="st"> &quot;Domain:&quot;</span>
expr2 &lt;-<span class="st"> </span><span class="kw">expression</span>(<span class="dv">1</span> &lt;=<span class="st"> </span>x)
expr3 &lt;-<span class="st"> </span><span class="kw">expression</span>(x &lt;=<span class="st"> </span><span class="dv">15</span>)
domain &lt;-<span class="st"> </span><span class="kw">c</span>(str1, expr2, expr3)
width1 &lt;-<span class="st"> </span><span class="fl">12.5</span>
width2 &lt;-<span class="st"> </span>width1 +<span class="st"> </span><span class="kw">strwidth</span>(str1)/<span class="dv">2</span> +<span class="st"> </span><span class="kw">strwidth</span>(expr2)/<span class="dv">2</span>
width3 &lt;-<span class="st"> </span>width2 +<span class="st"> </span><span class="kw">strwidth</span>(expr2)/<span class="dv">2</span> +<span class="st"> </span><span class="kw">strwidth</span>(expr3)/<span class="dv">2</span> -<span class="st"> </span><span class="kw">strwidth</span>(<span class="st">&quot;x&quot;</span>)
<span class="co"># Annotating with domain</span>
<span class="kw">text</span>(<span class="dt">x =</span> <span class="kw">c</span>(width1, width2, width3), <span class="dt">y =</span> <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">3</span>], <span class="dt">labels =</span> domain, <span class="dt">pos =</span> <span class="dv">3</span>)</code></pre></div>
<p><img src="figures/mathPlot1-1.png" width="672" /></p>
<p>In our second example we look at how to add nonlinear functions to plots and annotate with formulas.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Data </span>
x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">12</span>, <span class="dv">15</span>)
expr &lt;-<span class="st"> </span><span class="kw">expression</span>(<span class="dt">Px =</span> x *<span class="st"> </span>(<span class="fl">94.8</span> -<span class="st"> </span><span class="dv">5</span> *<span class="st"> </span>x) -<span class="st"> </span>(<span class="dv">156</span> +<span class="st"> </span><span class="fl">19.7</span> *<span class="st"> </span>x))
Px &lt;-<span class="st"> </span><span class="kw">eval</span>(expr)
<span class="kw">cbind</span>(x, <span class="kw">round</span>(Px))
##       x     
## [1,]  1  -86
## [2,]  3   24
## [3,]  6  115
## [4,]  9  115
## [5,] 12   25
## [6,] 15 -155


<span class="co"># Plot suppressing points so they are not covered with grid lines, x label so that it is later position at line 1, and x axis which will be plotted at origin (x = 0, y = 0)</span>
<span class="kw">plot</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> Px, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Profits from Sale of Cameras&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Million dollars&quot;</span>, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>, <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>)

<span class="co"># Annotating with subtitle and  x label</span>
<span class="kw">title</span>(<span class="dt">xlab =</span> <span class="st">&quot;Million cameras&quot;</span>, <span class="dt">line =</span> <span class="dv">1</span>)
<span class="kw">title</span>(<span class="dt">sub =</span> <span class="st">&quot;From Applied Calculus pg.17 by Barnett, R.A. et.al (2000)&quot;</span>, <span class="dt">cex.sub =</span> <span class="fl">0.8</span>, <span class="dt">font.sub =</span> <span class="dv">3</span>, <span class="dt">col.sub =</span> <span class="st">&quot;grey&quot;</span>,  <span class="dt">line =</span> <span class="fl">2.5</span>)

<span class="co"># Adding background color</span>
<span class="kw">rect</span>(<span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">1</span>], <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">3</span>], <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">2</span>], <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">4</span>], <span class="dt">col =</span> <span class="kw">grey.colors</span>(<span class="dv">1</span>, <span class="dt">start =</span> <span class="fl">0.85</span>), <span class="dt">border =</span> <span class="st">&quot;grey&quot;</span>)

<span class="co"># Adding grid lines (for that mathematical graphing effect)</span>
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">axTicks</span>(<span class="dv">2</span>), <span class="dt">v =</span> <span class="dv">1</span>:<span class="dv">16</span>, <span class="dt">col =</span> <span class="st">&quot;white&quot;</span>)

<span class="co"># Drawing axis lines </span>
<span class="kw">segments</span>(<span class="dt">x0 =</span> <span class="dv">0</span>, <span class="dt">y0 =</span> <span class="dv">0</span>, <span class="dt">x1 =</span> <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">2</span>])
<span class="kw">segments</span>(<span class="dt">x0 =</span> <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">1</span>], <span class="dt">y0 =</span> <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">3</span>], <span class="dt">y1 =</span> <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">4</span>], <span class="dt">lwd =</span> <span class="dv">2</span>)

<span class="co"># Drawing Tick marks</span>
<span class="kw">invisible</span>(<span class="kw">sapply</span>(<span class="dv">1</span>:<span class="dv">15</span>, function(x) <span class="kw">segments</span>(<span class="dt">x0 =</span> x, <span class="dt">y0 =</span> <span class="dv">0</span>, <span class="dt">y1 =</span> -<span class="dv">10</span>)))

<span class="co"># Adding axis labels</span>
<span class="kw">invisible</span>(<span class="kw">sapply</span>(<span class="kw">seq</span>(<span class="dv">5</span>, <span class="dv">15</span>, <span class="dt">by =</span> <span class="dv">5</span>), function(i) <span class="kw">text</span>(<span class="dt">x =</span> i, <span class="dt">y =</span> -<span class="dv">20</span>, <span class="dt">labels =</span> i, <span class="dt">cex =</span> <span class="fl">0.8</span>)))

<span class="co"># Fitting a curved (nonlinear) line with &quot;spline&quot;; interpolation line</span>
<span class="kw">lines</span>(<span class="kw">spline</span>(x, Px), <span class="dt">col =</span> <span class="dv">4</span>)

<span class="co"># Adding points last so that they are not masked by lines (grid and regression)</span>
<span class="kw">points</span>(x, Px, <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">col =</span> <span class="dv">2</span>)

<span class="co"># Annotating curve with formula used to produce it. </span>
slope &lt;-<span class="st"> </span>(Px[<span class="dv">6</span>] -<span class="st"> </span>Px[<span class="dv">5</span>])/<span class="st"> </span>(x[<span class="dv">6</span>] -<span class="st"> </span>x[<span class="dv">5</span>])
<span class="kw">text</span>(<span class="dt">x =</span> <span class="dv">14</span>, <span class="dt">y =</span> -<span class="dv">85</span>, <span class="dt">labels =</span> expr, <span class="dt">pos =</span> <span class="dv">3</span>, <span class="dt">srt =</span> slope, <span class="dt">cex =</span> <span class="fl">0.8</span>)</code></pre></div>
<p><img src="figures/mathPlot2-1.png" width="672" /></p>
<p>Finally, lets see how to construct a four quadrant Cartesian coordinate system.</p>
<p>In this example we will plot an exponential (y = 2^x) and a logarithmic (x = 2^y) function as well as a reflection line (y = x). Key consideration here are limits of both x and y axis given two data sets (exponential and logarithmic). Our interest is that both axis stretch as far as the maximum value of each data set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Exponent data </span>
eX &lt;-<span class="st"> </span><span class="kw">c</span>(-<span class="dv">3</span>, -<span class="dv">2</span>, -<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)
y_2x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>/<span class="dv">8</span>, <span class="dv">1</span>/<span class="dv">4</span>, <span class="dv">1</span>/<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>)
<span class="co"># Logarithmic data</span>
logX &lt;-<span class="st"> </span>y_2x
y &lt;-<span class="st"> </span>eX
<span class="kw">cbind</span>(eX, y_2x, logX, y)
##      eX  y_2x  logX  y
## [1,] -3 0.125 0.125 -3
## [2,] -2 0.250 0.250 -2
## [3,] -1 0.500 0.500 -1
## [4,]  0 1.000 1.000  0
## [5,]  1 2.000 2.000  1
## [6,]  2 4.000 4.000  2
## [7,]  3 8.000 8.000  3

<span class="co"># Determining limits of each data set</span>
xlim1 &lt;-<span class="st"> </span><span class="kw">range</span>(eX)
ylim1 &lt;-<span class="st"> </span><span class="kw">range</span>(y_2x)
xlim2 &lt;-<span class="st"> </span><span class="kw">range</span>(logX)
ylim2 &lt;-<span class="st"> </span><span class="kw">range</span>(y)
xlim1; xlim2
## [1] -3  3
## [1] 0.125 8.000
ylim1; ylim2
## [1] 0.125 8.000
## [1] -3  3

<span class="co"># Constructing x and y limits based of maximum values of each data set</span>
xlimts &lt;-<span class="st"> </span><span class="kw">c</span>(xlim1[<span class="dv">1</span>], xlim2[<span class="dv">2</span>])
ylimts &lt;-<span class="st"> </span><span class="kw">c</span>(ylim2[<span class="dv">1</span>], ylim1[<span class="dv">2</span>])
xlimts
## [1] -3  8
ylimts
## [1] -3  8

<span class="co"># Plotting</span>
<span class="co">#----------</span>

<span class="co"># Increase margins for plotting region</span>
op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;mar&quot;</span>)
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>))

<span class="co"># Start a plot without points, annotation and axis</span>
<span class="kw">plot</span>(<span class="dt">x =</span> xlimts, <span class="dt">y =</span> ylimts, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">ann =</span> <span class="ot">FALSE</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>)
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;Exponential and Logarithmic Functions&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>, <span class="dt">line =</span> <span class="dv">1</span>)
<span class="kw">title</span>(<span class="dt">sub =</span> <span class="st">&quot;From Applied Calculus by Barnett, R.A. et.al (2000) pg 109&quot;</span>, <span class="dt">cex.sub =</span> <span class="fl">0.8</span>, <span class="dt">font.sub =</span> <span class="dv">3</span>, <span class="dt">col.sub =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">line =</span> <span class="fl">0.5</span>)

<span class="co"># Add background color</span>
<span class="kw">rect</span>(<span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">1</span>], <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">3</span>], <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">2</span>], <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">4</span>], <span class="dt">col =</span> <span class="kw">grey.colors</span>(<span class="dv">1</span>, <span class="dt">start =</span> <span class="fl">0.85</span>), <span class="dt">border =</span> <span class="st">&quot;transparent&quot;</span>)

<span class="co"># Add grid lines and lines for x and y axis </span>
<span class="kw">abline</span>(<span class="dt">h =</span> -<span class="dv">3</span>:<span class="dv">8</span>, <span class="dt">v =</span> -<span class="dv">3</span>:<span class="dv">8</span>, <span class="dt">col =</span> <span class="st">&quot;white&quot;</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">v =</span> <span class="dv">0</span>)

<span class="co"># Adding reflection line</span>
<span class="kw">lines</span>(<span class="dt">x =</span> <span class="kw">c</span>(-<span class="dv">3</span>, <span class="dv">8</span>), <span class="dt">y =</span> <span class="kw">c</span>(-<span class="dv">3</span>, <span class="dv">8</span>), <span class="dt">lty =</span> <span class="dv">2</span>)

<span class="co"># Fit exponential and logarithmic functions </span>
<span class="co">#-------------------------------------------</span>
<span class="kw">lines</span>(<span class="kw">spline</span>(eX, y_2x), <span class="dt">col =</span> <span class="dv">4</span>)
<span class="kw">lines</span>(<span class="kw">spline</span>(logX, y), <span class="dt">col =</span> <span class="dv">4</span>)

<span class="co"># Add points</span>
<span class="kw">points</span>(eX, y_2x, <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">col =</span> <span class="dv">2</span>, <span class="dt">cex =</span> <span class="fl">0.9</span>)
<span class="kw">points</span>(logX, y, <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">col =</span> <span class="dv">2</span>, <span class="dt">cex =</span> <span class="fl">0.9</span>)

<span class="co"># Draw tick marks</span>
<span class="kw">invisible</span>(<span class="kw">sapply</span>(-<span class="dv">3</span>:<span class="dv">8</span>, function(x) <span class="kw">segments</span>(<span class="dt">x0 =</span> x, <span class="dt">y0 =</span> <span class="dv">0</span>, <span class="dt">y1 =</span> -<span class="fl">0.3</span>)))
<span class="kw">invisible</span>(<span class="kw">sapply</span>(-<span class="dv">3</span>:<span class="dv">8</span>, function(x) <span class="kw">segments</span>(<span class="dt">x0 =</span> <span class="dv">0</span>, <span class="dt">y0 =</span> x, <span class="dt">x1 =</span> -<span class="fl">0.1</span>)))

<span class="co"># Axis labels</span>
<span class="kw">invisible</span>(<span class="kw">sapply</span>(<span class="kw">seq</span>(-<span class="dv">2</span>, <span class="dv">8</span>, <span class="dt">by =</span> <span class="dv">2</span>)[-<span class="dv">2</span>], function(x) <span class="kw">text</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> -<span class="fl">0.2</span>, <span class="dt">labels =</span> x, <span class="dt">pos =</span> <span class="dv">1</span>, <span class="dt">cex =</span> <span class="fl">0.8</span>)))
<span class="kw">invisible</span>(<span class="kw">sapply</span>(<span class="kw">seq</span>(-<span class="dv">2</span>, <span class="dv">8</span>, <span class="dt">by =</span> <span class="dv">2</span>)[-<span class="dv">2</span>], function(x) <span class="kw">text</span>(<span class="dt">x =</span> -<span class="fl">0.2</span>, <span class="dt">y =</span> x, <span class="dt">labels =</span> x, <span class="dt">pos =</span> <span class="dv">2</span>, <span class="dt">cex =</span> <span class="fl">0.8</span>)))

<span class="co"># Annotating with mathematical functions</span>
<span class="co">#----------------------------------------</span>
radian &lt;-<span class="st"> </span><span class="dv">180</span>/pi

slope &lt;-<span class="st"> </span>(y_2x[<span class="dv">7</span>] -<span class="st"> </span>y_2x[<span class="dv">6</span>])/(eX[<span class="dv">7</span>] -<span class="st"> </span>eX[<span class="dv">6</span>])
angle &lt;-<span class="st"> </span><span class="kw">atan</span>(slope) *<span class="st"> </span>radian
<span class="kw">text</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="fl">2.4</span>, <span class="fl">2.4</span> +<span class="st"> </span><span class="kw">strwidth</span>(<span class="fl">2.4</span>)/<span class="dv">2</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">6</span>, ((<span class="fl">2.4</span> +<span class="st"> </span><span class="kw">strwidth</span>(<span class="fl">2.4</span>)/<span class="dv">2</span> +<span class="st"> </span>empStr) -<span class="st"> </span><span class="fl">2.4</span>) +<span class="st"> </span><span class="dv">6</span> +<span class="st"> </span>empStr), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;y =&quot;</span>, <span class="kw">expression</span>(<span class="dt">y =</span> <span class="dv">2</span> ^<span class="st"> </span>x)), <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">cex =</span> <span class="fl">0.9</span>, <span class="dt">srt =</span> <span class="dv">50</span>)

slope &lt;-<span class="st"> </span>(<span class="dv">7</span> -<span class="st"> </span><span class="dv">6</span>)/(<span class="dv">7</span> -<span class="st"> </span><span class="dv">6</span>)
angle &lt;-<span class="st"> </span><span class="kw">atan</span>(slope) *<span class="st"> </span>radian
<span class="kw">text</span>(<span class="dt">x =</span> <span class="dv">6</span>, <span class="dt">y =</span> <span class="dv">6</span>, <span class="dt">labels =</span> <span class="st">&quot;y = x&quot;</span>, <span class="dt">pos =</span> <span class="dv">3</span>, <span class="dt">cex =</span> <span class="fl">0.9</span>, <span class="dt">srt =</span> angle)

slope &lt;-<span class="st"> </span>(y[<span class="dv">7</span>] -<span class="st"> </span>y[<span class="dv">6</span>])/(logX[<span class="dv">7</span>] -<span class="st"> </span>logX[<span class="dv">6</span>])
angle &lt;-<span class="st"> </span><span class="kw">atan</span>(slope) *<span class="st"> </span>radian
x1 &lt;-<span class="st"> </span><span class="fl">6.5</span>
x2 &lt;-<span class="st"> </span>x1 +<span class="st"> </span><span class="kw">strwidth</span>(<span class="st">&quot;x =&quot;</span>)/<span class="dv">2</span>
<span class="kw">text</span>(<span class="dt">x =</span> <span class="kw">c</span>(x1, x2), <span class="dt">y =</span> <span class="kw">c</span>((x1 *<span class="st"> </span><span class="fl">2.5</span>)/<span class="dv">6</span>, <span class="kw">tan</span>(angle)*(x2 -<span class="st"> </span>x1)), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;x =&quot;</span>, <span class="kw">expression</span>(<span class="dv">2</span> ^<span class="st"> </span>y)), <span class="dt">pos =</span> <span class="dv">3</span>, <span class="dt">cex =</span> <span class="fl">0.9</span>, <span class="dt">srt =</span> angle) </code></pre></div>
<p><img src="figures/mathPlot3-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Return original parameter</span>
<span class="kw">par</span>(<span class="dt">mar =</span> op)</code></pre></div>
</div>
<div id="other-base-r-plots" class="section level2">
<h2><span class="header-section-number">8.7</span> Other Base R Plots</h2>
<div id="histDensityPlots" class="section level3">
<h3><span class="header-section-number">8.7.1</span> Histogram and Density plots</h3>
<p>Histograms and density plots are excellent graphs for showing univariate quantitative data distribution. Univariate means one variable and quantitative are numerical values, both discrete (integers) and continuous (double).</p>
<p>For integer vectors (whole numbers), histogram is appropriate; for type double or continuous, density plots are more appropriate. The underlying reason for using density plots for continuous data is because it is generally difficult to get interval limits used in constructing histogram bins.</p>
<div id="histograms" class="section level4">
<h4><span class="header-section-number">8.7.1.1</span> Histograms</h4>
<p>Histogram are similar to bar graphs in terms of appearance but they differ substantially as bar graphs use categorical or count data while histograms use numerical data.</p>
<p>For example generating a histogram of some sample.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Default histogram</span>
<span class="kw">hist</span>(tips$tip, <span class="dt">col =</span> blues9[<span class="dv">4</span>], <span class="dt">border =</span> blues9[<span class="dv">6</span>], <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">ylab =</span> <span class="st">&quot;Tips&quot;</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-156-1.png" width="672" /></p>
<p>To understand how histograms are generated, you need to understand argument “breaks”.</p>
<div id="breaks-argument" class="section level5">
<h5><span class="header-section-number">8.7.1.1.1</span> Breaks argument</h5>
<p>Breaks argument gives the number of expected bins (binning). Binning means grouping data into some given category/group with aim of showing different feature of a data set. It is therefore quite informative to try different bin sizes (breaks) to see other aspects of the distribution.</p>
<p>The basic idea of binning or grouping data is done by dividing it into the number of breaks given (with some addition to ensure extreme values are included). Division is first done by getting bin limits from a vector with a sequence of values from minimum to maximum.</p>
<p>Let’s take data set “Precip” that comes with R to understand how binning is done.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Set expected number of breaks</span>
breaks &lt;-<span class="st"> </span><span class="dv">20</span>

<span class="co"># Get range (minimum and maximum values)</span>
precipRange &lt;-<span class="st"> </span><span class="kw">range</span>(precip)

<span class="co"># Computing Bin limits (1 is added to breaks to enable grouping)</span>
precipSeq &lt;-<span class="st"> </span><span class="kw">seq</span>(precipRange[<span class="dv">1</span>], precipRange[<span class="dv">2</span>], <span class="dt">length.out =</span> breaks +<span class="st"> </span><span class="dv">1</span>)
precipSeq
##  [1]  7 10 13 16 19 22 25 28 31 34 37 40 43 46 49 52 55 58 61 64 67</code></pre></div>
<p>Vector “precipSeq” has 21 values (1 more than breaks given) which will form the bin limits. First bin will be from 7 (or minimum value) to 9, second will be from 10 to 13, and last bin will be from 65 to maximum value. Given these bins, values will be allocated to bins they fall into, for example a value 17 would fall in bin 16 to 19.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Distribution of values given ten breaks</span>
precipBin1 &lt;-<span class="st"> </span><span class="kw">table</span>(<span class="kw">cut</span>(precip, <span class="dt">breaks =</span> <span class="dv">10</span>))
precipBin1
## 
## (6.94,13]   (13,19]   (19,25]   (25,31]   (31,37]   (37,43]   (43,49] 
##         6         7         3         7        14        16         9 
##   (49,55]   (55,61] (61,67.1] 
##         4         3         1

<span class="co"># Distribution of values based on summary statistics</span>
precipSumStats &lt;-<span class="st"> </span><span class="kw">summary</span>(precip)
precipBin2 &lt;-<span class="st"> </span><span class="kw">table</span>(<span class="kw">cut</span>(precip, <span class="kw">unname</span>(precipSumStats)))
precipBin2
## 
##    (7,29.4] (29.4,34.9] (34.9,36.6] (36.6,42.8]   (42.8,67] 
##          17          10           7          17          18

<span class="co"># Distribution of values given twenty five breaks</span>
precipBin3 &lt;-<span class="st"> </span><span class="kw">table</span>(<span class="kw">cut</span>(precip, <span class="dt">breaks =</span> <span class="dv">25</span>))
precipBin3
## 
##  (6.94,9.4]  (9.4,11.8] (11.8,14.2] (14.2,16.6]   (16.6,19]   (19,21.4] 
##           4           1           2           4           2           1 
## (21.4,23.8] (23.8,26.2] (26.2,28.6]   (28.6,31]   (31,33.4] (33.4,35.8] 
##           1           2           0           6           4           3 
## (35.8,38.2] (38.2,40.6]   (40.6,43]   (43,45.4] (45.4,47.8] (47.8,50.2] 
##           8           7           8           3           3           5 
## (50.2,52.6]   (52.6,55]   (55,57.4] (57.4,59.8] (59.8,62.2] (62.2,64.6] 
##           0           2           1           2           0           0 
## (64.6,67.1] 
##           1

<span class="co"># Note: barplots of these vectors will be similar to histograms with same breaks</span></code></pre></div>
<p>There is no one recommended number of bin size as it depends on data distribution and analysis goal, however, there have been a number of guidelines including “Sturges” which is R’s default binning system.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;mfrow&quot;</span>)
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))
<span class="kw">hist</span>(precip, <span class="dt">main =</span> <span class="st">&quot;Breaks set to default &#39;Sturges&#39;&quot;</span>)
<span class="kw">hist</span>(precip, <span class="dt">breaks =</span> <span class="dv">25</span>, <span class="dt">main =</span> <span class="st">&quot;Breaks set to 25&quot;</span>)
<span class="kw">hist</span>(precip, <span class="dt">breaks =</span> <span class="kw">nclass.scott</span>(precip), <span class="dt">main =</span> <span class="st">&quot;Breaks set to &#39;Scott&#39;&quot;</span>)
<span class="kw">hist</span>(precip, <span class="dt">breaks =</span> <span class="kw">nclass.FD</span>(precip), <span class="dt">main =</span> <span class="st">&quot;Breaks set to &#39;Freedman-Diaconis&#39;&quot;</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-158-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> op)</code></pre></div>
</div>
<div id="rugs" class="section level5">
<h5><span class="header-section-number">8.7.1.1.2</span> Rugs</h5>
<p>Sometimes it is necessary to show data concentration (density) areas, this can be shown with a “rug”. A rug is a one dimensional density plot added to axes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;mfrow&quot;</span>)
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))
<span class="kw">hist</span>(precip, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)
<span class="kw">rug</span>(precip, <span class="dt">col =</span> <span class="dv">4</span>)
<span class="kw">hist</span>(precip, <span class="dt">breaks =</span> <span class="dv">25</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)
<span class="kw">rug</span>(precip, <span class="dt">col =</span> <span class="dv">4</span>)
<span class="kw">mtext</span>(<span class="st">&quot;Histograms with rugs showing marginal distribution&quot;</span>, <span class="dt">line =</span> <span class="dv">2</span>, <span class="dt">at =</span> -<span class="dv">15</span>, <span class="dt">font =</span> <span class="dv">7</span>, <span class="dt">cex =</span> <span class="fl">1.2</span>, <span class="dt">xpd =</span> <span class="ot">NA</span>)
<span class="kw">hist</span>(precip, <span class="dt">breaks =</span> <span class="kw">nclass.scott</span>(precip), <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)
<span class="kw">rug</span>(precip, <span class="dt">col =</span> <span class="dv">4</span>)
<span class="kw">hist</span>(precip, <span class="dt">breaks =</span> <span class="kw">nclass.FD</span>(precip), <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)
<span class="kw">rug</span>(precip, <span class="dt">col =</span> <span class="dv">4</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-159-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> op)</code></pre></div>
<p>Just like plot(), we can add some aesthetics to histograms.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">color &lt;-<span class="st"> &quot;#F6CBB7&quot;</span>
<span class="kw">hist</span>(precip, <span class="dt">breaks =</span> <span class="dv">25</span>, <span class="dt">freq =</span> <span class="ot">FALSE</span>, <span class="dt">col =</span> color, <span class="dt">main =</span> <span class="st">&quot;Annual Precipitation in US Cities&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Average amount of precipitation (rainfall) in inches&quot;</span>, <span class="dt">las =</span> <span class="dv">1</span>)
<span class="kw">rug</span>(precip, <span class="dt">col =</span> <span class="dv">4</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-160-1.png" width="672" /></p>
</div>
<div id="histogram-as-an-object" class="section level5">
<h5><span class="header-section-number">8.7.1.1.3</span> Histogram as an object</h5>
<p>Histograms can be save as an objects of class “histogram”. These objects can be used to call plot() which will dispatch “plot.hist” method.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create an object with class &quot;histogram&quot;</span>
precipHist &lt;-<span class="st"> </span><span class="kw">hist</span>(precip, <span class="dt">breaks =</span> <span class="dv">25</span>, <span class="dt">freq =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="figures/histObj-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(precipHist)
## [1] &quot;histogram&quot;

<span class="co"># Call plot() but suppressing y axis and add a rug</span>
<span class="kw">plot</span>(precipHist, <span class="dt">ann =</span> <span class="ot">FALSE</span>, <span class="dt">yaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">col =</span> color)
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;Annual Precipitation in US Cities&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Average precipitation (rainfall) in inches&quot;</span>)
<span class="kw">rug</span>(precip, <span class="dt">col =</span> <span class="dv">4</span>)</code></pre></div>
<p><img src="figures/histObj-2.png" width="672" /></p>
<p>Histograms (like pie and bar graphs) are not ideal for publication due to <a href="http://www.infovis-wiki.net/index.php/Data-Ink_Ratio">data-ink ratio</a> but are excellent for presentations and Exploratory Data Analysis (EDA) <a href="#fn7" class="footnoteRef" id="fnref7"><sup>7</sup></a> or quality check.</p>
</div>
</div>
<div id="density-plots" class="section level4">
<h4><span class="header-section-number">8.7.1.2</span> Density plots</h4>
<p>As noted earlier, these plots are ideal for continuous data (typeof = “double”) as they draw continuous line.</p>
<p>As an example, we will use a well known data set called “iris” or the Edgar Anderson’s Iris Data (?iris). Our interest is to produce density plots of the four numerical vectors (Sepal.Length, Sepal.Width, Petal.Length, Petal.Width). We will do this in a multi-plot layout (2 row and 2 columns) and as shown before, instead of making four calls to plot, we will use “sapply” to loop through a counter (1:4).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Looping through first four columns of iris to confirm their data type</span>
<span class="kw">sapply</span>(iris[, <span class="dv">1</span>:<span class="dv">4</span>], is.double)
## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##         TRUE         TRUE         TRUE         TRUE

<span class="co"># Set up plotting region</span>
op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="kw">c</span>(<span class="st">&quot;mfrow&quot;</span>, <span class="st">&quot;mar&quot;</span>))
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>))

<span class="co"># Plot four density graphs using a looping function</span>
<span class="kw">invisible</span>(<span class="kw">sapply</span>(<span class="dv">1</span>:<span class="dv">4</span>, function(x) <span class="kw">plot</span>(<span class="kw">density</span>(iris[, x]), <span class="dt">main =</span> <span class="kw">names</span>(iris)[x], <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>, <span class="dt">cex.main =</span> <span class="fl">0.8</span>)))</code></pre></div>
<p><img src="figures/unnamed-chunk-161-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Reset original parameters</span>
<span class="kw">par</span>(<span class="dt">mfrow =</span> op$mfrow, <span class="dt">mar =</span> op$mar)

<span class="co"># Try reproducing this plots by making individual &quot;plot()&quot; calls</span></code></pre></div>
<p>For our second example we will demonstrate effects of standard deviation (SD) on data distribution. Standard deviation is average distance of each data point from the mean.</p>
<p>Our task here is to output for density plots (lines) showing 1, 2 and 3 standard deviation away from mean 100.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Generate four data sets from random distrubutions with different SD </span>
a &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span>:<span class="dv">3</span>, function(x) <span class="kw">rnorm</span>(<span class="dv">1000</span>, <span class="dv">100</span>, x))

<span class="co"># Increase plotting region (reducing outer margin)</span>
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>))

<span class="co"># Plot first distribution that will set up plotting region (giving x and y limits)</span>
<span class="kw">plot</span>(<span class="kw">density</span>(a[[<span class="dv">1</span>]]), <span class="dt">ann =</span> <span class="ot">FALSE</span>, <span class="dt">las =</span> <span class="dv">1</span>)
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;Distributions with different standard deviation (SD)&quot;</span>, <span class="dt">line =</span> <span class="fl">1.5</span>, <span class="dt">cex.main =</span> <span class="dv">1</span>)

<span class="co"># Add other distribution using lines function</span>
<span class="kw">lines</span>(<span class="kw">density</span>(a[[<span class="dv">2</span>]]), <span class="dt">col =</span> <span class="dv">4</span>)
<span class="kw">lines</span>(<span class="kw">density</span>(a[[<span class="dv">3</span>]]), <span class="dt">col =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-162-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Redo the last part i.e. drawing of lines by using &quot;sapply&quot;: Coding principle -&gt; &quot;less-is-efficient&quot;. Think about this principle and let&#39;s discuss it in our follow-up book.   </span></code></pre></div>
</div>
<div id="annotating-plots-with-legends" class="section level4">
<h4><span class="header-section-number">8.7.1.3</span> Annotating Plots with Legends</h4>
<p>Legends give useful information about plots, more so for multi-plotting. They can be added anywhere on the plotting region (coordinate plane) although consideration should be made to avoid obscuring core plot.</p>
<p>We will add a legend to our density distribution plot indicating what each line represents.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">density</span>(a[[<span class="dv">1</span>]]), <span class="dt">ann =</span> <span class="ot">FALSE</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;Distributions with different standard deviations (SD)&quot;</span>, <span class="dt">line =</span> <span class="fl">1.5</span>, <span class="dt">cex.main =</span> <span class="dv">1</span>)
cols &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">2</span>)
<span class="kw">invisible</span>(<span class="kw">sapply</span>(<span class="dv">1</span>:<span class="dv">3</span>, function(x) <span class="kw">lines</span>(<span class="kw">density</span>(a[[x]]), <span class="dt">col =</span> cols[x])))

<span class="co"># Add legend using a key word instead of coordinates</span>
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;One SD&quot;</span>, <span class="st">&quot;Two SD&quot;</span>, <span class="st">&quot;Three SD&quot;</span>), <span class="dt">cex =</span> <span class="fl">0.9</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col =</span> cols)</code></pre></div>
<p><img src="figures/unnamed-chunk-163-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Reset original parameters</span>
<span class="kw">par</span>(<span class="dt">mar =</span> op$mar)</code></pre></div>
</div>
<div id="polygons" class="section level4">
<h4><span class="header-section-number">8.7.1.4</span> Polygons</h4>
<p>Any area of a plot can be shaded or marked with function “polygon”. This function takes coordinates of “vertices” (corners) and draws a suitable polygon. Polygons can be filled with color, shaded with line or with borders only; they are useful in showing area under a curve like in density plots.</p>
<p>In the following example we will shade area under a density plot indicating one standard deviation away from the mean or 68%. We shall not use calculus for now but hopefully we will get a refresher right before our chapters on data analysis in our third book for this tutorial series.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Seed used for reproducibility </span>
<span class="kw">set.seed</span>(<span class="dv">384</span>)

<span class="co"># Drawing standard random numbers and computing density </span>
x &lt;-<span class="st"> </span><span class="kw">density</span>(<span class="kw">rnorm</span>(<span class="dv">100</span>))

<span class="co"># Making a density plot</span>
<span class="kw">plot</span>(x, <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">main =</span> <span class="st">&quot;One standard deviation, about 68%&quot;</span>)
<span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at =</span> -<span class="dv">4</span>:<span class="dv">4</span>)

<span class="co"># Obtaining values between -1 and posive 1</span>
ind1 &lt;-<span class="st"> </span><span class="kw">grep</span>(<span class="dt">pattern =</span> <span class="st">&quot;^-1.&quot;</span>, <span class="kw">as.character</span>(x$x))
ind2 &lt;-<span class="st"> </span><span class="kw">grep</span>(<span class="dt">pattern =</span> <span class="st">&quot;^1.&quot;</span>, <span class="dt">x =</span> <span class="kw">as.character</span>(x$x))

<span class="co"># Getting value close to required range</span>
x1 &lt;-<span class="st"> </span><span class="kw">max</span>(x$x[ind1])
x2 &lt;-<span class="st"> </span><span class="kw">min</span>(x$x[ind2])

<span class="co"># Finding corresponding y values</span>
y1 &lt;-<span class="st"> </span>x$y[<span class="kw">which</span>(x$x ==<span class="st"> </span>x1)]
y2 &lt;-<span class="st"> </span>x$y[<span class="kw">which</span>(x$x ==<span class="st"> </span>x2)]

<span class="co"># Area coordinates</span>
dat1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">rep</span>(<span class="kw">c</span>(x1, x2), <span class="dt">each =</span> <span class="dv">2</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">0</span>, y1, y2, <span class="dv">0</span>))
dat2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x$x, x$y)[<span class="dv">182</span>:<span class="dv">315</span>,]

<span class="co"># Shading area under a curve (representing 68% or 1sd away from mean)</span>
<span class="kw">polygon</span>(dat1, <span class="dt">col =</span> <span class="dv">8</span>, <span class="dt">border =</span> <span class="dv">8</span>)
<span class="kw">polygon</span>(dat2, <span class="dt">col =</span> <span class="dv">8</span>, <span class="dt">border =</span> <span class="dv">8</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-164-1.png" width="672" /></p>
</div>
</div>
<div id="box-box-and-whisker-plots" class="section level3">
<h3><span class="header-section-number">8.7.2</span> Box (box-and-whisker) plots</h3>
<p>Box plots like histograms and density plots are useful for displaying data distribution. These plots are based on the five number summary, that is “minimum”, “Q1”, “Q2 (median)”, “Q3”, and “maximum”. Letter “Q” stands for “quarter”, that is quarter 1, quarter 2 and quarter 3. These summary statistic can be displayed in a box plot as univariate (distribution of one numerical variable) or bi/multivariate (one numerical variable and factor variable(s)) displays.</p>
<div id="univariate-box-plot" class="section level4">
<h4><span class="header-section-number">8.7.2.1</span> Univariate box plot</h4>
<p>Univariate box plots involve one numerical variable. In R, function “boxplot” produces these plots which are also referred to as box-and-whisker plots. Box plot is vectorised meaning it can accept multiple vectors and will output plots the same size as the number of vectors passed.</p>
<p>For instance, we can generate box plots for the first four columns of iris data set with one call and without calling a looping function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(<span class="dt">x =</span> iris[, <span class="dv">1</span>:<span class="dv">4</span>], <span class="dt">main =</span> <span class="st">&quot;Boxplot of Iris Data Set&quot;</span>, <span class="dt">las =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="figures/oneVarBoxPlots-1.png" width="672" /></p>
<p>As with other plots in base R, box plots can be improved to communicate or accentuate certain areas of the plot.</p>
<p>For example, we can add some background color to the boxes (to display IQR), change plotting character (to show extreme values), show only average on y axis (to make them stand out), make x axis labels to be slant (for legibility), add segments (linking average value and boxes) and finally frame the plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Generating box plots</span>
<span class="kw">boxplot</span>(iris[, <span class="dv">1</span>:<span class="dv">4</span>], <span class="dt">col =</span> <span class="dv">8</span>, <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">main =</span> <span class="st">&quot;Fishers et.al Iris Data Set&quot;</span>)

<span class="co"># Computing averages</span>
average &lt;-<span class="st"> </span><span class="kw">sapply</span>(iris[,<span class="dv">1</span>:<span class="dv">4</span>], median)

<span class="co"># Adding y axis with tickmarks and labels at averages</span>
<span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at =</span> average, <span class="dt">las =</span> <span class="dv">1</span>)

<span class="co"># Adding x axis but without labels</span>
<span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">labels =</span> <span class="ot">FALSE</span>)

<span class="co"># # Adding labels </span>
<span class="kw">text</span>(<span class="dt">x =</span> <span class="dv">1</span>:<span class="dv">4</span>, <span class="dt">y =</span> <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">3</span>] -<span class="st"> </span><span class="fl">0.9</span>, <span class="dt">labels =</span> <span class="kw">names</span>(iris[,<span class="dv">1</span>:<span class="dv">4</span>]), <span class="dt">srt =</span> <span class="dv">45</span>, <span class="dt">xpd =</span> <span class="ot">NA</span>, <span class="dt">adj =</span> <span class="dv">1</span>)

<span class="co"># Showing averages with segments</span>
<span class="kw">segments</span>(<span class="dt">x0 =</span> <span class="dv">0</span>, <span class="dt">y0 =</span> average, <span class="dt">x1 =</span> <span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">4</span>), <span class="dt">col =</span> <span class="dv">8</span>, <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)

<span class="co"># Adding a frame around plotting area</span>
<span class="kw">box</span>()</code></pre></div>
<p><img src="figures/oneVarBoxPlotsAes-1.png" width="672" /></p>
</div>
<div id="bivariate-box-plots" class="section level4">
<h4><span class="header-section-number">8.7.2.2</span> Bivariate Box Plots</h4>
<p>Box plots can be quite informative if summary statistics are displayed by levels of a categorical variable(s). Producing box plots given levels of a factor variable will require calling “boxplot” with a formula as its first argument. Formulas in R are in the form “y ~ x” meaning y given x. For box plots, y must be numeric while x can be a categorical variable. If x is not a categorical variable, R will produce box plots of y by unique values of x, this can be an overpopulated figure if unique values of x are many.</p>
<p>For our example, let’s look at “Sepal.Length” in the Iris data set and summarize it by flower species.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plotting but suppressing x axis and increasing y axis for better scale display </span>
<span class="kw">boxplot</span>(Sepal.Length ~<span class="st"> </span>Species, <span class="dt">data =</span> iris, <span class="dt">col =</span> <span class="dv">8</span>, <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">8</span>), <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">main =</span> <span class="st">&#39;Iris &quot;Sepal.Length&quot; by flower species&#39;</span>, <span class="dt">cex.main =</span> <span class="fl">1.3</span>, <span class="dt">font =</span> <span class="dv">7</span>, <span class="dt">las =</span> <span class="dv">1</span>)
<span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">at =</span> <span class="dv">1</span>:<span class="dv">3</span>, <span class="dt">labels =</span> <span class="kw">levels</span>(iris$Species), <span class="dt">line =</span> <span class="dv">0</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-165-1.png" width="672" /></p>
</div>
<div id="multivariate-box-plots" class="section level4">
<h4><span class="header-section-number">8.7.2.3</span> Multivariate Box Plots</h4>
<p>Multivariate box plots are generated by adding a terms to the formula. These formulas are in the form “y ~ x + a” meaning grouping by unique/levels of x and a.</p>
<p>In this example we will use reshape2’s “tips” data set to generate box plots of tips by gender and smoking habits. We will also use argument width to show relative size of each group.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Data</span>
tips &lt;-<span class="st"> </span>reshape2::tips

<span class="co"># Widths for boxes (IQR)</span>
width &lt;-<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">tapply</span>(tips$tip, tips[, <span class="kw">c</span>(<span class="st">&quot;sex&quot;</span>, <span class="st">&quot;smoker&quot;</span>)], function(x) <span class="kw">length</span>(x)/<span class="kw">nrow</span>(tips)))

gender &lt;-<span class="st"> </span><span class="kw">levels</span>(tips$sex)

<span class="co"># Drawing box plot for each group and passing a width arguments</span>
<span class="kw">boxplot</span>(tip ~<span class="st"> </span>sex +<span class="st"> </span>smoker, <span class="dt">data =</span> tips, <span class="dt">width =</span> width, <span class="dt">main =</span> <span class="st">&quot;Tips by Smoking status&quot;</span>, <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="ot">NA_character_</span>, <span class="st">&quot;grey50&quot;</span>), <span class="dt">each =</span> <span class="dv">2</span>), <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">font.main =</span> <span class="dv">7</span>)
<span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">labels =</span> <span class="ot">FALSE</span>)

<span class="co"># Adding labels</span>
<span class="kw">text</span>(<span class="dt">x =</span> <span class="dv">1</span>:<span class="dv">4</span>, <span class="dt">y =</span> <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">3</span>] -<span class="st"> </span><span class="fl">0.9</span>, <span class="dt">labels =</span> <span class="kw">rep</span>(gender, <span class="dv">2</span>), <span class="dt">xpd =</span> <span class="ot">TRUE</span>)
<span class="kw">text</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">3.5</span>), <span class="dt">y =</span> <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">3</span>] -<span class="st"> </span><span class="fl">1.5</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Non-Smoker&quot;</span>, <span class="st">&quot;Smoker&quot;</span>), <span class="dt">xpd =</span> <span class="ot">TRUE</span>)

<span class="co"># Displaying average tips</span>
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">median</span>(tips$tip), <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="dv">8</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-166-1.png" width="672" /></p>
</div>
</div>
<div id="strip-chartsdot-plots" class="section level3">
<h3><span class="header-section-number">8.7.3</span> Strip Charts/Dot Plots</h3>
<p>For small data sets, strip charts are better alternatives to box plots. Strip charts shows distribution of actual data point.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Univariate strip chart</span>
<span class="kw">stripchart</span>(BOD, <span class="dt">vertical =</span> <span class="ot">TRUE</span>, <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">col =</span> <span class="dv">4</span>, <span class="dt">at =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">5</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">7</span>), <span class="dt">main =</span> <span class="st">&quot;BOD Data set&quot;</span>, <span class="dt">las =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-167-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Bivariate strip chart </span>
<span class="kw">stripchart</span>(weight ~<span class="st"> </span>feed, <span class="dt">data =</span> chickwts, <span class="dt">vertical =</span> <span class="ot">TRUE</span>, <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">col =</span> <span class="dv">4</span>, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">main =</span> <span class="st">&quot;Chickwts data set&quot;</span>)
<span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">labels =</span> <span class="ot">FALSE</span>)
<span class="kw">text</span>(<span class="dt">x =</span> <span class="dv">1</span>:<span class="kw">nlevels</span>(chickwts$feed) , <span class="dt">y =</span> <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">3</span>] -<span class="st"> </span><span class="dv">25</span>, <span class="dt">labels =</span> <span class="kw">levels</span>(chickwts$feed), <span class="dt">srt =</span> <span class="dv">45</span>, <span class="dt">xpd =</span> <span class="ot">TRUE</span>, <span class="dt">adj =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-167-2.png" width="672" /></p>
</div>
<div id="conditional-plots-coplot" class="section level3">
<h3><span class="header-section-number">8.7.4</span> Conditional Plots (Coplot)</h3>
<p>Conditional plots are used to show association between variables based on some condition(s). Association between these variables is often written as conditional formulas in the form “y ~ x | a” (read as “y” in relation to “x” given “a”); “a” is the condition.</p>
<p>Conditional formulas have at least two operators; a tilde (~) denoting a formula and a bar (|) indicating presence of a condition. In R, relationship between x and y given “a” or “a” and “b” can be plotted using function “coplot”. When there are two conditions (“a” and “b”), relationship between these conditions can be one of either additive (main effect) or multiplicative (interaction terms).</p>
<p>Additive models are in the form “y ~ x | a + b” which is the relationship of “x” and “y” given “a” and “b”. Multiplicative interactions are in the form “y ~ x | a * b” which is the combined effect of main effects (a + b) and their interaction. We shall discuss this further during our regression chapter in “Introduction to Data Analysis and Graphics using R” book.</p>
<p>One of coplot’s argument is a “panel” function which will become quite handy in our third book in this series as we fitting regression lines, but for now we will use default points for demonstration.</p>
<p>As an example of multi-paneling in base R using coplot, we will plot relationship between proportion of tips to total bill, first by gender and then by both gender and smoking habits. In this example we are using proportion rather than actual tip to take account of size of bill paid.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Computing proportion of tips from total bill</span>
tips$propTips &lt;-<span class="st"> </span><span class="kw">with</span>(tips, tip/total_bill)

<span class="co"># Relationship between proportion of tips to total bill by partrons gender</span>
<span class="kw">coplot</span>(propTips ~<span class="st"> </span>total_bill |<span class="st"> </span>sex, <span class="dt">data =</span> tips, <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">col =</span> color, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">xlab =</span> <span class="st">&quot;Relationship between Total Bill and Tips&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Proportion of tips&quot;</span>, <span class="dt">cex.lab =</span> <span class="fl">0.9</span>)</code></pre></div>
<p><img src="figures/multiVarRegression-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Relationship between proportion of tips to total bill by partron&#39;s gender and smoking habit</span>
<span class="kw">coplot</span>(propTips ~<span class="st"> </span>total_bill |<span class="st"> </span>sex +<span class="st"> </span>smoker, <span class="dt">data =</span> tips, <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">col =</span> color, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">xlab =</span> <span class="st">&quot;Relationship between Total Bill and Tips&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Proportion of tips&quot;</span>)</code></pre></div>
<p><img src="figures/multiVarRegression-2.png" width="672" /></p>
</div>
<div id="stem-and-leaf-plot" class="section level3">
<h3><span class="header-section-number">8.7.5</span> Stem and Leaf plot</h3>
<p>Stem and leaf plots are quick and easy exploratory data analysis tools. They are good in terms of data-ink ratio and displaying distributions. These plots are really not plots as much as they are tables, in that they show actual values rather than points or bins. In fact, if you flipped them horizontally, they look like are dot plots with values instead of plotting characters.</p>
<p>Stem represent the first digit of a number and leaves are subsequent values. For example, number 126 has 1 as its stem and 26 and its leaves.</p>
<p>In R, these plots are generated with the function “stem()” which outputs to console rather than plotting window.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Actual data sort in decreasing </span>
<span class="kw">sort</span>(iris$Sepal.Length)
##   [1] 4.3 4.4 4.4 4.4 4.5 4.6 4.6 4.6 4.6 4.7 4.7 4.8 4.8 4.8 4.8 4.8 4.9
##  [18] 4.9 4.9 4.9 4.9 4.9 5.0 5.0 5.0 5.0 5.0 5.0 5.0 5.0 5.0 5.0 5.1 5.1
##  [35] 5.1 5.1 5.1 5.1 5.1 5.1 5.1 5.2 5.2 5.2 5.2 5.3 5.4 5.4 5.4 5.4 5.4
##  [52] 5.4 5.5 5.5 5.5 5.5 5.5 5.5 5.5 5.6 5.6 5.6 5.6 5.6 5.6 5.7 5.7 5.7
##  [69] 5.7 5.7 5.7 5.7 5.7 5.8 5.8 5.8 5.8 5.8 5.8 5.8 5.9 5.9 5.9 6.0 6.0
##  [86] 6.0 6.0 6.0 6.0 6.1 6.1 6.1 6.1 6.1 6.1 6.2 6.2 6.2 6.2 6.3 6.3 6.3
## [103] 6.3 6.3 6.3 6.3 6.3 6.3 6.4 6.4 6.4 6.4 6.4 6.4 6.4 6.5 6.5 6.5 6.5
## [120] 6.5 6.6 6.6 6.7 6.7 6.7 6.7 6.7 6.7 6.7 6.7 6.8 6.8 6.8 6.9 6.9 6.9
## [137] 6.9 7.0 7.1 7.2 7.2 7.2 7.3 7.4 7.6 7.7 7.7 7.7 7.7 7.9

<span class="co"># Stem and leaf plot of Sepal Length</span>
<span class="kw">stem</span>(iris$Sepal.Length, <span class="dt">scale =</span> <span class="dv">2</span>)
## 
##   The decimal point is 1 digit(s) to the left of the |
## 
##   43 | 0
##   44 | 000
##   45 | 0
##   46 | 0000
##   47 | 00
##   48 | 00000
##   49 | 000000
##   50 | 0000000000
##   51 | 000000000
##   52 | 0000
##   53 | 0
##   54 | 000000
##   55 | 0000000
##   56 | 000000
##   57 | 00000000
##   58 | 0000000
##   59 | 000
##   60 | 000000
##   61 | 000000
##   62 | 0000
##   63 | 000000000
##   64 | 0000000
##   65 | 00000
##   66 | 00
##   67 | 00000000
##   68 | 000
##   69 | 0000
##   70 | 0
##   71 | 0
##   72 | 000
##   73 | 0
##   74 | 0
##   75 | 
##   76 | 0
##   77 | 0000
##   78 | 
##   79 | 0</code></pre></div>
</div>
<div id="bar-graphs-and-pie-chart" class="section level3">
<h3><span class="header-section-number">8.7.6</span> Bar graphs and pie chart</h3>
<p>Bar graphs and pie charts are used for univariate categorical data. These plots are not ideal in terms of data-ink ratio but are good for exploratory data analysis (EDA) and presentations.</p>
<div id="bar-graphs" class="section level4">
<h4><span class="header-section-number">8.7.6.1</span> Bar Graphs</h4>
<p>Bar graphs are similar to histogram but instead of bins where continuous data is cut into groups/intervals, bar graphs use counts for for each levels/categories. To construct these graphs, function “barplot” is called with height of each bar as its first argument. Height are count data of a categorical variable often presented as tables or matrices. Height of a factor vector can be computed using function “table”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Heights for a factor vector</span>
tipsDays &lt;-<span class="st"> </span><span class="kw">table</span>(tips$day)
tipsDays
## 
##  Fri  Sat  Sun Thur 
##   19   87   76   62</code></pre></div>
<p>Table can also be used to get heights for bivariates.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tipsDayTime &lt;-<span class="st"> </span><span class="kw">with</span>(tips, <span class="kw">table</span>(day, time))
tipsDayTime
##       time
## day    Dinner Lunch
##   Fri      12     7
##   Sat      87     0
##   Sun      76     0
##   Thur      1    61</code></pre></div>
<p>These objects of class table can now be passed to bar plots as height. For tables greater than one dimension, it might be useful to set besides to TRUE otherwise default is to stack the row levels on column levels.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;mfrow&quot;</span>)
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))

<span class="kw">barplot</span>(tipsDays, <span class="dt">main =</span> <span class="st">&quot;One Dimension Bar plot&quot;</span>, <span class="dt">col =</span> blues9[<span class="dv">2</span>])

<span class="kw">barplot</span>(tipsDayTime, <span class="dt">main =</span> <span class="st">&quot;A stacked barplot&quot;</span>, <span class="dt">col =</span> blues9[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>)])

<span class="kw">barplot</span>(tipsDayTime, <span class="dt">main =</span> <span class="st">&quot;Bar plot with beside = TRUE&quot;</span>, <span class="dt">beside =</span> <span class="ot">TRUE</span>, <span class="dt">cex.main =</span> <span class="fl">0.9</span>, <span class="dt">col =</span> blues9[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>)])

<span class="kw">par</span>(<span class="dt">mfrow =</span> op)</code></pre></div>
<p><img src="figures/unnamed-chunk-171-1.png" width="672" /></p>
<p>Unlike plot and other plotting functions, bar chart has an argument for adding legends to plots, this is “legend.text”. If set to TRUE, legend.text will add a legend with names of height for 1d tables/arrays or row names for 2d tables. Other legend labels can be passed to this argument. Argument “arg.legend” can be used to control how legend is constructed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot</span>(<span class="dt">height =</span> tipsDayTime, <span class="dt">legend.text =</span> <span class="ot">TRUE</span>, <span class="dt">beside =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="st">&quot;Bar plot with a legend&quot;</span>, <span class="dt">args.legend =</span> <span class="kw">list</span>(<span class="dt">x =</span> <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">2</span>], <span class="dt">y =</span> <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">4</span>] +<span class="st"> </span><span class="dv">5</span>, <span class="dt">cex =</span> <span class="fl">0.8</span>, <span class="dt">xpd =</span> <span class="ot">NA</span>, <span class="dt">x.intersp =</span> <span class="fl">0.5</span>, <span class="dt">y.intersp =</span> <span class="fl">0.6</span>), <span class="dt">col =</span> blues9[<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>)])</code></pre></div>
<p><img src="figures/unnamed-chunk-172-1.png" width="672" /></p>
<div id="pie-chart" class="section level5">
<h5><span class="header-section-number">8.7.6.1.1</span> Pie Chart</h5>
<p>Pie charts are classic data display for (univariate) categorical data. They have over the years received a lot of negative criticisms as far as visual perception is concerned. We will not get into that right now as this is based on data being communicated which we will cover in our third book. But even with all discussion on this plot, it is by far one of the easiest plots to generate and read. Quite useful when there are few categories and during exploratory data analysis. In R they are generated with “pie” function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pie</span>(<span class="kw">table</span>(tips$day))</code></pre></div>
<p><img src="figures/pieChart-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="mosaic" class="section level3">
<h3><span class="header-section-number">8.7.7</span> Mosaic</h3>
<p>Mosaic plots are good for showing multivariate categorical data for example looking at college admission for each department by gender. Function used to produce this plot is called “mosaicplot” which takes a contingency or cross-classification table as its first argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Confirming class of object to be passed to mosaic plot</span>
<span class="kw">class</span>(UCBAdmissions)
## [1] &quot;table&quot;

<span class="co"># Generating a multivariate factor plot</span>
<span class="kw">mosaicplot</span>(UCBAdmissions, <span class="dt">color =</span> blues9[<span class="dv">1</span>:<span class="dv">6</span>])</code></pre></div>
<p><img src="figures/unnamed-chunk-173-1.png" width="672" /></p>
</div>
<div id="fourfold-plots" class="section level3">
<h3><span class="header-section-number">8.7.8</span> Fourfold Plots</h3>
<p>Four fold is an interesting plot for visualizing associations in 2 by 2 by k contingency tables. “k” here means stratus’s which can be presented as 3d arrays.</p>
<p>For 2 by 2 tables, each cell count forms a quarter of a circle with radius proportional to its square root. Confidence rings for odds ratios are added to show test of no association (null hypothesis), if rings of adjacent quadrant overlap, then null hypothesis is not rejected. We will explore this topic in our third book when discussing displaying categorical data, but for now let’s get to know how to produce the plot with function “fourfoldplot”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Making a 2 by 2 contigency table</span>
tipsSexSmoker &lt;-<span class="st"> </span><span class="kw">with</span>(tips, <span class="kw">table</span>(sex, smoker))
tipsSexSmoker
##         smoker
## sex      No Yes
##   Female 54  33
##   Male   97  60

<span class="co"># Displaying association</span>
<span class="kw">fourfoldplot</span>(tipsSexSmoker)</code></pre></div>
<p><img src="figures/unnamed-chunk-174-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Displaying association by strata (gender)</span>
tipsTimeSmokerSex &lt;-<span class="st"> </span><span class="kw">with</span>(tips, <span class="kw">table</span>(time, smoker, sex))
<span class="kw">fourfoldplot</span>(tipsTimeSmokerSex)</code></pre></div>
<p><img src="figures/unnamed-chunk-174-2.png" width="672" /></p>
</div>
<div id="sunflower-plots" class="section level3">
<h3><span class="header-section-number">8.7.9</span> Sunflower plots</h3>
<p>Sunflower plots are used for reading over plotted points on scatter plots (where density distribution is obscured). These are produced with “sunflowerplot()”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;mfrow&quot;</span>, <span class="st">&quot;xpd&quot;</span>)
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">xpd =</span> <span class="ot">TRUE</span>)

<span class="co"># Default plot</span>
<span class="kw">plot</span>(faithful$waiting, faithful$eruptions, <span class="dt">main =</span> <span class="st">&quot;Default plot&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;waiting&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;eruptions&quot;</span>, <span class="dt">las =</span> <span class="dv">1</span>)

<span class="co"># Sunflower plot </span>
<span class="kw">sunflowerplot</span>(faithful$waiting, faithful$eruptions, <span class="dt">xlab =</span> <span class="st">&quot;waiting&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;eruptions&quot;</span>, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">seg.col =</span> <span class="st">&quot;deeppink&quot;</span>, <span class="dt">cex =</span> .<span class="dv">5</span>, <span class="dt">cex.fact =</span> <span class="dv">1</span>)
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;Sunflowerplot showing overplotting&quot;</span>, <span class="dt">xpd =</span> <span class="ot">TRUE</span>, <span class="dt">cex.main =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-175-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">par</span>(<span class="dt">mfrow =</span> op)</code></pre></div>
</div>
<div id="time-series-plots-line" class="section level3">
<h3><span class="header-section-number">8.7.10</span> Time series plots (line)</h3>
<p>Time series objects are created with function “ts” and plotted with generic “plot” function; recall it has a method for class “ts” as in “plot.ts()”. plot.ts() is basically “plot(x, type = ‘l’)” which means a line plot; therefore a numerical vector can still produce a plot similar to a time series plot.</p>
<p>Let’s look at how time series plots can be generated by passing a numerical and time objects as x and y and then call plot with the same values but converted to a time series object. We shall use a data set from ggplot2 called “economic”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;mfrow&quot;</span>, <span class="st">&quot;mar&quot;</span>)
  
<span class="co"># Original parameters</span>
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="fl">0.5</span>))

<span class="co"># Plotting non time series objects</span>
<span class="kw">plot</span>(economics$date, economics$unemploy, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Unemployed (thousand)&quot;</span>, <span class="dt">main =</span> <span class="st">&#39;Using plot type &quot;l&quot;&#39;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">col =</span> <span class="dv">4</span>, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">cex.axis =</span> <span class="fl">0.9</span>)

<span class="co"># Plotting time series objects</span>
<span class="co"># First creating a &quot;ts&quot; object</span>
unEmpTS &lt;-<span class="st"> </span><span class="kw">ts</span>(<span class="dt">data =</span> economics$unemploy, <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">1967</span>, <span class="dv">7</span>), <span class="dt">frequency =</span> <span class="dv">12</span>)
<span class="kw">plot</span>(unEmpTS, <span class="dt">plot.type =</span> <span class="st">&quot;single&quot;</span>, <span class="dt">col =</span> <span class="dv">4</span>, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">main =</span> <span class="st">&#39;With a &quot;ts&quot; object&#39;</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">cex.axis =</span> <span class="fl">0.8</span>)

<span class="co"># A joint x label</span>
<span class="kw">text</span>(<span class="dt">x =</span> <span class="dv">1950</span>, <span class="dt">y =</span> -<span class="dv">2800</span>, <span class="dt">labels =</span> <span class="st">&quot;Time 1968 - 2015 (monthly)&quot;</span>, <span class="dt">xpd =</span> <span class="ot">NA</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-176-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Reseting parameters</span>
<span class="kw">par</span>(<span class="dt">mfrow =</span> op$mfrow, <span class="dt">mar =</span> op$mar)</code></pre></div>
<div id="month-plot" class="section level4">
<h4><span class="header-section-number">8.7.10.1</span> Month plot</h4>
<p>Month plots show differences in seasons or cycles over time. These plots are constructed with “monthplot()”, a generic function with methods for time series and decomposed time series objects (decomposed by “stl” or “StructTS”).</p>
<p>As an example, let’s look at two month plots showing seasonal variation, that is monthly average over time.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)) 

<span class="co"># Decomposing (stl) unemployment time series data</span>
decompUnEmp &lt;-<span class="st"> </span><span class="kw">stl</span>(unEmpTS, <span class="dt">s.window =</span> <span class="st">&quot;periodic&quot;</span>)

<span class="co"># Showing monthly difference</span>
<span class="kw">monthplot</span>(decompUnEmp)

<span class="co"># </span>
decompNottem &lt;-<span class="st"> </span><span class="kw">stl</span>(nottem, <span class="st">&quot;periodic&quot;</span>)
<span class="kw">monthplot</span>(decompNottem)</code></pre></div>
<p><img src="figures/unnamed-chunk-177-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">par</span>(<span class="dt">mfrow =</span> op$mfrow)</code></pre></div>
<p>As a conclusion to this subsection, it is good to note that R has numerous other plots that we have not looked at. The core of this section was to have a glimpse at some of these plotting functions rather than an in-depth review. We will revisit most of them during data analysis as they will become relevant.</p>
</div>
</div>
</div>
<div id="colours" class="section level2">
<h2><span class="header-section-number">8.8</span> Colors</h2>
<p>So far we have been creating plots with minimal number and variation of colors. In this section we get to see how to change that. Of interest here is to know colors available in base R and ways of generating more colors.</p>
<p>To understand what colors are available in R, we need to first know what values R expects as valid colors to be passed to color arguments and graphical parameters. In this regard we will start off this section by discussing expected values for color arguments then proceed on to learn base R colors and color creation.</p>
<div id="expected-values-for-color-based-arguments" class="section level3">
<h3><span class="header-section-number">8.8.1</span> Expected values for color-based arguments</h3>
<p>Color arguments and color based graphical parameters expect either numeric or character objects. Anything other than these two type of objects would raise a warning message as R would not understand it.<br />
Let’s look at how to pass these two values.</p>
<div id="numeric-values" class="section level4">
<h4><span class="header-section-number">8.8.1.1</span> Numeric Values</h4>
<p>In line with “S” programming language, R has a selection of colors contained in what is called a “palette”. A palette is a selection of colors which are indexed such that each color can be referred to by its index. These indices are the numerical values passed to color argument.</p>
<p>Function “palette” is used to query colors in a palette, this done by calling the function without passing any argument, “palette()”. Initially, base R’s palette consists of eight colors which are “black”, “red”, “green3”, “blue”, “cyan”, “magenta”, “yellow” and “gray”. If “5” is passed as a value to a color argument, it would mean “cyan”. If a value is greater than eight, R will recycle colors in the palette until it reaches given value, for example “12” would result to “blue”. Zero is reserved for “white” or default device color. Any value below 0 is an error.</p>
<p>To visualize colors, we will use the following function extracted from package “colorspace”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pal &lt;-<span class="st"> </span>function(col, <span class="dt">border =</span> <span class="st">&quot;transparent&quot;</span>, ...) {
  n &lt;-<span class="st"> </span><span class="kw">length</span>(col)
  <span class="kw">plot</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, ...)
  <span class="kw">rect</span>(<span class="dv">0</span>:(n -<span class="st"> </span><span class="dv">1</span>)/n, <span class="dv">0</span>, <span class="dv">1</span>:n/n, <span class="dv">1</span>, <span class="dt">col =</span> col, <span class="dt">border =</span> border)
}</code></pre></div>
<p>R’s default palette</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pal</span>(<span class="kw">palette</span>())
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;R&#39;s default color palette&quot;</span>, <span class="dt">line =</span> <span class="fl">0.2</span>)
<span class="kw">text</span>(<span class="kw">seq</span>(<span class="fl">0.0625</span>, <span class="fl">0.9375</span>, <span class="dt">by =</span> <span class="fl">0.125</span>), <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">3</span>], <span class="dt">labels =</span> <span class="kw">paste</span>(<span class="dv">1</span>:<span class="dv">8</span>, <span class="st">&quot;=&quot;</span>, <span class="kw">palette</span>()), <span class="dt">xpd =</span> <span class="ot">NA</span>, <span class="dt">srt =</span> <span class="dv">45</span>, <span class="dt">adj =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="figures/defaultPalette-1.png" width="672" /></p>
</div>
<div id="character-values" class="section level4">
<h4><span class="header-section-number">8.8.1.2</span> Character values</h4>
<p>Characters values passed to color argument can either be hexadecimal values or R’s built-in color names.</p>
<div id="hexadecimal" class="section level5">
<h5><span class="header-section-number">8.8.1.2.1</span> Hexadecimal color codes</h5>
<p>Hexadecimal is a numeral positioning system that uses 16 distinct values rather than usual 10 number system called “decimal”. These 16 values are 0 to 9 and A to F equivalent to 0 to 15 in decimal notation. In hexadecimal notation, once “F” is reached, counting begins again as 20 and progresses until 2F when it restarts at 30. For example, a hexadecimal value like 2F would be 47 in decimal notation, that is 2 times base 16 raised to one plus 15 (which is F) multiplied by sixteen raised to zero <code>((2*16^1) + (15*16^0))</code>. The point to note here is that for any hexadecimal value, there are 16 possible values it can assume rather than ten. Look at it this way, if hexadecimal values were put in an urn and one is picked, the value can be one of 1, 2, 3, 4, 5, 6, 7, 8, 9, A, B, C, D, E or F.</p>
<p>With this in mind, in terms of color codes, hexadecimals are used to represent colors in the form of a six-digit hexadecimal notation. These six digits are “RRGGBB”, which represent composition of primary colors “red” (RR), “green” (GG) and “blue” (BB). Notice each color has two hexadecimal values, these form a computer byte which is the required computer storage capacity for a single character.</p>
<p>Since we now know one hexadecimal has 16 possible values, then 2 hexadecimals can have <code>16 * 16</code> or <code>16^2</code> possible values. In color codes this means each of the primary colors has 256 or 0-255 possible colors. In total, they can be 1.677721610^{7} (256^3) possible colors and therefore about sixteen million unique hexadecimal color codes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Sixteen hexadecimal value</span>
hexVals &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>:<span class="dv">9</span>, LETTERS[<span class="dv">1</span>:<span class="dv">6</span>])

<span class="co"># Length obtained by getting all possible combitations</span>
nColors &lt;-<span class="st"> </span><span class="kw">nrow</span>(<span class="kw">expand.grid</span>(hexVals, hexVals, hexVals, hexVals, hexVals, hexVals))
nColors
## [1] 16777216</code></pre></div>
<p>As an example, in terms of decimal notation and based on the 255 possible colors for each of the primary colors, a color, say “burgundy” is composed of 158/255 (0.62) of red, 5/255 (0.02) of green and 8/255 (0.03) of blue. In hexadecimal notation, 158 for red translates to <code>9E</code>, 5 for green is <code>05</code> and 8 for blue is <code>08</code>. These hexadecimal values are combine as <code>#9E0508</code>, note the pound “#” symbol at the beginning. This hexadecimal value can be passed to any color argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(BOD, <span class="dt">pch =</span> <span class="dv">21</span>, <span class="dt">bg =</span> <span class="st">&quot;#9E0508&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">20</span>), <span class="dt">main =</span> <span class="st">&#39;A touch of &quot;Burgundy&quot;&#39;</span>, <span class="dt">panel.first =</span> <span class="kw">lines</span>(<span class="kw">spline</span>(BOD)))</code></pre></div>
<p><img src="figures/unnamed-chunk-180-1.png" width="672" /></p>
</div>
<div id="rs-built-in-color-names" class="section level5">
<h5><span class="header-section-number">8.8.1.2.2</span> R’s Built-in color names</h5>
<p>As noted, another way to pass values to a color argument or color-based parameter is by their color names. R has 657 color names of which 502 are distinct. A list of all colors can be obtained with function <code>colors</code>, set argument “distinct” to TRUE, if you want unique colors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># List of all R colors</span>
rColors &lt;-<span class="st"> </span><span class="kw">colors</span>(<span class="dt">distinct =</span> <span class="ot">TRUE</span>)

<span class="co"># Number of R colors </span>
nRColors &lt;-<span class="st"> </span><span class="kw">length</span>(rColors)
nRColors
## [1] 502</code></pre></div>
<p>Just like hexadecimal values, color names can be passed as a character object to plotting function or parameter.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cl &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;gold&quot;</span>, <span class="st">&quot;turquoise3&quot;</span>, <span class="st">&quot;paleturquoise&quot;</span>, <span class="st">&quot;palevioletred2&quot;</span>, <span class="st">&quot;snow2&quot;</span>, <span class="st">&quot;pink&quot;</span>, <span class="st">&quot;mediumorchid1&quot;</span>, <span class="st">&quot;thistle&quot;</span>, <span class="st">&quot;mistyrose2&quot;</span>, <span class="st">&quot;orange2&quot;</span>)
<span class="kw">mosaicplot</span>(occupationalStatus, <span class="dt">color =</span> <span class="st">&quot;mistyrose2&quot;</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-182-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="defining-a-new-palette" class="section level3">
<h3><span class="header-section-number">8.8.2</span> Defining a new palette</h3>
<p>Colors in a palette can be changed by passing other colors to “palette”. These colors must be greater than 2 and no more than 1024 characters. These characters must either be color names recognized by R (listed in colors()), hexadecimal values or both.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Querying current palette</span>
<span class="kw">palette</span>()
## [1] &quot;black&quot;   &quot;red&quot;     &quot;green3&quot;  &quot;blue&quot;    &quot;cyan&quot;    &quot;magenta&quot; &quot;yellow&quot; 
## [8] &quot;gray&quot;

<span class="co"># Setting a new palette</span>
<span class="kw">palette</span>(<span class="kw">c</span>(<span class="st">&quot;blue3&quot;</span>, <span class="st">&quot;#3C0ABE&quot;</span>, <span class="st">&quot;blue1&quot;</span>, <span class="st">&quot;blue2&quot;</span>, <span class="st">&quot;blue3&quot;</span>, <span class="st">&quot;blue4&quot;</span>, <span class="st">&quot;deepskyblue&quot;</span>, <span class="st">&quot;skyblue&quot;</span>))

<span class="co"># Confirming new palette</span>
<span class="kw">palette</span>()
## [1] &quot;blue3&quot;       &quot;#3C0ABE&quot;     &quot;blue&quot;        &quot;blue2&quot;       &quot;blue3&quot;      
## [6] &quot;blue4&quot;       &quot;deepskyblue&quot; &quot;skyblue&quot;

<span class="co"># Diplaying new palette</span>
<span class="kw">pal</span>(<span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">6</span>), <span class="dt">col =</span> <span class="dv">1</span>:<span class="kw">length</span>(<span class="kw">palette</span>()))</code></pre></div>
<p><img src="figures/unnamed-chunk-183-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Resetting original palette</span>
<span class="kw">palette</span>(<span class="st">&quot;default&quot;</span>)</code></pre></div>
<p>Do note a palette is just a vector with colors and hence one can define a color palette without using function “palette”. The only difference being colors in a palette can be referred to by their indices.</p>
</div>
<div id="palettes-makers" class="section level3">
<h3><span class="header-section-number">8.8.3</span> Palettes makers</h3>
<p>R provides a number of palette makers or functions, these include “rainbow colors”, “heat.colors”, “terrain.colors”, “topo.colors”, “cm.colors”, “gray.colors” and “blue9”. All of these palettes are functions with exception of “blue9” which is a character vector with nine “blue based colors.</p>
<p>These color palette functions requires number of colors as its first argument and “alpha” as its second argument. Alpha is used to specify color’s opacity, that is, how transparent or opaque it should be; defaults to opaque.</p>
<p>Function rainbow has additional arguments “s”, “v”, “start” and “end” which will become clear once we have discussed properties of a color during color creation section.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Data</span>
dat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">10</span>)
n &lt;-<span class="st"> </span><span class="kw">length</span>(dat)

<span class="co"># Creating different colour schemes</span>
palettes &lt;-<span class="st"> </span><span class="kw">list</span>(
  <span class="dt">rainbow1 =</span> <span class="kw">rainbow</span>(n),
  <span class="dt">heatColors =</span> <span class="kw">heat.colors</span>(n),
  <span class="dt">terrainColors =</span> <span class="kw">terrain.colors</span>(n),
  <span class="dt">topoColors =</span> <span class="kw">topo.colors</span>(n),
  <span class="dt">cmColors =</span> <span class="kw">cm.colors</span>(n),
  <span class="dt">grayColors =</span> <span class="kw">gray.colors</span>(n),
  <span class="dt">blues9 =</span> blues9
)


<span class="co"># Main titles</span>
main &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Rainbow colors&quot;</span>, <span class="st">&quot;Heat colors&quot;</span>, <span class="st">&quot;Terrain colors&quot;</span>, <span class="st">&quot;Topo colors&quot;</span>, <span class="st">&quot;Cm colors&quot;</span>, <span class="st">&quot;Grey Colors&quot;</span>, <span class="st">&quot;Color vector Blue9&quot;</span>)

<span class="co"># Setting up layout</span>
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">4</span>, <span class="fl">0.5</span>)) 

<span class="co"># Color wheel</span>
<span class="kw">invisible</span>(<span class="kw">sapply</span>(<span class="dv">1</span>:<span class="kw">length</span>(palettes), function(x) <span class="kw">pie</span>(dat, <span class="dt">col =</span> palettes[[x]], <span class="dt">main =</span> main[x])))</code></pre></div>
<p><img src="figures/unnamed-chunk-184-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</code></pre></div>
<p><img src="figures/unnamed-chunk-184-2.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Showing opacity </span>
<span class="kw">pie</span>(dat, <span class="dt">col =</span> palettes[[<span class="dv">1</span>]], <span class="dt">panel.first =</span> <span class="kw">grid</span>(<span class="dt">lwd =</span> <span class="dv">2</span>), <span class="dt">main =</span> <span class="st">&quot;Alpha at 1&quot;</span>)
<span class="kw">pie</span>(dat, <span class="dt">col =</span> <span class="kw">rainbow</span>(n, <span class="dt">alpha =</span> <span class="fl">0.5</span>), <span class="dt">panel.first =</span> <span class="kw">grid</span>(<span class="dt">lwd =</span> <span class="dv">2</span>), <span class="dt">main =</span> <span class="st">&quot;Alpha at 0.5&quot;</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-184-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># Resetting original layout</span>
<span class="kw">par</span>(<span class="dt">mfrow =</span> op$mfrow, <span class="dt">mar =</span> op$mar)</code></pre></div>
<p>In addition to R’s palette functions, there are two other functions for interpolating colors these are colorRamp and colorRampPalette, the core of these tow being colorRamp. We discuss these two functions as additions to specifying colors to include in a palette.</p>
</div>
<div id="creating-palettes-by-interpolation-colors" class="section level3">
<h3><span class="header-section-number">8.8.4</span> Creating palettes by interpolation colors</h3>
<p>colorRamp takes a vector of colors as its first argument which it uses to define an interpolating function, this is the output of colorRamp. This function has one argument “x” which expects a vector of values between 0 and 1 or intensity of each of the interpolated colors. A call to this function produces a palette in a matrix format giving intensity of primary colors “red”, “green” and “blue” as well as opacity if alpha is set to true. Rows in this matrix represent a color.</p>
<p>Let’s create a palette with “colorRamp” .</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mar0<span class="fl">.5</span> &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="fl">0.5</span>, <span class="dv">4</span>)
<span class="kw">par</span>(<span class="dt">mar =</span> mar0<span class="fl">.5</span>)

<span class="co"># Interpolating some colors</span>
cols &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;cyan&quot;</span>, <span class="st">&quot;magenta&quot;</span>, <span class="st">&quot;yellow&quot;</span>)
cr &lt;-<span class="st"> </span><span class="kw">colorRamp</span>(cols)

<span class="co"># Determining object type</span>
<span class="kw">typeof</span>(cr)

<span class="co"># Color intensity</span>
x

<span class="co"># A palette with 10 colors</span>
cr.pal &lt;-<span class="st"> </span><span class="kw">cr</span>(x)
cr.pal

<span class="kw">pie</span>(dat, <span class="dt">col =</span> cr.pal)

<span class="kw">par</span>(<span class="dt">mar =</span> op)</code></pre></div>
<p>When alpha is set to TRUE, a four column matrix is produced.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cr2 &lt;-<span class="st"> </span><span class="kw">colorRamp</span>(<span class="dt">colors =</span> cols, <span class="dt">alpha =</span> <span class="ot">TRUE</span>)
<span class="kw">cr2</span>(x)</code></pre></div>
<p>colorRampPalette is more of a wrapper function for “colorRamp”. It takes a vector of color names or hexadecimal values or palette indices as its first argument and generates a palette creating function with one argument “n”. “n” are the number of colors to be produced.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">rep</span>(<span class="dv">05</span>, <span class="dv">4</span>))
<span class="co"># Interpolating colors</span>
crp &lt;-<span class="st"> </span><span class="kw">colorRampPalette</span>(cols)

<span class="co"># Type of object generated</span>
<span class="kw">typeof</span>(crp)
## [1] &quot;closure&quot;

<span class="co"># Creating a pallet with ten colors</span>
crp.pal &lt;-<span class="st"> </span><span class="kw">crp</span>(<span class="dv">10</span>)
crp.pal
##  [1] &quot;#000000&quot; &quot;#000038&quot; &quot;#000071&quot; &quot;#0000AA&quot; &quot;#0000E2&quot; &quot;#1C00E2&quot; &quot;#5400AA&quot;
##  [8] &quot;#8D0071&quot; &quot;#C60038&quot; &quot;#FF0000&quot;

<span class="kw">pie</span>(dat, <span class="dt">col =</span> crp.pal)</code></pre></div>
<p><img src="figures/unnamed-chunk-186-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar =</span> op$mar)</code></pre></div>
<p>Before creating new colors, there are a few concepts that need to be discussed, two of them being color models and spaces.</p>
</div>
<div id="color-models-and-spaces" class="section level3">
<h3><span class="header-section-number">8.8.5</span> Color Models and Spaces</h3>
<p>For any device to recognize a color, it needs to be in a format it understands. This is only possible if colors are numerical values, something like what we saw when discussing hexadecimal color codes. These numerical values are generated with mathematical formulas which are thus referred to as “color models”. There are different models each with it’s own strength and ways of computation. Some of these models are based on color composition like percentage of certain colors (their primary colors), others are based on aspect of light waves (physics) and other use concept of human perception (retina cones).</p>
<p>The underlining issue in all these models is to represent colors in numbers for computation and reproducibility purposes. In practical sense, when you make a plot on your PC and share with someone using a mac or even when you send it for printing, you expect the other device to reproduce an exact copy. So a color like “deepskyblue” is maintained as such and not some other variation of “blue”. This then can only happen when such colors are defined numerically and formulas used for definition become conversion functions.</p>
<p>However, even when colors are defined numerically, the receiving device might not have that particular color. This is because each device has a group of colors it can use; this is what is known as a “color space”.</p>
<p>All computer devices have a defined “color space” based on a particular color model. Some of the widely used color models are:</p>
<p><strong>RGB</strong></p>
<p>RGB is based on the concept of “additive color mixing” and involving three primaries; red, green and blue. Additive color mixing is one of two color mixing system (the other being subtractive). The best way to understand additive mixing is to think in terms of illuminating a white surface with three different lights of red, green and blue. When all three colors are projected, the surface remains white, when two colors are projected, a secondary color is seen like reddish-blue or magenta. In all, combining different variation of these lights produce the 6 million colors we computed earlier. Variation here includes reducing and increasing lighting, switching on and off one or two of the primaries.</p>
<p><strong>CYMK</strong></p>
<p>This model is also based on color mixing though subtractive. Subtractive color mixing is what you would expect when you hear color mixing, it is just like mixing painting colors to generate other colors. This system uses four primaries, “cyan”, “yellow”, “magenta” and “black” which incidentally are secondary colors in the additive system.</p>
<p><strong>CIELAB and CIE XYZ</strong></p>
<p>These are two similar models based on human vision. They are not as easy to understand as RGB and CYMK but are most preferred system for model conversion as they use more colors. They are thus called “profile connection spaces (PCS)”.</p>
<p><strong>Color spaces</strong></p>
<p>Color spaces are collection of colors based on a color model; an implementation of a color model. Color spaces determine how colors in a plot would appear and how they can be reproduced. When you see a plot that is bright and vibrant on screen looking washed out or dull on another device, it could very well be explained by color space used in the two devices. Chances are the other device does not contain colors used by plotting device.</p>
<p>There are a number of color spaces for each color model, for example sRGB, proPhotoRGB, and Adobe RGB (1998) for RGB model and CIELAB for CIE XYZ model. Each device has a defined color space, which has an implication on available colors. R uses “sRGB” an implementation of “RGB” color space and has functions for converting between color spaces. These functions are detailed in a vector called <code>colorspaces</code>.</p>
<p>What needs to be grasped in this concept of color models and spaces is the number of colors one can use to plot and how they would appear in a different display setting. R uses one of the smallest color spaces available in RGB model, this is because most of these colors can easily be reproduced with most devices. Color spaces like proPhotoRGB have a large collection of colors but not easily reproducible in other devices.</p>
<p>Bottom line, R’s color space is ideal for most general plots, but for specialized plots with very precise color schemes like geographical maps, R’s sRGB color space might not be sufficient, hence will need to consider other color spaces or models.</p>
</div>
<div id="creating-new-colours" class="section level3">
<h3><span class="header-section-number">8.8.6</span> Creating New Colours</h3>
<p>As noted earlier, R has 502 distinct colors, these are just 0.003% of all possible colors. Therefore many more colors can be created.</p>
<p>There two ways of creating new colors, one is by mixing and the other is by specifying three colors dimensions; hue, saturation/chroma, value/luminance. Selecting either of the two method of color creation will depends on how you define a color; as a composition of colors or its colorfulness and brightness.</p>
<div id="creating-color-by-mixing-srgb-color-space" class="section level4">
<h4><span class="header-section-number">8.8.6.1</span> Creating color by mixing: sRGB Color space</h4>
<p>sRGB stands for “standard Red Green and Blue” color space, an implementation of RGM model. This color space uses primary colors “red”, “green” and “blue”, to create new colors, in R this is done using “rgb” function. This function take a value between 0 and a given maximum to represent color intensity for each of the primaries. Maximum value can be any value though common values are 1 (for proportion) or 255 (total possible colors), default is 1. Passing 0 to any of the primaries would mean resulting color will not contain that primary while passing maximum value would mean that primary if fully represented in resulting color.</p>
<p>To illustrate this, lets begin by creating one color with a blue dominance.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># one color</span>
oneRGB &lt;-<span class="st"> </span><span class="kw">rgb</span>(<span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">1</span>)
oneRGB
## [1] &quot;#8000FF&quot;</code></pre></div>
<p>rgb produces a hexadecimal output which as we discussed earlier can be passed to any plotting function with a color argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Data</span>
dat &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">sample</span>(<span class="dv">100</span>, <span class="dv">20</span>)) ^<span class="st"> </span><span class="dv">2</span>

<span class="co"># Plotting using color from &quot;rgb()&quot;</span>
<span class="kw">plot</span>(dat, <span class="dt">pch =</span> <span class="dv">21</span>, <span class="dt">bg =</span> oneRGB, <span class="dt">main =</span> <span class="st">&quot;With newly create (&#39;rgb&#39;) color&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">panel.first =</span> <span class="kw">lines</span>(<span class="kw">spline</span>(dat)), <span class="dt">las =</span> <span class="dv">1</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-188-1.png" width="672" /></p>
<p>Now we can create multiple colors with different intensity of “red”, “green” and “blue”.</p>
<p>First let’s create colors with all possible combinations of 0 and 1.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">4</span>, <span class="fl">0.5</span>))
<span class="co"># Making a data frame with all possible combinations of 0 and 1</span>
comb &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">red =</span> <span class="dv">0</span>:<span class="dv">1</span>, <span class="dt">green =</span> <span class="dv">0</span>:<span class="dv">1</span>, <span class="dt">blue =</span> <span class="dv">0</span>:<span class="dv">1</span>)

<span class="co"># A list with all colour combinations (totals to 8)</span>
rgbPallet &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(comb), function(x) <span class="kw">rgb</span>(comb[x,]))

<span class="co"># A color wheel </span>
<span class="kw">pie</span>(<span class="kw">rep.int</span>(<span class="dv">1</span>, <span class="kw">nrow</span>(comb)), <span class="dt">col =</span> rgbPallet, <span class="dt">main =</span> <span class="st">&#39;All combinations of &quot;0 and 1&quot;&#39;</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-189-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">par</span>(<span class="dt">mar =</span> op$mar)</code></pre></div>
<p>We can use rgb’s output to create a new color palette.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Getting current (default) palette</span>
<span class="kw">palette</span>()
## [1] &quot;black&quot;   &quot;red&quot;     &quot;green3&quot;  &quot;blue&quot;    &quot;cyan&quot;    &quot;magenta&quot; &quot;yellow&quot; 
## [8] &quot;gray&quot;

<span class="co"># Changing color palette</span>
<span class="kw">palette</span>(rgbPallet)

<span class="co"># Displaying names of new palette</span>
<span class="kw">palette</span>()
## [1] &quot;black&quot;   &quot;red&quot;     &quot;green&quot;   &quot;yellow&quot;  &quot;blue&quot;    &quot;magenta&quot; &quot;cyan&quot;   
## [8] &quot;white&quot;

<span class="co"># Resetting to original palette</span>
<span class="kw">palette</span>(<span class="st">&quot;default&quot;</span>)

<span class="co"># Confirming reset was effected</span>
<span class="kw">palette</span>()
## [1] &quot;black&quot;   &quot;red&quot;     &quot;green3&quot;  &quot;blue&quot;    &quot;cyan&quot;    &quot;magenta&quot; &quot;yellow&quot; 
## [8] &quot;gray&quot;</code></pre></div>
<p>Did you notice our new palette is similar to default palette with exception of white/grey and order?</p>
<p>Given our discussion on additive system which RGB is one of them, let’s try and prove some of the concepts. One of these concepts is additive models begin with color “black” when all three color lights are off and eventually become white when they are all on.</p>
<p>To prove this, we will create two vectors with an aim of creating a sequence of colors beginning or leading to the said colors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">4</span>, <span class="fl">0.5</span>))

<span class="co"># Generating a sequence of values </span>
x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">0.1</span>)

<span class="co"># Creating sequenced color vector</span>
(allOn  &lt;-<span class="st"> </span><span class="kw">rgb</span>(<span class="dv">1</span>, <span class="dv">1</span>, x))
##  [1] &quot;#FFFF00&quot; &quot;#FFFF1A&quot; &quot;#FFFF33&quot; &quot;#FFFF4D&quot; &quot;#FFFF66&quot; &quot;#FFFF80&quot; &quot;#FFFF99&quot;
##  [8] &quot;#FFFFB3&quot; &quot;#FFFFCC&quot; &quot;#FFFFE6&quot; &quot;#FFFFFF&quot;
(allOff &lt;-<span class="st"> </span><span class="kw">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, x))
##  [1] &quot;#000000&quot; &quot;#00001A&quot; &quot;#000033&quot; &quot;#00004D&quot; &quot;#000066&quot; &quot;#000080&quot; &quot;#000099&quot;
##  [8] &quot;#0000B3&quot; &quot;#0000CC&quot; &quot;#0000E6&quot; &quot;#0000FF&quot;

<span class="co"># Displaying color</span>
<span class="kw">pal</span>(allOn, <span class="dt">main =</span> <span class="st">&#39;A white ending for &quot;r = 1, g = 1, b = 1&quot;&#39;</span>, <span class="dt">border =</span> <span class="st">&quot;#808080&quot;</span>)
<span class="kw">pal</span>(allOff, <span class="dt">main =</span> <span class="st">&#39;Black begining when r = 0, g = 0, b = 0&#39;</span>, <span class="dt">border =</span> <span class="st">&quot;#808080&quot;</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-191-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">par</span>(<span class="dt">mfrow =</span> op$mfrow, <span class="dt">mar =</span> op$mar)</code></pre></div>
<p>Next time you create colors with sRGB color space and you get either white or black you would know how they were formed.</p>
</div>
<div id="creating-colors-using-color-properties" class="section level4">
<h4><span class="header-section-number">8.8.6.2</span> Creating colors using color properties</h4>
<p>R has two functions which can be used to create colors based its properties, these are “hsv” (hue, saturation, value) and “hcl” (hue, chromaticity, lighting). But before we create colors with these functions we need to understand what color properties are and difference between “hsv” and “hcl”.</p>
<div id="colorProperties" class="section level5">
<h5><span class="header-section-number">8.8.6.2.1</span> Color Properties</h5>
<p>Colors can be defined by three properties; “Hue”, “Colorfulness”, and “lightness”.</p>
<p><strong>Hue</strong></p>
<p>In basic terms “hues” are colors you would consider as bright and purest, these are mainly primary colors “red”, “blue” and “green”. With these three colors an endless number of colors can be created (actually, slightly over 16 million). All possible colors are represented cylindrically such that each color can be identified by its angle which begins from 0 degrees to 359 degrees. For example, color red is at 0 degrees, green at 120 degree and blue at 240 degree.</p>
<p><strong>Colorfulness</strong></p>
<p>Colorfulness is one’s perception of a color in terms of its intensity. Colorfulness is usually described by, “saturation” or “chromaticity (chroma)”. <strong>Saturation</strong> referes to a color’s purity or vividness, a pure color or hue would be saturated while a color said to be dull or washed is desaturated. On a scale of 0 to 100 percent, zero means a desaturated color or grey while a hundred percent means a saturated color (color in its full light).</p>
<p><img src="figures/unnamed-chunk-192-1.png" width="672" /></p>
<p><strong>Chromaticity</strong> is simply quality of a color independent of light. Since quality of a color is defined by hue, colourfulness and light, chromaticity is therefore determined by its hue and saturation/purity. Looking at our example of a palette consisting of color blue moving from saturation to desaturation, a saturated color is fully bright (full light) while a desaturated color is dim. Hence colors on these palette are distinguished by their light which means color blue and grey share the same chromaticity (as it does not factor in light).</p>
<p><strong>Lighting</strong></p>
<p>When light is projected on a surface like a wall, what is reflected is referred to as “perceived lighting” (we can call this reflected light). This lighting should be distinguished from brightness which is “perceived brightness” of object being projected or simply projected/emitted light. As an example, when two or three hues are projected to a white wall, lighting is what the white wall will reflect while brightness is lighting from the hues. In this regard, brightness is light from a hue while lighting is light from reflecting surface. Both lighting and brightness are perceptions rather than measured properties of light. Vision perception is interpretation of information (in this case color sensors) by the brain passed through our eyes. This interpretation is affected by a number of things, one of them being surrounding objects. Take for instance projecting some presentation (like a PowerPoint) on a white wall, if the room is lit (a nearby light bulb is on), your presentation will not be visible, but when dimmed or switched off, your presentation is as clear as on your screen (well at least in terms of visibility as color will be affected by color space). In this case, if we were to measure the light reflected by projected wall when room is lit and when it is off it would be the same but our perception of what is projected is different in both instances. Hence, eye/brain interpretation (perception) of what is being seen is different from actual light being transmitted or intensity.</p>
<p>From our projection example we should also note that our first practical reaction to a lit room during presentation is squinting of the eyes. This is an adaption mechanism by our brain which has received sensory information it has trouble interpreting. This act means that we are more sensitive to perceived lighting rather than colors being presented or its saturation (chromaticity). This clearly means lighting should be given high importance when creating colors.</p>
<p>Light is measured by “luminance” on a scale called “candela per square meter (cd/m^2)”. This is an absolute measurement used to quantify lighting and brightness which are relative (perceived) measurement of light. When creating colors, algorithms take into account perception such that luminance is scaled appropriately, this is referred to as “gamma-coding”.</p>
<p>Bottom line, when defining a new color, you need to think in terms of its pure color (hue), its colorfulness (saturation or chroma) and lightness or Brightness (relative luminance).</p>
<p>Now let’s create some colors.</p>
</div>
<div id="creating-colors-with-hsv" class="section level5">
<h5><span class="header-section-number">8.8.6.2.2</span> Creating colors with hsv()</h5>
<p>“hsv” stands for hue saturation and value. In our preceding discussion we learnt what “hue” and “saturation” are, they are the pure color and colorfulness of a color. Value is the same as brightness which as we mentioned is an objects (color’s) light.</p>
<p>hsv() has four arguments “h” (hue), “s” (saturation), “v” (value) and “alpha”. Alpha means a color’s opacity or transparency. All four arguments take values between 0 and 1; for “h” this means pure colors falling between 0 and 1, while for saturation and value it means level of purity and brightness.</p>
<p>As an example we will create three palettes demonstrating fully saturated and bright hues, desaturated but bright hues as well as desaturated and darker hues.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="fl">0.5</span>))

<span class="co"># HSV color wheels</span>
<span class="kw">pal</span>(<span class="kw">hsv</span>(<span class="dt">h =</span> x[-<span class="dv">11</span>], <span class="dt">s =</span> <span class="dv">1</span>, <span class="dt">v =</span> <span class="dv">1</span>)) 
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;Colorful and bright palette&quot;</span>, <span class="dt">line =</span> <span class="fl">0.2</span>)

<span class="kw">pal</span>(<span class="kw">hsv</span>(<span class="dt">h =</span> x[-<span class="dv">11</span>], <span class="dt">s =</span> <span class="fl">0.5</span>, <span class="dt">v =</span> <span class="dv">1</span>))
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot; A bright but less colorful palette (pastel)&quot;</span>, <span class="dt">line =</span> <span class="fl">0.2</span>)

<span class="kw">pal</span>(<span class="kw">hsv</span>(<span class="dt">h =</span> x[-<span class="dv">11</span>], <span class="dt">s =</span> <span class="fl">0.5</span>, <span class="dt">v =</span> <span class="fl">0.5</span>))
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;A darker and less colourful palette&quot;</span>, <span class="dt">line =</span> <span class="fl">0.2</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-193-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">par</span>(<span class="dt">mfrow =</span> op$mfrow)</code></pre></div>
<p>All these color have a different hexadecimal code.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cbind</span>(<span class="kw">hsv</span>(x[-<span class="dv">11</span>], <span class="dv">1</span>, <span class="dv">1</span>), <span class="kw">hsv</span>(x[-<span class="dv">11</span>], <span class="fl">0.5</span>, <span class="dv">1</span>), <span class="kw">hsv</span>(x[-<span class="dv">11</span>], <span class="dv">1</span>, <span class="dv">1</span>))
##       [,1]      [,2]      [,3]     
##  [1,] &quot;#FF0000&quot; &quot;#FF8080&quot; &quot;#FF0000&quot;
##  [2,] &quot;#FF9900&quot; &quot;#FFCC80&quot; &quot;#FF9900&quot;
##  [3,] &quot;#CCFF00&quot; &quot;#E5FF80&quot; &quot;#CCFF00&quot;
##  [4,] &quot;#33FF00&quot; &quot;#99FF80&quot; &quot;#33FF00&quot;
##  [5,] &quot;#00FF66&quot; &quot;#80FFB3&quot; &quot;#00FF66&quot;
##  [6,] &quot;#00FFFF&quot; &quot;#80FFFF&quot; &quot;#00FFFF&quot;
##  [7,] &quot;#0066FF&quot; &quot;#80B2FF&quot; &quot;#0066FF&quot;
##  [8,] &quot;#3300FF&quot; &quot;#9980FF&quot; &quot;#3300FF&quot;
##  [9,] &quot;#CC00FF&quot; &quot;#E680FF&quot; &quot;#CC00FF&quot;
## [10,] &quot;#FF0099&quot; &quot;#FF80CC&quot; &quot;#FF0099&quot;</code></pre></div>
</div>
</div>
<div id="hcl" class="section level4">
<h4><span class="header-section-number">8.8.6.3</span> hcl()</h4>
<p>“hcl” stands for hue chroma and luminance. This function is similar to “hsv” with exception of being perceptually based as it corresponds to perceptually uniform color space known as CIE-LUV. The underlining concept of this function is that visual system sees perceived luminance or the reflected light and not illumination or emitted light; quite simply we see lighting rather than brightness.</p>
<p>There are five argument in this function with the first three being “h” (hue), “c” (chroma) and “l” (luminance). Argument “h” expects value between 0 and 360 corresponding to a hues angle like 0 degrees means red, 120 degrees is green and 360 degree is blue. Chroma and luminance have a default value which are computed to R has made some consideration as far as default values for chroma and luminance are concerned. These values are meant to make it possible generate good quality hues.</p>
<p>Before we proceed, recall chroma is composed of both hue and saturation, hence any changes made will have a direct effect on hue. To demonstrate this, we look at the three primary colors by altering chroma and lighting. As a start, we will make a palette with default chroma and luminance, then we will increase chroma while holding lighting constant, finally we will increase lighting while holding chroma constant (constant means default values). This should give us an idea of how chroma and lighting affects output.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">1</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="fl">0.5</span>))

<span class="co"># Primary colors</span>
hues &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">120</span>, <span class="dv">240</span>)

<span class="co"># HCL for primary colors with default chroma and luminance</span>
<span class="kw">pal</span>(<span class="kw">hcl</span>(<span class="dt">h =</span> hues))
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;A pastel (desaturated) apperance&quot;</span>, <span class="dt">line =</span> <span class="fl">0.2</span>)

<span class="co"># Maintaining same lighting but increasing colorfulness</span>
<span class="kw">pal</span>(<span class="kw">hcl</span>(<span class="dt">h =</span> hues, <span class="dt">c =</span> <span class="dv">120</span>))
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;Increased saturation same lighting&quot;</span>)

<span class="co"># Palette with saturated and bright hues</span>
<span class="kw">pal</span>(<span class="dv">2</span>:<span class="dv">4</span>)
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;Expected saturation and lighting&quot;</span>, <span class="dt">line =</span> <span class="fl">0.2</span>)

<span class="co"># Increasing saturation and decreasing luminance</span>
<span class="kw">pal</span>(<span class="kw">hcl</span>(<span class="dt">h =</span> hues, <span class="dt">l =</span> <span class="dv">95</span>))
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;Increased saturation and reduced lighting&quot;</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-195-1.png" width="672" /></p>
<p>Quite clearly increasing chroma offset hue thereby changing its purity while increasing lighting makes them almost “white”. When making color palettes to communicate analyses work, consider using either qualitative, sequential or divergent color palettes as suggested by package “colorspace” (read vignette(package = “colorspace”)).</p>
</div>
</div>
<div id="color-adjustment" class="section level3">
<h3><span class="header-section-number">8.8.7</span> Color adjustment</h3>
<p>Composition of colors in a palette can be adjusted (increased or decreased) using function “adjust.color”. This function can be used to adjust opacity and levels of primary colors. Adjustment begins by converting given colors to rgb using “col2rgb()” before making specified changes</p>
<p>For example, we can reduce opacity levels for 10 rainbow colors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="fl">0.5</span>))

<span class="kw">pal</span>(<span class="dt">col =</span> <span class="kw">adjustcolor</span>(<span class="dv">1</span>:<span class="dv">8</span>, <span class="fl">0.5</span>), <span class="dt">panel.first =</span> <span class="kw">grid</span>(<span class="dt">lwd =</span> <span class="dv">2</span>))
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;Reduced opacity, visible background lines&quot;</span>, <span class="dt">line =</span> <span class="fl">0.2</span>)
<span class="kw">pal</span>(<span class="dt">col =</span> <span class="kw">palette</span>(), <span class="dt">panel.first =</span> <span class="kw">grid</span>(<span class="dt">lwd =</span> <span class="dv">2</span>), )
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;Full opacity, invisible grid lines&quot;</span>, <span class="dt">line =</span> <span class="fl">0.2</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-196-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">par</span>(<span class="dt">mfrow =</span> op$mfrow, <span class="dt">mar =</span> op$mar)</code></pre></div>
</div>
<div id="colorConversion" class="section level3">
<h3><span class="header-section-number">8.8.8</span> Color conversion and Transformation</h3>
<p>R provides a number of ways to convert colors from one color space to another. But before making any conversion, it is important to appreciate two things, “color gamut” and “clipping”. [A color gamut is a complete range of colors, for example a sRGB color gamut are all the colors available in sRGB color space, this varies from one color space to another, some color spaces have a wider gamut than others, for instance, Adobe RGB has a wider gamut than sRGB.][#gamut] When converting colors from one color space to another, consider differences in gamut particularly if the other color space does not have specified color. Colors not contained in the other color space are said to be out-of-gamut and can either be clipped or returned as NA. [Clipping means out-of-gamut colors are converted to another appropriate color which might be slightly different from original color.][#colorClipping]</p>
<p>Some of the functions used for conversion include “convertColor”, “col2rgb”, and “rgb2hsv”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="fl">0.5</span>))

<span class="co"># Converting palette color names to rgb</span>
rgbColors &lt;-<span class="st"> </span><span class="kw">col2rgb</span>(<span class="kw">palette</span>())

<span class="co"># A matrix is returned</span>
rgbColors
##       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## red      0  255    0    0    0  255  255  190
## green    0    0  205    0  255    0  255  190
## blue     0    0    0  255  255  255    0  190

<span class="co"># Convert rgb to Lab colors</span>
labColors &lt;-<span class="st"> </span><span class="kw">convertColor</span>(<span class="kw">t</span>(rgbColors), <span class="dt">from =</span> <span class="st">&quot;sRGB&quot;</span>, <span class="dt">to =</span> <span class="st">&quot;Lab&quot;</span>, <span class="dt">scale.in =</span> <span class="dv">255</span>)
<span class="kw">rownames</span>(labColors) &lt;-<span class="st"> </span><span class="kw">palette</span>()
labColors
##                  L         a.x            b
## black    0.0000000   0.0000000    0.0000000
## red     53.4841838  80.0102716   67.3840747
## green3  71.9184091 -73.3354787   70.4113442
## blue    32.2407492  78.8204175 -107.9363219
## cyan    91.0110555 -48.4607513  -14.2908090
## magenta 60.5023086  97.9519466  -60.5149036
## yellow  97.1495027 -21.3667702   94.4204364
## gray    76.9759418   0.0000000    0.0000000

<span class="kw">par</span>(<span class="dt">mfrow =</span> op$mfrow, <span class="dt">mar =</span> op$mar)</code></pre></div>
<ul>
<li>opponent colors, cool/warm colors</li>
</ul>
<div id="interactivePlotting" class="section level4">
<h4><span class="header-section-number">8.8.8.1</span> Interactive plotting on base R</h4>
<p>R offers two function for interacting with plots, these are “locator” and “identify”. However, these are platform specific, for locator(), check if your system is supported with function “dev.capabilities()”, for identify() only “X11”, “Windows” and “quartz” support it.</p>
</div>
</div>
</div>
<div id="other-plotting-and-color-palette-packages" class="section level2">
<h2><span class="header-section-number">8.9</span> Other Plotting and Color Palette Packages</h2>
<p>There are numerous other packages for generating plots in R. Some commonly used static plotting packages include “lattice” and “ggplot2” both of which are based on “grid graphics” a package and .</p>
<p>A comprehensive list of other packages including those dealing with colors can be sourced from “<a href="http://cran.r-project.org/web/view/Graphics.html" class="uri">http://cran.r-project.org/web/view/Graphics.html</a>”</p>
</div>
<div id="graphicalDevices" class="section level2">
<h2><span class="header-section-number">8.10</span> Graphical Devices</h2>
<p>When developing plots in R, outputs are displayed either on screen or externally on what is referred to as graphical devices. All available graphical devices are numbered 1 through 63, with one being default graphing device or “Null device”. Default graphing device is platform specific with windows having “windows”, mac having “quartz” and Linux having “x11”. In addition, RStudio has its own graphing device referred to as “RStudioGD” and usually at the second position and the default piloting device when working on RStudio. External devices include printing and file based devices like “png”, “jpg”, “pdf” and the like.</p>
<p>Generating plots on either base R or RStudio (on screen devices) would result to default graphical device being opened, but for external graphical devices, a call to a device driver function needs to be made before plotting. Calling device drivers before plotting ensure plotting functions can be understood by the other device. Once plotting is finished, device drivers need to be closed. For example, to send a plot to a file such “png”, a call to png’s driver is made before plotting and closed after plotting.</p>
<pre><code>png(filename = &quot;plot_one.png&quot;)
plot(BOD)
dev.off</code></pre>
<p>A list of available device drivers is documented on R’s help page for devices, type help(“device”).</p>
<p>Multiple devices can be open at the same time like RStudioGD, png, and jpeg, however, R can only output to one device at a time. So if all these three devices are opened, the one listed as current or active device will be used. To know which device is current, call “dev.cur()” or “dev.list()” to see all currently available devices.</p>
<p>Active device can be change to another device, which immediately opens the specified device.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># All currently opened devices</span>
<span class="kw">dev.list</span>()

<span class="co"># Current device</span>
<span class="kw">dev.cur</span>()
## RStudioGD
##         2

<span class="co"># Changing device from RStudio to windows or Null graphical device</span>
<span class="kw">dev.set</span>(<span class="dv">1</span>)

<span class="co"># Check indeed change was made</span>
<span class="kw">dev.cur</span>()
## windows
##       4

<span class="co"># Close of second (png) device</span>
<span class="kw">dev.list</span>()
<span class="kw">dev.off</span>()</code></pre></div>
<p>Instead of opening an external device before plotting, a plot can be made on screen and sent to an off-screen device by copying the plot. This approach might be good as you get to see the plot being generated and amend as need be before sending to an external device or file.</p>
<p>As an example, we make a plot and copy it to an external file.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># On screen plotting</span>
<span class="kw">plot</span>(BOD, <span class="dt">main =</span> <span class="st">&quot;BOD Dataset&quot;</span>)</code></pre></div>
<p><img src="figures/unnamed-chunk-199-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">

<span class="co"># Copy plot to a &quot;png&quot; file (first argument to dev.copy must be a device/function)</span>
<span class="kw">dev.copy</span>(png, <span class="dt">file =</span> <span class="st">&quot;tmp.png&quot;</span>)
## png 
##   4

<span class="co"># Establish file is created</span>
<span class="kw">file.exists</span>(<span class="st">&quot;tmp.png&quot;</span>)
## [1] TRUE

<span class="co"># Close device</span>
<span class="kw">dev.off</span>()
## pdf 
##   2

<span class="co"># Remove file</span>
<span class="kw">unlink</span>(<span class="st">&quot;tmp.png&quot;</span>)

<span class="kw">plot</span>(BOD)</code></pre></div>
<p>If there are other open devices and need to shut all of them down, use graphics.off(). This function is automatically called on exit of a session.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dev.list</span>()
## pdf png 
##   2   3
<span class="kw">graphics.off</span>()
<span class="kw">dev.list</span>()
## NULL</code></pre></div>
</div>
<div id="references-3" class="section level2 unnumbered">
<h2>References</h2>
<div id="quick-reference-on-functions-2" class="section level3 unnumbered">
<h3>Quick reference on functions</h3>
<ol style="list-style-type: decimal">
<li>?plot</li>
<li>?xy.coords</li>
<li>?axis</li>
<li>?Axis</li>
<li>?box</li>
<li>?plot.window</li>
<li>?device</li>
<li>?par</li>
<li>demo(plotmath)</li>
<li>?hist</li>
<li>?n2mfrow</li>
</ol>
</div>
<div id="packages-to-read-further-on-1" class="section level3 unnumbered">
<h3>Packages to read further on</h3>
<ol style="list-style-type: decimal">
<li>Lattice</li>
<li>ggplot2</li>
<li>Grid</li>
<li>MASS(truehist)</li>
<li>KernSmooth (dpih)</li>
</ol>
</div>
<div id="r-manuals-1" class="section level3 unnumbered">
<h3>R Manuals</h3>
<div id="an-introduction-to-r-sections-1" class="section level4 unnumbered">
<h4>An Introduction to R sections:</h4>
<p>Chapter 12: Graphical procedures</p>
</div>
<div id="r-internals" class="section level4 unnumbered">
<h4>R Internals</h4>
<p>Chapter 6: Graphics 6.2 Colors</p>
</div>
<div id="r-faq-sections-1" class="section level4 unnumbered">
<h4>R FAQ sections</h4>
</div>
<div id="online-reference" class="section level4 unnumbered">
<h4>Online reference</h4>
<ol style="list-style-type: decimal">
<li>How to solve some plotting problems: <a href="https://support.rstudio.com/hc/en-us/articles/200488548-Problem-with-Plots-or-Graphics-Device" class="uri">https://support.rstudio.com/hc/en-us/articles/200488548-Problem-with-Plots-or-Graphics-Device</a></li>
<li>A good tutorial blog post: <a href="http://rpubs.com/SusanEJohnston/7953" class="uri">http://rpubs.com/SusanEJohnston/7953</a></li>
<li>A comprehensive list of other plotting packages on CRAN <a href="https://cran.r-project.org/web/views/Graphics.html" class="uri">https://cran.r-project.org/web/views/Graphics.html</a></li>
<li>Excellent compilation of plot types available in R and graphical devices: <a href="http://www.revolutionanalytics.com/r-language-features-graphics-and-visualization" class="uri">http://www.revolutionanalytics.com/r-language-features-graphics-and-visualization</a></li>
<li>Grammar for graphics: <a href="http://vita.had.co.nz/papers/layered-grammar.pdf" class="uri">http://vita.had.co.nz/papers/layered-grammar.pdf</a></li>
<li>An excellent read on definition of color properties: <a href="http://www.workwithcolor.com/color-properties-definitions-0101.htp" class="uri">http://www.workwithcolor.com/color-properties-definitions-0101.htp</a></li>
<li>A good read on colors: color-wheel-artist.com/hue.html</li>
<li>An excellent and in depth read on visual perception: vanseodesign.com/web-design/color-luminance/</li>
</ol>
<p id="gaugeYourself8">
<b>Gauge yourself</b>
</p>
</div>
</div>
<div id="basics-of-plotting-in-r" class="section level3 unnumbered">
<h3>Basics of plotting in R</h3>
<p><strong>Exercise</strong></p>
<ol style="list-style-type: decimal">
<li>Which are the three basic groups of plotting functions in R</li>
<li>If you pass a factor and a numeric vector to plot() what type of graph will be produced?</li>
<li>What steps are taken by “plot()” to produce a basic plot?</li>
<li>Which base R plotting function is more appropriate for plotting multivariate data involving numeric matrices or data frames. What if they were four variables?</li>
</ol>
<p><strong>Solutions</strong></p>
<ol style="list-style-type: decimal">
<li>The three groups of plotting functions are high-level plotting functions, low-level functions and interactive functions.</li>
<li>A call to plot() will dispatch on class of the first argument. In the case of a factor and numeric, plot will dispatch on factor argument which will be a bar plot.</li>
<li>There are roughly eight steps taken by plot() to produce a basic plot, these are: a. Open new plotting window a. Set x and y coordinates a. Evaluate and execute any pre-plot expressions a. Make the actual plot a. Evaluate and execute post-plot and pre-axis expressions a. Add axis if required a. Frame plot if needed a. Annotate, and finally display plot</li>
<li>For multivariate plotting, “pairs()” is most suitable for plotting numeric matrices or data frames while “coplot()” is suitable for three or four variables.</li>
</ol>
</div>
<div id="calling-and-changing-graphical-parameters" class="section level3 unnumbered">
<h3>Calling and changing graphical parameters</h3>
<p><strong>Exercises</strong></p>
<ol style="list-style-type: decimal">
<li>What do we mean by global and local parameter changes</li>
<li>Conceptual exercises a. What is your expectation from this call to par ‘par(mar = rep(2, 2))’</li>
</ol>
<p><strong>Solution:</strong></p>
<ol style="list-style-type: decimal">
<li>Global changes are changes made to graphical parameters affecting subsequent plotting during an R session. Local changes are temporary changes made to graphical parameters. Global changes are made with call to “par” while local changes are made with call to a plotting function. 1 Expectation a. An error as graphical parameter “mar” requires a vector of length 4 not 2</li>
</ol>
</div>
<div id="annotating-plots" class="section level3 unnumbered">
<h3>Annotating plots</h3>
<p><strong>Exercise</strong></p>
<ol style="list-style-type: decimal">
<li>What function is used to add titles and labels?</li>
<li>What is the difference between “Axis” and “axis”?</li>
<li>How are expressions added to plots</li>
</ol>
<p><strong>Solutions</strong> 1. “title()” is used to add titles and labels to plots 1. “Axis” is a generic function used to create user defined labels for numerical axis. “axis” are used to add custom made axes to plots after calling plot().<br />
1. Expressions are added to plots as either text (using “text” function), marginal text (with function “mtext”), labels (with function “label”) or as axis labels. They however must be “expression” objects</p>
</div>
<div id="producing-different-base-r-plots" class="section level3 unnumbered">
<h3>Producing different base R plots</h3>
<p><strong>Exercise</strong></p>
<ol style="list-style-type: decimal">
<li>Reproduce the following plot using BOD data set, one of base R’s data set</li>
</ol>
<div class="figure">
<img src="figures/BODexercise.png" alt="BOD plot" />
<p class="caption">BOD plot</p>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Using data set tips from reshape2 package, reproduce the following plot. Colors used are 1, 2, 4, and 5.</li>
</ol>
<div class="figure">
<img src="figures/multiplotExe.png" alt="Multipanelling" />
<p class="caption">Multipanelling</p>
</div>
<ol start="3" style="list-style-type: decimal">
<li>Reproduce figure showing pch characters 1:25</li>
</ol>
<pre><code>##        x  y
##  [1,]  5 25
##  [2,] 10 25
##  [3,] 15 25
##  [4,] 20 25
##  [5,] 25 25
##  [6,]  5 20
##  [7,] 10 20
##  [8,] 15 20
##  [9,] 20 20
## [10,] 25 20
## [11,]  5 15
## [12,] 10 15
## [13,] 15 15
## [14,] 20 15
## [15,] 25 15
## [16,]  5 10
## [17,] 10 10
## [18,] 15 10
## [19,] 20 10
## [20,] 25 10
## [21,]  5  5
## [22,] 10  5
## [23,] 15  5
## [24,] 20  5
## [25,] 25  5</code></pre>
<p><img src="figures/pchExer-1.png" width="672" /></p>
<p><strong>Solution</strong></p>
<ol style="list-style-type: decimal">
<li>Code to reproduce plot</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(BOD, <span class="dt">main =</span> <span class="st">&quot;Biochemical Oxygen Demand&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Time (days)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Demand (mg/l)&quot;</span>, <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">col =</span> <span class="dv">4</span>, <span class="dt">frame.plot =</span> <span class="ot">FALSE</span>, <span class="dt">las =</span> <span class="dv">1</span>)
<span class="kw">rect</span>(<span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">1</span>], <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">3</span>], <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">2</span>], <span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)[<span class="dv">4</span>], <span class="dt">col =</span> <span class="st">&quot;lightgrey&quot;</span>)
BODcoords &lt;-<span class="st"> </span><span class="kw">xy.coords</span>(BOD)
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">seq</span>(<span class="dv">8</span>, <span class="dv">20</span>, <span class="dt">by =</span> <span class="dv">2</span>), <span class="dt">v =</span> <span class="dv">1</span>:<span class="dv">7</span>, <span class="dt">col =</span> <span class="st">&quot;white&quot;</span>)
<span class="kw">points</span>(BOD, <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">col =</span> <span class="dv">2</span>)
<span class="kw">box</span>(<span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>)</code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Code to reproduce plot</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Setting margins for four plots, one for each day</span>
op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="kw">c</span>(<span class="st">&quot;mar&quot;</span>, <span class="st">&quot;mfcol&quot;</span>, <span class="st">&quot;oma&quot;</span>))
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">mfcol =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">oma =</span> <span class="kw">rep</span>(<span class="dv">3</span>, <span class="dv">4</span>))

<span class="co"># Subsets</span>
subTips &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="kw">levels</span>(tips$day), function(i) <span class="kw">subset</span>(tips, day ==<span class="st"> </span>i, <span class="dt">select =</span> <span class="kw">c</span>(total_bill, tip)))
tipsRange &lt;-<span class="st"> </span><span class="kw">sapply</span>(subTips, function(x) <span class="kw">sapply</span>(x, range))
<span class="kw">dimnames</span>(tipsRange)[[<span class="dv">1</span>]] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;x Minimum&quot;</span>, <span class="st">&quot;x Maximum&quot;</span>, <span class="st">&quot;y Minimum&quot;</span>, <span class="st">&quot;y Maximum&quot;</span>)
xlim &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">c</span>(<span class="kw">min</span>(tipsRange[<span class="st">&quot;x Minimum&quot;</span>,]) -<span class="st"> </span><span class="fl">0.5</span>, <span class="kw">max</span>(tipsRange[<span class="st">&quot;x Maximum&quot;</span>,])))
ylim &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">c</span>(<span class="kw">min</span>(tipsRange[<span class="st">&quot;y Minimum&quot;</span>,]) -<span class="st"> </span><span class="fl">0.5</span>, <span class="kw">max</span>(tipsRange[<span class="st">&quot;y Maximum&quot;</span>,])))

<span class="co"># Plots showing relationship between &quot;tips&quot; and &quot;total bill&quot; by:</span>
<span class="co">#--------------------------------------------------------------</span>
<span class="co"># First day &quot;Friday&quot;</span>
<span class="kw">plot</span>(subTips[[<span class="dv">1</span>]]$total_bill, subTips[[<span class="dv">1</span>]]$tip, <span class="dt">col =</span> <span class="dv">1</span>, <span class="dt">xlim =</span> xlim, <span class="dt">ylim =</span> ylim, <span class="dt">ann =</span> <span class="ot">FALSE</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">panel.first =</span> <span class="kw">grid</span>(<span class="dt">lty =</span> <span class="st">&quot;solid&quot;</span>))
<span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">cex =</span> <span class="fl">0.6</span>)
<span class="kw">box</span>()
<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">3.5</span>, <span class="dt">y =</span> <span class="dv">9</span>, <span class="dt">labels =</span> <span class="kw">levels</span>(tips$day)[<span class="dv">1</span>], <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">cex =</span> <span class="dv">1</span>)


<span class="co"># Second day &quot;Sat&quot;</span>
<span class="kw">plot</span>(subTips[[<span class="dv">2</span>]]$total_bill, subTips[[<span class="dv">2</span>]]$tip, <span class="dt">col =</span> <span class="dv">2</span>, <span class="dt">xlim =</span> xlim, <span class="dt">ylim =</span> ylim, <span class="dt">ann =</span> <span class="ot">FALSE</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">panel.first =</span> <span class="kw">grid</span>(<span class="dt">lty =</span> <span class="st">&quot;solid&quot;</span>))
<span class="kw">axis</span>(<span class="dv">1</span>)
<span class="kw">box</span>()
<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">3.5</span>, <span class="dt">y =</span> <span class="dv">9</span>, <span class="dt">labels =</span> <span class="kw">levels</span>(tips$day)[<span class="dv">2</span>], <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">cex =</span> <span class="dv">1</span>)

<span class="co"># Third day &quot;Sunday&quot;</span>
<span class="kw">plot</span>(subTips[[<span class="dv">3</span>]]$total_bill, subTips[[<span class="dv">3</span>]]$tip, <span class="dt">col =</span> <span class="dv">4</span>, <span class="dt">xlim =</span> xlim, <span class="dt">ylim =</span> ylim, <span class="dt">ann =</span> <span class="ot">FALSE</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">panel.first =</span> <span class="kw">grid</span>(<span class="dt">lty =</span> <span class="st">&quot;solid&quot;</span>))
<span class="kw">axis</span>(<span class="dv">3</span>)
<span class="kw">box</span>()
<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">3.5</span>, <span class="dt">y =</span> <span class="dv">9</span>, <span class="dt">labels =</span> <span class="kw">levels</span>(tips$day)[<span class="dv">3</span>], <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">cex =</span> <span class="dv">1</span>)

<span class="co"># Fouth day &quot;Thur&quot;</span>
<span class="kw">plot</span>(subTips[[<span class="dv">4</span>]]$total_bill, subTips[[<span class="dv">4</span>]]$tip, <span class="dt">col =</span> <span class="dv">5</span>, <span class="dt">xlim =</span> xlim, <span class="dt">ylim =</span> ylim, <span class="dt">ann =</span> <span class="ot">FALSE</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">panel.first =</span> <span class="kw">grid</span>(<span class="dt">lty =</span> <span class="st">&quot;solid&quot;</span>))
<span class="kw">axis</span>(<span class="dv">4</span>)
<span class="kw">box</span>()
<span class="kw">text</span>(<span class="dt">x =</span> <span class="fl">3.5</span>, <span class="dt">y =</span> <span class="dv">9</span>, <span class="dt">labels =</span> <span class="kw">levels</span>(tips$day)[<span class="dv">4</span>], <span class="dt">pos =</span> <span class="dv">4</span>, <span class="dt">cex =</span> <span class="dv">1</span>)


<span class="co"># Restoring original margins</span>
<span class="kw">par</span>(<span class="dt">mar =</span> op$mar, <span class="dt">mfcol =</span> op$mfcol, <span class="dt">oma =</span> op$oma)</code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Code to reproduce figure</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Saving a changing layout</span>
op &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;mar&quot;</span>)
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>))

x &lt;-<span class="st"> </span><span class="kw">rep.int</span>(<span class="kw">seq.int</span>(<span class="dv">5</span>, <span class="dv">25</span>, <span class="dv">5</span>), <span class="dv">5</span>)
y &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">seq.int</span>(<span class="dv">25</span>, <span class="dv">5</span>, -<span class="dv">5</span>), <span class="dt">each =</span> <span class="kw">length</span>(<span class="kw">unique</span>(x)))
<span class="kw">cbind</span>(x, y)

<span class="kw">plot</span>(x, y, <span class="dt">ann =</span> <span class="ot">FALSE</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">frame.plot =</span> <span class="ot">TRUE</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">27</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">30</span>), <span class="dt">pch =</span> <span class="dv">1</span>:<span class="dv">25</span>)
<span class="kw">title</span>(<span class="dt">main =</span> <span class="st">&quot;S  and R symbols&quot;</span>, <span class="dt">line =</span> <span class="fl">1.5</span>, <span class="dt">font.main =</span> <span class="dv">7</span>)
<span class="kw">text</span>(x, y +<span class="st"> </span><span class="fl">1.6</span>, <span class="dt">labels =</span> <span class="dv">1</span>:<span class="dv">25</span>)

<span class="kw">par</span>(<span class="dt">mar =</span> op)</code></pre></div>
</div>
<div id="using-and-creating-colors-in-base-r" class="section level3 unnumbered">
<h3>Using and creating colors in base R</h3>
<p><strong>Exercise</strong></p>
<ol style="list-style-type: decimal">
<li>What type of objects can be passed to color arguments?</li>
<li>What is a palette?</li>
<li>How many distinct color names does base R have?</li>
<li>Distinguish between color models and color spaces</li>
<li>What is the difference between “additive” and “subtractive” mixing systems and which system does R use</li>
<li>How many possible colors are there in an RGB color space</li>
<li>What are the three main color properties?</li>
</ol>
<p><strong>Solutions</strong></p>
<ol style="list-style-type: decimal">
<li>Color argument in plotting functions and graphical parameters can either be a numeric or character object. Numeric values represent indices of colors in a palette while character values represent hexadecimal codes or color names.</li>
<li>A palette is a selection of colors</li>
<li>Base R has 502 distinct color names</li>
<li>Color models are mathematical formulas used to define colors as numerical objects. Color spaces are implementation of color model with a given number of colors for which it has details of their composition and conversion specification.</li>
<li>Additive color mixing involves light mixing. In this system light waves of two or more pure colors are mixed by projecting against a white background or surface, these systems are commonly used by on screen devices like computers and projectors. Subtractive color mixing is similar to paint mixing as it involves ink absorption, this system in mostly used in printers. R used additive color mixing.</li>
<li>There are 1.677721610^{7} possible colors in a RGB color space.</li>
<li>The three main color properties are “hue”, “colorfulness” and “lighting”. Hue is the pure color, colorfulness is purity or vividness of a color and lighting is perceived reflected brightness from a surface.</li>
</ol>
</div>
<div id="rs-graphical-devices" class="section level3 unnumbered">
<h3>R’s graphical devices</h3>
<p><strong>Exercises</strong></p>
<ol style="list-style-type: decimal">
<li>What does “Null device” mean?</li>
<li>Can you use more than one graphical device?</li>
<li>Why would a file containing a plot you have just generated not open?</li>
</ol>
<p><strong>Solutions</strong></p>
<ol style="list-style-type: decimal">
<li>Null device is the default device which is usually an on screen graphing device like windows (for windows operating system), x11 (for Linux), quartz (for apple) or RStudioGD (when using RStudio)</li>
<li>Yes, you just need to tell R which device to use each time you what a different device.</li>
<li>One possible reason is that dev.off was not called once plotting was completed and therefore device is still open. Upon completing a plot, it is important to close all open device if they are not being used.</li>
</ol>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="6">
<li id="fn6"><p>A function body is basically a function’s definition or internals; its that part that defines how the function will work.<a href="chap8.html#fnref6">↩</a></p></li>
<li id="fn7"><p>Exploratory Data Analysis is one of the first activities done during data analysis, it’s aim is to get an insight into the data more as regards patterns and modelling strategies. EDA informs on how actual data analysis will be done but it does not form actual data analysis. Our third book on “Data Analysis using R” will expound on this.<a href="chap8.html#fnref7">↩</a></p></li>
</ol>
</div>
<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/

var disqus_config = function () {
this.page.url = http://helleng.github.io/Data_Mgt_Analysis_and_Graphics_R/Pages/tutorials.html;  // Replace PAGE_URL with your page's canonical URL variable
var disqus_developer = 1;
//this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//introduction-to-data-analysis-and-graphics-using-r.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            </section>

          </div>
        </div>
      </div>
<a href="chap7.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chap9.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": true,
"weibo": false,
"instapper": true,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"],
"linkedin": true
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"download": null,
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"search": true
});
});
</script>

</body>

</html>
